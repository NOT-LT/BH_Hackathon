THE TELECOMMUNICATIONS LAW OF THE KINGDOM OF BAHRAIN LEGISLATIVE DECREE NO. 48 OF 2002 PROMULGATING THE TELECOMMUNICATIONS LAW Published in the Official Gazette of the Kingdom of Bahrain Annex to Issue No. 2553, Wednesday, 17 Sha’aban 1423 (h). (23 October, 2002) UNOFFICIAL ENGLISH TRANSLATION SECOND EDITION Current as at 10 October 2023 CONTENTS CHAPTER 1 9 ARTICLE 1 9 DEFINITIONS 9 CHAPTER 2 13 THE AUTHORITY 13 ARTICLE 2 13 ESTABLISHMENT OF THE AUTHORITY 13 ARTICLE 3 13 DUTIES AND POWERS OF THE AUTHORITY 13 CHAPTER 3 17 THE BOARD OF DIRECTORS 17 ARTICLE 4 17 APPOINTMENT AND CESSATION OF MEMBERSHIP 17 ARTICLE 5 17 FUNCTIONS AND POWERS OF THE BOARD 17 ARTICLE 6 17 MEETINGS 17 ARTICLE 7 18 CONFLICT OF INTERESTS 18 CHAPTER 4 18 THE GENERAL DIRECTOR 18 ARTICLE 8 18 APPOINTMENT AND VACANCY OF OFFICE 18 ARTICLE 9 19 COMPETENCE 19 ARTICLE 10 19 REMUNERATIONS 19 ARTICLE 11 19 RESIGNATION OF GENERAL DIRECTOR 19 ARTICLE 12 19 REMOVAL OF GENERAL DIRECTOR FROM HIS POST 19 ARTICLE 13 19 STRUCTURE OF THE AUTHORITY 19 ARTICLE 14 20 EMPLOYMENT AND REMUNERATION OF STAFF 20 CHAPTER 5 20 THE MINISTER 20 ARTICLE 15 20 RESPONSIBILITIES OF THE MINISTER 20 ARTICLE 16 21 INDEPENDENCE OF THE AUTHORITY 21 CHAPTER 6 21 FINANCIAL AND RELATED MATTERS 21 ARTICLE 17 21 ANNUAL ACCOUNTS, REPORT AND AUDIT 21 ARTICLE 18 22 FUNDING OF THE AUTHORITY 22 ARTICLE 19 23 THE AUTHORITY’S EXPENDITURE 23 ARTICLE 20 24 BORROWING POWERS 24 ARTICLE 21 24 CONFLICT OF INTERESTS 24 ARTICLE 22 25 OUTSIDE EMPLOYMENT OF THE GENERAL DIRECTOR AND THE 25 AUTHORITY’S STAFF 25 ARTICLE 23 25 CONFIDENTIALITY 25 CHAPTER 7 25 LICENSING AND EQUIPMENT APPROVALS 25 ARTICLE 24 25 REQUIREMENT TO OBTAIN A TELECOMMUNICATIONS LICENCE 25 ARTICLE 25 26 GRANT OF TELECOMMUNICATIONS LICENCES 26 ARTICLE 26 26 REQUIREMENTS RELATED TO INDIVIDUAL AND CLASS LICENCES 26 ARTICLE 27 27 SUBMISSION OF THE LICENCE APPLICATION 27 ARTICLE 28 27 CONTENTS OF A TELECOMMUNICATIONS LICENCE 27 ARTICLE 29 27 INDIVIDUAL LICENCES 27 ARTICLE 30 29 RENEWAL OF AN INDIVIDUAL LICENCE 29 ARTICLE 31 29 MODIFICATION AND REVOCATION OF INDIVIDUAL LICENCES 29 ARTICLE 32 29 THE CLASS LICENCE 29 ARTICLE 33 30 RENEWAL OF CLASS LICENCE 30 ARTICLE 34 30 MODIFICATION AND REVOCATION OF CLASS LICENCES 30 ARTICLE 35 31 ENSURING COMPLIANCE WITH INDIVIDUAL AND CLASS LICENCES 31 ARTICLE 36 32 APPEALING AGAINST DECISIONS AND ORDERS 32 ARTICLE 37 32 EFFECTS OF TERMINATION OF A LICENCE 32 ARTICLE 38 32 APPROVAL OF EQUIPMENT AND DESIGNATION OF STANDARDS 32 CHAPTER 8 33 TIMETABLE FOR INTRODUCING COMPETITION 33 ARTICLE 39 33 TIMETABLE FOR ISSUING LICENCES FOR INTRODUCING COMPETITION 33 ARTICLE 40 34 TIMETABLE FOR OTHER MATTERS 34 ARTICLE 41 35 BAHRAIN INTERNET EXCHANGE 35 CHAPTER 9 36 RADIOCOMMUNICATIONS 36 ARTICLE 42 36 SUPERVISION OF TELECOMMUNICATIONS FREQUENCIES 36 ARTICLE 43 37 FREQUENCY LICENSE 37 ARTICLE 44 37 GRANT OF A FREQUENCY LICENSE 37 ARTICLE 45 38 CONTENTS OF A FREQUENCY LICENSE 38 ARTICLE 46 38 USE OF RADIOCOMMUNICATIONS STATIONS FOR NAVIGATION PURPOSES 38 ARTICLE 47 39 MIGRATION OF FREQUENCIES 39 ARTICLE 48 39 COMPLIANCE WITH INTERNATIONAL TREATIES AND OTHER LEGISLATION 39 ARTICLE 49 39 PREVENTING HARMFUL INTERFERENCE WITH RADIOCOMMUNICATIONS 39 ARTICLE 50 39 OBLIGATIONS OF A FREQUENCY LICENSEE 39 ARTICLE 51 40 MODIFICATION AND REVOCATION OF A FREQUENCY LICENSE 40 CHAPTER 10 40 REGISTER, INFORMATION AND DISPUTES BETWEEN LICENSEES AND SUBSCRIBERS 40 ARTICLE 52 40 THE REGISTER 40 ARTICLE 53 41 UNDERTAKING TO PROVIDE THE AUTHORITY WITH INFORMATION 41 ARTICLE 54 42 PUBLICATION OF INFORMATION 42 ARTICLE 55 42 PROCEDURES FOR DEALING WITH COMPLAINTS 42 ARTICLE 56 42 DISPUTES BETWEEN LICENSEES AND SUBSCRIBERS 42 CHAPTER 11 43 INTERCONNECTION AND ACCESS 43 ARTICLE 57 43 INTERCONNECTION AND ACCESS 43 CHAPTER 12 45 TARIFFS CONTROL 45 ARTICLE 58 45 TARIFFS FOR TELECOMMUNICATIONS SERVICES 45 CHAPTER 13 45 PUBLIC AND PRIVATE PROPERTY 45 ARTICLE 59 45 USE OF PUBLIC PROPERTY 45 ARTICLE 60 46 PROTECTION OF THE ENVIRONMENT AND HISTORIC AND TOURIST SITES 46 ARTICLE 61 46 USE OF PRIVATE PROPERTY 46 ARTICLE 62 47 EXPROPRIATION 47 ARTICLE 63 48 NATURAL OBSTRUCTIONS 48 CHAPTER 14 48 UNIVERSAL SERVICE 48 ARTICLE 64 48 UNIVERSAL SERVICE OBLIGATIONS 48 CHAPTER 15 49 PROMOTION OF COMPETITION 49 ARTICLE 65 49 ANTI-COMPETITIVE CONDUCT 49 CHAPTER 16 50 ARBITRATION 50 ARTICLE 66 50 RESORTING TO ARBITRATION 50 ARTICLE 67 51 ARBITRATION RULES AND PROCEDURES 51 ARTICLE 68 51 FORMATION OF THE ARBITRATION PANEL 51 ARTICLE 69 52 IMPARTIALITY AND INDEPENDENCE OF THE ARBITRATION PANEL 52 ARTICLE 70 52 PUBLICATION OF THE DECISIONS OF THE ARBITRATION PANEL 52 ARTICLE 71 52 FINALITY OF THE DECISIONS OF THE ARBITRATION PANEL 52 CHAPTER 17 52 COMPLAINTS AND PENALTIES 52 ARTICLE 72 52 COMPLAINTS SUBMITTED TO THE AUTHORITY 52 ARTICLE 73 53 PENALTIES 53 ARTICLE 74 54 USE OF FRAUDULENT MEANS 54 ARTICLE 75 55 DIVERSION, TAPPING AND DISCLOSURE OF MESSAGES 55 ARTICLE 76 55 LIABILITY OF A JURISTIC ENTITY 55 CHAPTER 18 55 INSPECTION AND SUPERVISION PROCEDURES 55 ARTICLE 77 55 INSPECTION AND SUPERVISION PROCEDURES 55 CHAPTER 19 56 NATIONAL SECURITY 56 ARTICLE 78 56 LICENSEES’ OBLIGATIONS CONCERNING NATIONAL SECURITY 56 ARTICLE 79 57 NATIONAL SAFETY AND MARTIAL LAW 57 CHAPTER 20 57 TRANSITIONAL PROVISIONS 57 ARTICLE 80 57 ADAPTATION OF CIRCUMSTANCES 57 ARTICLE 81 58 INVALIDATION OF PRIOR POWERS 58 LEGISLATIVE DECREE NO. 48 OF 2002 PROMULGATING THE TELECOMMUNICATIONS LAW We, Hamad Bin Isa Al Khalifa, the King of the Kingdom of Bahrain, After perusal of: the Constitution; Legislative Decree No. 8 of 1970, governing the Expropriation of Land for Public Benefit, as amended; The Civil and Commercial Procedural Law promulgated by Legislative Decree No. 12 of 1971, as amended; The Law of Penalties promulgated by Legislative Decree No. 15 of 1976, as amended; Legislative Decree No. 25 of 1976 approving the Arabian Space Telecommunications Agreement; Legislative Decree No. 13 of 1977, promulgating the Law of the Regulation of Buildings, as amended by Legislative Decree No. 15 of 1993; Legislative Decree No. No. 18 of 1981, establishing a Bahraini Joint Stock Company under

---

the name of Bahrain Telecommunications Company; Legislative Decree No. 27 of 1981 concerning Martial Law; Legislative Decree No. 9 of 1985 Approving Adherence by the State of Bahrain to the International Marine Satellite Organization Agreement (“Inmarsat”) and the annexes thereto; Legislative Decree No. 15 of 1986 Concerning Tourism, as amended by Legislative Decree No. 12 of 1994; Legislative Decree No. 7 of 1987, promulgating the Law of Commerce, as amended; Legislative Decree No. 2 of 1992 Approving Adherence to the International Satellite Communications Organization Agreement, as amended by Legislative Decree No. 1 of 2002; Legislative Decree No. 1 of 1993 for the Establishment of the Radio and Television Corporation, as amended by Legislative Decree No. 12 of 1996; Legislative Decree No. 11 of 1995 for the Protection of Antiquities; Legislative Decree No. 21 of 1996 Regarding the Environment, as amended by Legislative Decree No. 8 of 1997; Legislative Decree No. 1 for 1999 Approving the Arabian Space Telecommunications Agreement which was amended by Legislative Decree No. 31 of 2001; the Civil Law promulgated by Legislative Decree No. 19 of 2001; the Commercial Companies Law promulgated by Legislative Decree No. 21 for 2001; Legislative Decree No. 28 of 2002 Regarding Electronic Transactions; the Law regulating Governmental Tenders and Purchases promulgated by Legislative Decree No. 36 of 2002; the Criminal Procedural Law promulgated by Legislative Decree No. 46 of 2002; and on the basis on the proposal submitted by the Minister of Transportation, and after the approval thereof by the Council of Ministers, Has decreed the following Law: The First Article The provisions of the law attached hereto shall apply to telecommunications. The Second Article The provisions of this law attached hereto shall govern all telecommunications except the radio frequency spectrum, telecommunications networks and services used by the Bahrain Defence Forces and all security organs in the Kingdom. The Third Article Every contrary provision shall be superseded by the provisions of the attached Law. This Law shall be construed in accordance with the provisions of the relevant international agreements applicable in the Kingdom and the regulations of any international body or commission or organisation operating in the field of telecommunications of which the Kingdom is a member. The Fourth Article The Prime Minister and the Ministers shall, each according to his Authority, implement the provisions of this Law which shall take effect on the day following the date of its publication in the Official Gazette. The King of the Kingdom of Bahrain Hamad Bin Isa Al Khalifa The Prime Minister The Minister of Transportation Khalifa Bin Salman Al Khalifa Ali Bin Khalifa Al Khalifa Issued at Al-Rifa Palace: Date: 17 Sha’aban 1423 (h) (23 October 2002) THE TELECOMMUNICATIONS LAW CHAPTER 1 ARTICLE 1 DEFINITIONS For the purposes of this Law, unless the context otherwise requires, the following terms and expressions shall have the meanings set forth opposite each one of them: “Access”: the making available of telecommunications facilities and/or telecommunications services to a Licensed Operator for the purpose of providing telecommunications services, and including the connection of equipment by wire or wireless means, access to physical infrastructure including buildings, ducts, cables and masts, access to mobile networks and access to number translation or networks offering equivalent functionality.1 “Allocation” (with respect to frequencies): determining the usage of a frequency in the Kingdom of Bahrain in compliance with international telecommunications conventions. “Assignment” (with respect to frequencies): the assignment of certain frequencies for usage by Frequency License licensees. “Appointing Authority”: the Minister of Justice and Islamic Affairs in his capacity as the Authority that appoints the Arbitration Panel provided for in Chapter 16 of this Law. “Arbitration Panel”: the panel that shall be formed in accordance with the provisions of Article 68 of this Law. “Authority”: the Telecommunications Regulatory Authority established by virtue of the provisions of this Law. “Batelco”: Bahrain Telecommunications Company established by virtue of Legislative Decree No. 18 of 1981. “Board”: the Board of Directors of the Authority that is formed in accordance with the provisions of Article 4 of this Law. “Broadcasting”: any cable, radio or satellite communication, transmissions of which are intended for direct general reception by the public but excludes Video on Demand. “Carrier Pre-selection”: a facility whereby a Subscriber to a telecommunications service can by default receive the services of an interconnected holder of a telecommunications License. 1 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 “Chairman”: the Chairman of the Board of Directors of the Telecommunications Regulatory Authority. “Class License”: a telecommunications License (as distinct from the Individual License) subject to standard conditions for all Licensees concerning every type of License granted in accordance with the provisions of Article 32 of this Law. “Domestic Roaming”: the ability of the Subscribers of a mobile telecommunications Licensee to use their handsets while in the telecommunications service area of another Licensee. “Dominant Position”: the Licensee’s position of economic power that enables it to prevent the existence and continuation of effective competition in the relevant market through the ability of the Licensee to act independently – to a material extent – of competitors, Subscribers and Users. “DSL”: point-to-point Telecommunications Network Access that allows multiple forms of Telecommunications to be carried over twisted-pair copper wire between the Local Exchange of the Telecommunications Operator and the Subscriber. Fixed Telecommunications Infrastructure Network: a Telecommunications Network owned and operated by a holder of a fixed Telecommunications Infrastructure Network Licence. This network does not include fixed telecommunications masts. Fixed Telecommunications Infrastructure Network Licence: An Individual Licence made available by the Authority pursuant to Articles 29 and 40(bis)(a) of this Law that enables the licence holder to deploy, operate and maintain a Fixed Telecommunications Infrastructure Network and to supply products and services to other Licensed Operators in the Kingdom over a Fixed Telecommunications Infrastructure Network on a wholesale only and on an equivalence of inputs basis. “Frequency License”: a License for

---

the use of frequency granted in accordance with the provisions of Article 44 of this Law.2 “General Director”: the Authority’s General Director appointed in accordance with the provisions of Article 8 of this Law. “GSM”: global system for mobile communications, as defined in the European Telecommunications Standards Institute structure of technical specifications operating in the 900 MHz and 1800 MHz and such other frequency bands as the Authority may determine from time to time. “Individual License”: a Telecommunications License granted to a particular Person on terms and conditions specific to that Person in accordance with the provisions of Article 29 of this Law. “Interconnection”: the physical and logical linking of Telecommunications networks 2 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 used by the same or a different operator in order to allow the Subscribers of one operator to communicate with Subscribers of the same or another operator, or to receive services provided by another operator. “Kingdom”: the Kingdom of Bahrain. “Licence”: a Telecommunications Licence or a Frequency License. “Licensed Operator”: a Person who is licensed to operate a Telecommunications Network or to provide a Telecommunications service under Article 25 of this Law. “Licensee”: a Person holding a License granted pursuant to the provisions of this Law. “Local Exchange”: the facility in the Public Telecommunications Network to which Subscribers’ lines are connected within the same Local Exchange area. “Minister”: the Minister with responsibility for the Telecommunications sector. “Ministry”: the Ministry with responsibility for the Telecommunications sector. “Mobile Radiocommunications”: the conveyance of signals by Radiocommunication whereby reception or emission is by means of Telecommunications Equipment which may be used while in motion. “National Frequency Plan”: the strategic plan for radio frequency spectrum allocations prepared and managed by the Radiocommunications Authority. “National Numbering Plan”: the numbering plan prepared and managed by the Authority for use in connection with the supply of Telecommunications services in the Kingdom. “National Plan for Telecommunications”: the plan approved by the Council of Ministers by virtue of a resolution issued thereby, which plan incorporates the strategy and the general policy concerning the Telecommunications sector referred to in Article 15(a) of this Law. “Notice”: a letter sent to the addressee by registered or electronic mail accompanied by acknowledgement of receipt.3 “Number Portability”: The capability whereby a Subscriber of a national fixed serviced provided by a holder of a national fixed service License can retain the Subscriber’s telephone number when changing the service and assigning it to another holder of a national fixed service License, or the capability whereby a Subscriber of a mobile Telecommunications service provided by a holder of a mobile Telecommunications License can retain the Subscriber’s mobile telephone number when changing the service and assigning it to the holder of another mobile Telecommunications License. “Operator with Significant Market Power”: a Licensed Operator which holds twenty- 3 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 five percent or more of the market share of the relevant market as determined from time to time by the Authority. When determining such matter, there shall be taken into consideration the ability of a Licensed Operator to influence market conditions, its turnover relative to the size of the market, its control of the means of Access to Users, its financial resources and it s experience of providing products and services in the market. The Authority may determine that the Licensed Operator has significant market power even if such operator holds a share of less than twenty-five percent of the market or that it does not have significant power even if it holds more than such percentage. “Person”: any natural person, juristic entity or public authority. “Public Telecommunications Network”: a Telecommunications Network used, in whole or in part, for the provision of Public Telecommunications Services provided either by a Licensed Operator of the Telecommunications Network or a third party. “Public Telecommunications Operator”: a Licensed Operator authorized to provide Public Telecommunications Services or to operate a Public Telecommunications Network under an Individual License. “Public Telecommunications Services”: Telecommunications services available to the public.4 “Radiocommunications”: the transmission, emission or reception of messages, sound, visual images or signals using electromagnetic waves which are propagated in space and having frequencies of lower than 3,000 GHz. “Radiocommunications Authority” the Authority or any other entity that may be designated in a decree. 5 “Radiocommunications Equipment”: any equipment or apparatus designed or used for Radiocommunications. “Radiocommunications Station”: any site, station or Telecommunications Facility which is used for Radiocommunications. “Subscriber”: any Person that is party to a contract with a Public Telecommunications Operator for the provision of Telecommunications services. “Telecommunications”: the conveyance and/or routing of messages, sound, visual images or signals on Telecommunications Networks, other than Broadcasting. “Telecommunications Equipment” means any equipment or apparatus used or intended to be used for Telecommunications and that is part of or connected to, or comprises, a Telecommunications Network, and includes Radiocommunications 4 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 5 Added by virtue of the Second Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 Equipment. “Telecommunications Facility”: any part of the infrastructure of a Telecommunications Network including any antenna, circuit, duct, equipment, fibre (whether partially or fully in service or not), line, mast, pole, tower or any other structure or any other thing used or intended for use in connection with a Telecommunications Network. “Telecommunications Frequency”: any frequency designated for Telecommunications use in the National Frequency Plan, which shall include frequencies used for or in connection

---

with Mobile Radiocommunications (irrespective of the technology deployed and including third generation services) cordless telephony, terrestrial fixed links, paging, public access mobile radio, fixed-wireless access, fixed and mobile satellite service applications and high performance local area networks. “Telecommunications Network”: a network permitting the conveyance of messages, sound, visual images or signals between defined termination points by wire, radio, optical, or other electro-magnetic means. For the avoidance of doubt, this definition also includes satellite.6 “Unbundled Local Loop”: the physical connection from the Subscriber’s premises to the Public Telecommunications Operator’s Local Exchange, excluding switching or ports, purchased by a Licensed Operator from another Licensed Operator. “Universal Service”: the basic public telephone services described in Article 64(c) of this Law of specified quality and at suitable prices (as determined by the Authority) which are available to all Users independent of their geographical location. “User” any Person using or requesting publicly available Telecommunications services. “Video on Demand”: a Telecommunications service that enables a Subscriber to watch video content by using a Telecommunications Network whenever such Subscriber requests such service from the provider of that service. CHAPTER 2 THE AUTHORITY ARTICLE 2 ESTABLISHMENT OF THE AUTHORITY a) A public authority called the “Telecommunications Regulatory Authority,” is hereby established. b) The Authority shall be a financially and administratively independent juridical entity that shall assume the regulation of Telecommunications services in the Kingdom in accordance with the provisions of this Law. For such purpose, it shall have the right 6 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 to: c) a) exercise all powers given to it under this Law to carry out its duties hereunder. b) own movable and immovable property. c) enter into contracts and to take all legal actions, including the right to enter into legal proceedings and to defend any claim against the Authority, and to resort to arbitration or similar legal proceedings. The Authority shall have all the advantages exercised by the ministries, governmental entities, and official public sector organisations in the Kingdom. ARTICLE 3 DUTIES AND POWERS OF THE AUTHORITY a) The Authority shall carry out its duties and exercise its powers efficiently, effectively, regularly, reasonably and in a non-discriminatory and transparent manner. b) The Authority undertakes in carrying out its duties relating to Telecommunications services in the manner best calculated to: 1. c) protect the interests of Subscribers and Users in respect of: • the tariffs charged for services. • Availability and provision of service. • quality of services. • protection of personal particulars and privacy of services. 2. promote effective and fair competition among new and existing Licensed Operators. 3. ensure, when assessing applications involving provision of Public Telecommunications Services, that any applicant, or any Person who is assigned the responsibility of the provision of such services, shall be able to provide that service. The Authority shall have the power to: 1. issue regulations, orders and determinations i as may be necessary for the implementation of the provisions of this Law, including in particular regulations, orders and determinations in connection with technical standards and rules, Licences and payment of Licence fees, frequency migration, accounting separation relating to each service, Interconnection, Access to the network and its facilities, services’ tariffs, access to, acquisition and removal of encumbrances on real property, numbering, Universal Service, the promotion of competition, equipment approvals, compliance with License conditions and all other matters covered by this Law or the resolution of which is necessary to give effect to the provisions of this Law. 2. monitor and investigate compliance with the provisions of this Law and any regulations, orders and determinations made hereunder, both on its own initiative and at the request of any Person, and making such orders and determinations as are necessary to ensure compliance in accordance with this Law and any such regulations, orders and determinations including ordering a Licensee to be restructured into two or more entities, if necessary. 3. give final decisions as to applications for Licences in accordance with the provisions of this Law. Note that the Arabic word “ ‫ “ ﻗرار‬is used in the Arabic version of the Telecommunications Law for the word “Determination” in this sentence. “ ‫ “ ﻗرار‬can be translated into the English words of “Decision”, “Determination” or “Resolution”. In practice TRA Bahrain has tended to use these English words to define specific legal instruments, whereby “Decisions” or “Determinations” are used for the results of a regulatory process (e.g. a Decision on Merger Clearance) or regulatory action (e.g. a Determination of Dominance or Significant Market Power) and where “Resolutions” have been used for mainly administrative decisions such as setting of license fees or business hours. In preparing this English translation of the Telecommunications Law TRA has attempted used the word it considers most suitable to define the instrument based upon its purpose in each instance of the use of the Arabic word “‫“ ﻗرار‬. This does not prevent TRA from amending its practices in the future. For purposes of interpretation the Arabic text shall prevail. i 4. monitor and enforce compliance with Licence terms and conditions by Licensees. 5. propose and effect modifications to Licenses where appropriate in accordance with the provisions of this Law. 6. set and collect application, initial, annual and renewal fees for Licences, collect fines and fees under any Licence and, where appropriate, collect any fees for services provided by the Authority. 7. assist the Radiocommunications Authority in relation to the preparation of the National Frequency Plan as it applies to the Telecommunications Frequencies of the plan. 8. co-ordinate Telecommunications Frequency Assignments with the competent authorities of other countries in accordance with the applicable requirements of the International Telecommunications Union. 9. in co-ordination the Radiocommunications Authority, publish and update a national register of Telecommunications Frequency allocations and publish regulations related to Telecommunications Frequencies. 10. Approve Frequencies Licenses in accordance with the National Frequency Plan.7 11. in

---

co-ordination with the Radiocommunications Authority, monitor those who are authorised to use of Telecommunications Frequency in the Kingdom, and ensure compliance in accordance with the law and to ensure the efficient use thereof. 7 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 12. prepare and follow up the execution of the National Numbering Plan and assigning numbers to Licensed Operators in accordance with such plan. 13. encourage, regulate and facilitate adequate Access and Interconnection and interoperability of services, including, where necessary, enforcing the sharing by Public Telecommunications Operators of the benefit of facilities and properties. 14. review tariffs to ensure that they are fair and reasonable and establish the basis for tariff definition and tariff rebalancing plans and other measures for tariff controls for inclusion in Telecommunications Licenses where appropriate and determine tariffs, if necessary, including by benchmarking tariffs charged by a Licensee against tariffs in comparable Telecommunications markets and determining the costs of providing a Telecommunications service.8 15. adopt and publish technical specifications and standards for the import and use of Telecommunications Equipment and for the connection and Interconnection of Telecommunications Equipment to Telecommunications Networks. d) e) 16. issue approvals or to assign this function to others, in accordance with the Authority’s discretion, for the use of Telecommunications Equipment for which no relevant technical specifications or standards have been issued by the Authority and the connection or Interconnection thereof to a Telecommunications Network. 17. examine complaints and resolve disputes arising between Licensees, Licensees and Subscribers or any other Person involved in the Telecommunications industry, and taking necessary and proportionate measures in relation to such matter. 18. exercising all other powers granted to the Authority hereunder and taking all other actions as may be reasonably necessary to give effect to the provisions of the foregoing paragraphs. In the course of fulfilling the duties that are entrusted to it by virtue of this Law, the Authority may when necessary: 1. contract with any third parties and liaise and co-operate with specialised agencies, academic or technical institutes and advisory committees. 2. entrust some of its technical or administrative functions to third parties, authorities or committees that have the required technical and administrative capacities to perform those functions. In the fulfillment of its duties and the exercise of its powers, the Authority shall act in 8 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 a manner that is consistent with the objectives of the National Plan for Telecommunications; provided that this shall not be construed to derogate from the independence of the Authority in accordance with the provisions of this Law. f) Except in emergency cases, the Authority shall, when determining to take measures that will have a material effect on a particular Telecommunications market, give interested parties the opportunity to give their opinions as to such measures within a reasonable period. The Authority shall issue a Regulation regarding such consultations, in a manner that ensures that all of the public is informed from a single information source of the ongoing consultations, excluding information which is supplied on the basis that it should not be disclosed. g) The Authority may order a Licensed Operator to separate into two or more entities if the Authority determines that separation is necessary for the promotion of sustainable competition or the deployment of a Fixed Telecommunications Infrastructure Network; or based on the request of the Licensed Operator to enable the deployment of a Fixed Telecommunications Infrastructure Network. CHAPTER 3 THE BOARD OF DIRECTORS ARTICLE 4 APPOINTMENT AND CESSATION OF MEMBERSHIP a) The Authority shall be managed by a Board of Directors consisting of five members, one of whom shall be the Chairman of the Board. For the appointment of the Board members, a decree based on the proposal of the Council of Ministers shall be issued, and such decree shall designate the Chairman of the Board, provided that the necessity of independence of the Authority, in accordance with the provisions of this Law, be given due consideration. b) The term of office of the Board members shall be four years. As for the initial Board, the terms of office of three of its members shall be three years and of the two other members shall be four years. The decree issued for the appointment of the Board members shall specify the terms of office of every Board member. c) If a vacancy in the Board arises due to the expiry of term of office, resignation, removal or death of a Board member, his replacement shall be appointed by virtue of the same instrument and in the same manner provided for in paragraph (a) of this Article. d) No Board member shall be dismissed before the expiry of his term of office except by virtue of a decree based on a proposal by the Council of Ministers. ARTICLE 5 FUNCTIONS AND POWERS OF THE BOARD The Board shall supervise the affairs of the Authority and the exercise of the duties and powers provided for in this Law. ARTICLE 6 MEETINGS a) The Board shall meet at least four times a year. The Chairman may at any time call an extraordinary meeting of the Board. The Chairman shall also call an extraordinary meeting of the Board within fourteen days of receipt of a request for that purpose addressed to him in writing and signed by any two other Board members or by the General Director. In all events, the notice calling for the extraordinary meeting of the Board must state the purpose of such meeting. b) A meeting of the Board shall be duly convened only if attended by at least three Board members. c) Decisions of the Board shall be by a majority of votes of

---

members present and voting and, in the event of equal votes, the side that the Chairman has voted for shall prevail over the other side. d) The Board shall appoint a secretary who shall prepare its agenda, record minutes of the meetings, maintain all papers and documents of the Board, and carry out any tasks assigned to him by the Board. e) The Board may invite the General Director or any other Person to attend any meeting of the Board where it considers it necessary to do so, but that Person shall not vote on any matter before the Board and shall not count for the purposes of forming a quorum. ARTICLE 7 CONFLICT OF INTERESTS a) No Board member shall have a direct or indirect equity or other financial interest in a Licensee. b) Where a Board member has a personal interest, directly or indirectly, in any matter to be considered by the Board or any other financial interest that may conflict withthe requirements of his position as a Board member, the Board member shall, assoon as he becomes aware that the matter is to be considered by the Board, disclose his interest in writing to the Board. c) In the case provided for in the preceding subparagraph, the Board member shall not take part in the consideration of the matter, and he shall not vote on the matter. The disclosure shall be recorded in the minutes of the Board meeting. CHAPTER 4 THE GENERAL DIRECTOR ARTICLE 8 APPOINTMENT AND VACANCY OF OFFICE The General Director shall be appointed by a decree based on the proposal by the Council of Ministers upon the recommendation of the Board for a period of three years, and his term of office may be renewed only once for another similar period. In the event of the office of the General Director becomes vacant upon the expiry of the term of office, resignation, dismissal or death of the General Director, a replacement shall be appointed by virtue of the same instrument as indicated and in the same manner. The Chairman or any duly qualified Person appointed by the Board shall assume the position on a temporary basis until a new General Director is appointed. ARTICLE 9 COMPETENCE The powers of the Authority as set forth in this Law shall be exercised by the General Director, who shall in this respect be subject to the supervision of the Board. Unless this Law expressly provides otherwise, the General Director shall have the final authority in the exercise of such powers. ARTICLE 10 REMUNERATIONS The amount of remuneration, including allowances and other benefits, paid to the General Director shall be set by the Board, having regard both to the then current market salaries of chief executive officers, whether of major corporations in the Kingdom, or of services sectors regulators outside the Kingdom. ARTICLE 11 RESIGNATION OF GENERAL DIRECTOR The General Director may resign his office by submitting a written application at least three months in advance to the Board in order for the latter to submit it to the Council of Ministers. A decree accepting the resignation shall be issued upon the proposal of the Council of Ministers. ARTICLE 12 REMOVAL OF GENERAL DIRECTOR FROM HIS POST a) The General Director may be dismissed from office before the expiry of the term of his office by a decree, based on a proposal by the Council of Ministers issued on the recommendation of the Board, on grounds of material breach of his employment contract, gross misconduct, inefficiency, fraud, dishonesty or inability to perform the duties of his office arising from infirmity of body or mind. b) Prior to his dismissal, the General Director shall be given reasonable opportunity to defend himself before the Board. Until the date of his dismissal, the General Director shall continue to serve in accordance with this Law. ARTICLE 13 STRUCTURE OF THE AUTHORITY a) The General Director shall determine the internal structure and organisation of the Authority, whilst giving due consideration to the Authority’s budget as approved in accordance with the provisions of Article 17 of this Law. b) The General Director may authorise in writing any employee of the Authority to carry some of his functions and in such a manner as shall be best conducive to the proper dispatch of the business of the Authority. ARTICLE 14 EMPLOYMENT AND REMUNERATION OF STAFF a) The General Director shall, after receiving the consent of the Board, determine the conditions of employment of the Authority’s staff and specify such salaries and benefits payable thereto as shall attract efficient and experienced professionals to work for the Authority, whilst observing in the determination of salaries and benefits the restriction provided for in Article 22(a) of this Law. b) The General Director may employ such staff and consultants for the Authority as will enable it to meet its obligations and exercise its powers and fulfil its duties under this Law, whilst giving due consideration to the Authority’s budget as approved in accordance with Article 17 of this Law. CHAPTER 5 THE MINISTER ARTICLE 15 RESPONSIBILITIES OF THE MINISTER a) Within 3 months of the effective date of this Law, and every three years thereafter, the Minister shall, in consultation with the Authority, prepare the National Telecommunications Plan to be approved by a resolution to be issued by the Council of Ministers. Such plan shall include the strategic plan and the general policy with respect to the Telecommunications sector and such resolution shall be published in the Official Gazette. In exceptional circumstances and when necessary, such plan may be prepared for shorter periods. b) The Minister shall carry out the following tasks: 1. supervising the implementation of the National Telecommunications Plan. 2. following up the implementation of the policy relating to Universal Services, proposing any amendments in connection therewith and submitting such amendments to the Council of Ministers for approval. 3. promoting investment in the Telecommunications sector in the Kingdom and creating a competitive environment among Licensed Operators,

---

so as to enable Subscribers and Users to receive state of the art Telecommunications services at the most suitable prices. c) 4. following up the fulfilment of obligations arising under international Telecommunications conventions to which the Kingdom is a party. 5. representing the Kingdom in regional, Arab and international organisations and committees that are concerned with Telecommunications affairs and coordinating with other concerned ministries and departments. The Minister may delegate such representation to the Authority. 6. proposing drafts of laws pertaining to the Telecommunications sector in coordination with the Authority. 7. working to remove obstructions from the Telecommunications sector, in coordination and co-operation with the Authority and the concerned authorities, and in such a way as to assist the Authority in carrying out its responsibilities. In order to avoid a conflict of interest and without prejudice to the provisions of Article 41 of this Law, the Minister shall not have any direct or indirect interest in a Licence, exercise management control over a Licensee or participate in the management of a Licensee; provided that this shall not prevent the government from holding shares in a Licensee as long as the Minister is not responsible for exercising rights over such shares. The restriction provided for in this paragraph applies to the senior officials of the Ministry and other officials with responsibilities for the Telecommunications sector. ARTICLE 16 INDEPENDENCE OF THE AUTHORITY The Minister may at any time advise the Authority in writing of his opinion on any matter of government policy relating to Telecommunications. The Authority shall study the proposals made by the Minister in this respect and shall act to carry out such proposals in such a manner as does not conflict with its responsibilities and powers as provided for under this Law. CHAPTER 6 FINANCIAL AND RELATED MATTERS ARTICLE 17 ANNUAL ACCOUNTS, REPORT AND AUDIT a) The start and end of the financial year of the Authority shall be determined by a resolution issued by the Board. b) The Authority shall have an independent budget and maintain audited reports for each financial year. c) The General Director shall, in co-ordination with the Ministry of Finance and National Economy, prepare a draft budget for the Authority for the next financial year and submit such draft to the Board three months before the end of the financial year. The Board shall approve such draft within three months of submission. If the draft budget is rejected by the Board or if such period expires without approval of the draft by the Board, the budget for the previous year shall remain in effect, adjusted for inflation using the official inflation rate. The Board should indicate in writing the grounds for rejecting a draft budget. d) The Board shall, at the beginning of every financial year, appoint an independent auditor of international standing to audit the Authority’s accounts. The Authority shall cause its accounts to be audited by the independent auditor within three months of the end of each financial year. The auditor’s report shall be submitted to the Board by the auditor not later than five months from the end of the financial year and shall draw any financial irregularity or shortfall to the attention of the Board. e) The General Director shall prepare and submit to the Board, not later than six months from the end of the financial year, an annual report in such form as the Board may direct on the activities of the Authority, and shall enclose with such report a copy of the audited accounts of the Authority, the auditor’s report and the information set forth in Article 54 of this Law. f) Immediately after the Board approves the audited accounts of the Authority, the Authority shall publish a summary of its audited accounts in the Official Gazette and in two local daily newspapers, one of which is published in Arabic and the other in English. ARTICLE 18 FUNDING OF THE AUTHORITY a) Funding of the operations and activities of the Authority shall be derived from the following sources: 1. application, initial and renewal fees charged for Licences. 2. Revenue of annual Licences' fees based on the gross annual turnover of the Licensee resulting from Individual Licence and Class Licence shall be set by the Authority by virtue of a resolution, provided that such fees shall not exceed two percent (2%) of such gross annual turnover. The Authority may, either through the conditions applicable in the Class Licence or through resolution, apply a fixed fee for any type of Class Licensee. 9 3. fees charged by the Authority for any services that it provides. 4. fines collected by the Authority from Licensees on the basis of the Licences granted to them. Fines to be collected by the Authority shall not be taken into 9 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 consideration when preparing the annual budget. b) Any increase in the fees provided for in subparagraphs (a)(1) and (2) of this Article shall be approved by the Board, provided in all cases that fees shall not exceed the percentage provided for in subparagraph (a)(2) of this Article. The Board shall indicate in writing the grounds for a refusal to increase fees. c) Activities and operations of the Authority shall be funded from the General State Budget during the year that follows the date on which this Law shall enter into force, provided that the activities of the Authority shall thereafter be funded from the revenues provided for in paragraph (a) of this Article and if such revenue is insufficient, the provisions of the following paragraph shall apply. d) The Authority may, after co-ordination with the Ministry of Finance and National Economy, submit an application to the Council of Ministers for a grant from the public treasury to cover a deficit shown in its approved budget, including where the deficit results

---

from non-payment by the Licensees of the fees payable to the Authority, provided that the Authority shall use such grant for funding the expenses included in its approved budget. The Authority may fund the deficit by borrowing in accordance with the provisions of Article 20 of this Law. ARTICLE 19 THE AUTHORITY’S EXPENDITURE a) b) The Authority shall use the revenues collected by it under this Law in accordance with its approved budget to fund its activities, including: 1. meeting the administrative and operating costs of the Authority. 2. payment of salaries, wages, remuneration and allowances, and other financial benefits payable to the General Director and staff members of the Authority, pensions and social insurance. 3. meeting its requirements that are necessary for the effective and efficient carrying out of its duties, be such requirements real or moveable property, including apparatus, machinery and equipment or any other items within the category of capital expenditure. 4. maintenance of real or moveable property owned by the Authority. 5. meeting expenses that are necessary for carrying out the duties of the Authority as specified under this Law. Any cash surplus actually accrued to the Authority on its approved budget for the previous financial year shall be delivered to the public treasury within one month after the date on which the accounts audit is completed in accordance with the provisions of Article 17(d) of this Law. The Authority may keep all or part of a budget surplus for funding future development projects after coordinating with the Ministry of Finance and National Economy and with the consent of the Council of Ministers. ARTICLE 20 BORROWING POWERS Without prejudice to the prescribed procedures for obtaining a public loan, the Authority may, after coordinating with the Ministry of Finance and National Economy and with the consent of both the Board and the Council of Ministers, borrow such sums of money as are required for the exercise of its duties under this Law. The Board should indicate in writing its ground for refusing any borrowing. ARTICLE 21 CONFLICT OF INTERESTS a) Neither the General Director nor any staff member of the Authority shall have a direct or indirect interest in the telecommunication sector throughout the term of his tenure or employment at the Authority. Each of them shall promptly serve a notice of any such interest that arises or is likely to arise during his tenure or employment at the Authority. The notice referred to shall be served on the Board in the case of the General Director, and on the General Director in the case of the other staff members of the Authority. b) c) The General Director and the staff members of the Authority shall each present a written declaration when commencing occupation of the office or position and annually thereafter, as to: 1. any direct or indirect interest he has in the Telecommunications sector and which he is aware of. 2. any direct or indirect interest in the Telecommunications sector of one of his relatives up to the third degree which he is aware of and that conflicts with the requirements of his office or position at the Authority. The Board may disregard the ordinary and non-material interests of either the General Director or any staff member which do not conflict with the requirements of office or position in the Authority. In such case the resolution of the Board shall specify the grounds on which it is based. If the Board so exercises its authority it shall publish notice of such action in the register of interests referred to in Article 52 of this Law, stating the name and position of the Person and details of such interest. d) The Board, in determining the extent of which the interest of the General Director or staff member of the Authority may conflict with the interest of the Authority, shall consider: 1. the degree to which the economic interest of the company or any other entity related to the interest may be affected by actions of the Authority. 2. the extent to which the Authority regulates and oversees the activity of the company or other entity related to the interest. 3. the seniority or position of the relevant staff member. 4. the perceptions held or likely to be held by the public when the public learns of the relevant Person’s interest in the company or other entity related to the interest. ARTICLE 22 OUTSIDE EMPLOYMENT OF THE GENERAL DIRECTOR AND THE AUTHORITY’S STAFF a) Neither the General Director nor any staff member of the Authority may, during his tenure or term of employment, engage in any employment, consulting or similar service relating to the Telecommunications industry in the Kingdom outside the duties of his office or employment or engagement by the Authority. For one year after such term, neither shall engage in such employment, consulting or similar service without the prior written approval of the Board. b) No employer shall employ the General Director or the Authority’s staff members in contravention of subparagraph (a) of this Article. ARTICLE 23 CONFIDENTIALITY The General Director and staff members of the Authority shall not be permitted to divulge any confidential information which may come directly or indirectly to their knowledge during the course of their work. This obligation shall continue even after such Persons leave the service of the Authority. CHAPTER 7 LICENSING AND EQUIPMENT APPROVALS ARTICLE 24 REQUIREMENT TO OBTAIN A TELECOMMUNICATIONS LICENCE a) No Person shall operate a Public Telecommunications Network, any Telecommunications Network using a Telecommunications Frequency or provide a Telecommunications service in the Kingdom except after obtaining a Licence or unless exempted by the Authority in accordance with the provisions of this Law. The Authority shall issue a decision specifying the conditions of such exemption. 10 b) No Person shall, without permission (to be granted in accordance with the conditions of the relevant Licence), connect to a Telecommunications Network licensed under this Law any other Telecommunications Network or any Telecommunications Equipment that is not authorised under

---

Article 38 of this Law. c) No Person shall operate or promote a call-back service from or to the Kingdom. ARTICLE 25 GRANT OF TELECOMMUNICATIONS LICENCES a) A Licence for the operation of a Telecommunications Network or for the provision of Telecommunications services may be granted for a finite period of time by the Authority by way of either an Individual Licence or a Class Licence in accordance with the provisions of Articles 29 and 32 of this Law. b) The granting of a Licence in accordance with the provisions of this Law shall not prejudice any other conditions, licenses, permits or obligations provided for in any other law. ARTICLE 26 REQUIREMENTS RELATED TO INDIVIDUAL AND CLASS LICENCES a) b) In order for a Licence to be granted, the following is required: 1. that the Licence applicant be a juristic entity incorporated in the Kingdom, or a branch of a foreign company licensed to operate in the Kingdom in accordance with the Commercial Companies Law. 2. that substantially all the infrastructure and personnel associated with the provisions of Telecommunications services are located in the Kingdom. The Authority alone shall have the right to waive the conditions provided for in subparagraph (2) of paragraph (a) of this Article in either of the following two cases: 1. there exists substantial demand for a Telecommunications service that cannot be provided on an efficient basis other than by means of infrastructure and personnel located outside the Kingdom, provided that such a service will be to the direct benefit of Subscribers and Users, as determined by the Authority on the basis of the obligations provided for in the License or otherwise. 2. if Licensees breach the obligations provided for in Article 65(a) of this Law. 10 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 ARTICLE 27 SUBMISSION OF THE LICENCE APPLICATION a) An application for a Telecommunications Licence shall be made in writing addressed to the Authority in the form prepared by the Authority for this purpose and accompanied by such information and evidence of payment of the application fees as determined by the Authority by a resolution issued in accordance with the provisions of this Law. The Authority shall notify the applicant in writing within fourteen days of its receipt of the application. b) The Authority shall, if it decides not to grant the Licence, notify the applicant of the decision and of the reasons for its decision in reasonable detail. ARTICLE 28 CONTENTS OF A TELECOMMUNICATIONS LICENCE a) A Telecommunications License is personal and may not be assigned to a third party without the prior written consent of the Authority. b) A Telecommunications License granted by the Authority shall be issued in writing and, unless revoked pursuant to the provisions of Articles 31 or 34 of this Law, shall continue in full force and effect for such period as may be specified in the Licence. c) A Telecommunications Licence may include: 1. such terms and conditions as the Authority determines are necessary and reasonable. 2. terms and conditions requiring the Licensee to provide to the Authority, in such manner and at such times as may be reasonably required, such documents, data, accounts, estimates, returns or other information as the Authority may require for the purpose of exercising its powers and fulfilling its duties under this Law. ARTICLE 29 INDIVIDUAL LICENCES a) An Individual Licence may only be granted on the recommendation of the General Director and following ratification thereof by the Board within thirty days after the date on which the recommendation of the General Director is put to the Board. If the Board refuses to ratify his recommendation or when such period expires without ratification, the General Director may resubmit the matter within 30 days to the Board for a final decision by the Board within 30 days of the re-submission. If the recommendation of the General Director is refused, the Board shall, in all cases, indicate the grounds of such refusal in writing. b) The Authority may, with the written approval of the Board, hold an auction for Individual Licences in accordance with rules and procedures issued by the Authority. Such auction shall be announced in such manner as the Authority deems appropriate at least thirty days prior to the date of holding such auction. The Licence shall in this case be granted without requiring the ratification of the Board. c) The Authority shall, before giving a final decision with respect to all applications for Individual Licences, ensure that the applicant has satisfied the conditions provided for in this Law and in the laws, regulations and resolutions issued in implementation of the provisions of this Law, with particular regard to whether: d) e) 1. the applicant has sufficient resources, skills and expertise in the field of the subject matter of the application. 2. the applicant meets such criteria for the Licence applied for as are determined and issued by the Authority from time to time. 3. the interests of Subscribers and Users will be served. 4. competition among Licensed Operators will be promoted. The Authority shall, within a period not exceeding ninety days of the application, decide on the Licence application and if the Authority considers it necessary to obtain any further information, the Authority shall notify the applicant of such requirement within a period not exceeding thirty days after date of the submission of the application. In such case, the final decision shall be passed within the longer of: 1. thirty days from the date of receipt of such required further information, and 2. one hundred and fifty days from the date of submission of the Licence application. Individual Licences shall have standardised terms and conditions as far as practicable, and any differences shall be for objectively justifiable reasons. Without prejudice to the foregoing, the Authority may grant to an applicant who does not

---

have significant market power a Licence on terms and conditions that are more favourable than another Licensed Operator with significant market power. f) Within seven days of the grant of a Licence, the Authority shall notify the applicant that the Licence is available for collection. Such notice shall be sent to the address specified by the applicant. The Authority shall publish the Licence in the Official Gazette as soon as is practicable after granting it. g) Any Person that directly or indirectly acquires five percent or more of the shares of an Individual Licensee shall notify the Authority of such matter within seven days from the date that Person acquires such shares. ARTICLE 30 RENEWAL OF AN INDIVIDUAL LICENCE a) Without prejudice to the provision of paragraph (b) of this Article, an Individual Licence issued under this Law shall be renewed on the request of the Licensee, for further limited term in accordance with the conditions of the Licence. b) The Authority may refuse to renew an Individual Licence if it discovers that the Licensee is, or has been, in material breach of the conditions of the Licence, whether or not the Authority took enforcement action to obligate the Licensee to comply with the conditions of the Licence in accordance with the provisions of Article 35 of this Law. c) The Authority shall notify the Licensee of its intention to refuse renewal of the Licence at least two years prior to the expiry of the current Licence term and if a material breach occurs within two years of the expiry of the current Licence term, it shall notify the Licensee promptly upon becoming aware of such breach. In all cases, the notice shall state the reasons for such refusal. d) The Authority shall consider the responses given by the Licensee during the current Licence term, before making its decision as to refusing the renewal of the Licence. ARTICLE 31 MODIFICATION AND REVOCATION OF INDIVIDUAL LICENCES The Authority may modify the terms and conditions of, or revoke, an Individual Licence in the following circumstances: 1. with the consent of the Licensed Operator for such modification or revocation. 2. such modification or revocation is in accordance with any of the conditions provided for in such Licence. 3. that the modification or revocation is in accordance with the provisions of Article 35 of this Law. 4. that the modification or revocation is in accordance with the provisions of this Law. ARTICLE 32 THE CLASS LICENCE a) The operation of a Telecommunications Network or the provision of Telecommunications services shall be authorized by way of a Class Licence with the exception of Licences connected with any of the following: 1. the use of radio frequency spectrum. 2. the use of telephone numbers under the National Numbering Plan. 3. the provision of the services provided for in Article 39(b)(1) to 39(b)(9) of this Law, in which case an Individual Licence is required. b) A Class Licence shall be granted to the applicant for such Licence if such applicant meets the conditions issued and published by the Authority from time to time concerning such type of Licences. The Authority may require the applicant to provide any further information. c) The Authority shall prepare a sample application form for a Class Licence, which shall be published in the manner that the Authority considers appropriate for bringing it to the attention of interested parties. ARTICLE 33 RENEWAL OF CLASS LICENCE The provisions provided for in Article 30 of this Law shall apply to the renewal of a Class License. ARTICLE 34 MODIFICATION AND REVOCATION OF CLASS LICENCES a) When it intends to amend or revoke any Licence, the Authority shall announce such matter in the Official Gazette at least thirty days before the amendment or revocation. The announcement shall state the following: 1. that the Authority intends to amend or revoke that type of Class Licence, setting out the effect of such modification or revocation. 2. the reasons that justify the modification or revocation. 3. that the holders of Class Licences are entitled to respond in writing to the Authority within the notice period specified by the Authority in the announcement. b) After consideration of the responses submitted during such notice period, the Authority shall issue the appropriate decision which shall be announced in the Official Gazette and in such manner as the Authority considers appropriate to bring the matter to the attention of the Licensees of the type of Class Licence being modified or revoked. ARTICLE 35 ENSURING COMPLIANCE WITH INDIVIDUAL AND CLASS LICENCES a) If it is apparent to the Authority that a Licensee has been or is in material breach of any provision of this Law or any condition of the Licence or that there are serious indications or evidence that a Licensee is likely to commit such breach, the Authority shall issue an order in accordance with the procedures provided for in paragraphs (b), (c) and (d) of this Article by taking the measures it considers necessary to secure compliance by the Licensee with the provisions of this Law and the conditions of the Licence, and sending a copy of such order to the Licensee. b) Before issuing such order, the Authority shall notify the Licensee in writing, stating: 1. the order to be issued, and its effect. 2. aspects of breach by a Licensee of any condition of the Licence, and the act or omission which in the opinion of the Authority constitutes such breach, or such indications and evidence which in the opinion of the Authority make the occurrence of the breach likely. 3. the notice period for responding to the proposed order, which shall be not less than thirty days from the date of the notice. c) The Authority shall consider any response submitted to it in writing within the specified period. d) Following expiry of such notice period, the Authority may issue an order containing the following: 1. a direction to the Licensee to do or to refrain from doing

---

such things as are specified in the order to remedy, prevent or rectify the breach which is the subject matter of the notice referred to in paragraph (b) of this Article. 2. the imposition of an appropriate fine on the Licensee, provided that such fine is objectively justified and when assessing the fine the principle of justice and equality amongst the Licensees shall be considered. 3. warning the Licensee that the Licence may be revoked if the Licensee fails to comply with such direction or to pay the fine. If the Licensee fails to comply with any direction given or to pay the fine provided for in the preceding paragraph within the time determined by the Authority, the Authority may revoke the Licence, provided that it shall notify the Licensee accordingly. ARTICLE 36 APPEALING AGAINST DECISIONS AND ORDERS A Licensee may object to the Authority against any decision or order issued in accordance with the provisions of this Law and the Licensee shall have the right to appeal against the decision or order in accordance with the provisions of Chapter Sixteen of this Law. ARTICLE 37 EFFECTS OF TERMINATION OF A LICENCE a) As a result of the revocation or non-renewal of a Licence, all rights and obligations of the Licensee under such Licence shall cease with effect from the date of the revocation or expiry of the term of the licence, as the case may be. b) No Licensee shall accept new subscriptions as of the date on which it is notified of the revocation or non-renewal of the Licence. Such Licensee shall not continue to operate as of such date except with the written consent of the Authority and during the period specified by the Authority and for so long as is necessary for the Subscribers to transfer to another Licensee. ARTICLE 38 APPROVAL OF EQUIPMENT AND DESIGNATION OF STANDARDS a) Telecommunications Equipment may be approved by the Authority for connection to a Telecommunications Network either by way of: 1. regulations issued by the Authority in accordance with this Law. 2. a certificate issued by the Authority (or any Person or entity approved to undertake this purpose by virtue of a resolution issued by the Authority, including, the manufacturer of the equipment) in respect of any type of Telecommunications Equipment based on the application of the Licensee or the manufacturer or supplier of the equipment. b) The Regulation or certificate shall indicate compliance with the technical standards issued by international standard-setting bodies designated from time to time by the Authority. c) Any Person applying for approval under paragraph (a) of this Article may be required by the Authority to comply with such requirements as the Authority may consider appropriate having regard to the duties provided for in Article 3 of this Law and to pay such fee as is prescribed by a resolution issued by the Authority. d) An approval of Telecommunications Equipment under this Article may apply either to particular equipment or to any equipment of a certain specification indicated in the Regulations issued by the Authority or in the certificate issued in this respect, and such approval shall also apply either for the purposes of a particular Telecommunications Network or for any Telecommunications Network of a certain specification. e) The approval provided for in this Article may specify the technical and functional specifications, standards or any other technical specifications to which the Telecommunications Equipment must conform. The approval may specify terms and conditions with which Licensees, manufacturers or suppliers must comply, for the approval to be valid. f) The Authority shall have the power, where warranted, to vary or withdraw an approval given under this Article provided that prior notice of such variation or withdrawal shall be given to the Licensee. CHAPTER 8 TIMETABLE FOR INTRODUCING COMPETITION ARTICLE 39 TIMETABLE FOR ISSUING LICENCES FOR INTRODUCING COMPETITION a) As an exception to any provision in this Law, provision of the services provided for in paragraph (b) of this Article shall be licensed by the Authority in accordance with the time table contained in the same paragraph; provided that where no compliant applications are received or no acceptable tenders or bids exist (as the case may be) for the Licence referred to in subparagraph (1) of paragraph (b) of this Article, the Authority shall re-initiate the process for such Licence as soon as practicable. b) In addition to any Licence granted to Batelco pursuant to the provision of Article 80(e) of this Law, each of the following services shall be licensed by the Authority in accordance with the provisions of this Law, by the date set forth in each category: 1. Mobile Telecommunications Licence: one such GSM Licence (including the right to provide third generation and associated services) shall be granted as soon as practicable, but in any event within six months of the effective date of this Law. The Authority may grant an additional mobile Telecommunications Licence of the same type within two years of the grant of such Licence if Batelco and the Licensee under this subparagraph engage in anti-competitive conduct as set forth in Article 65(a) of this Law. The Authority may, after such two-year period, grant further Licences at its discretion in this regard. 2. Mobile Virtual Network Operator Licence: one or more such Licences may be granted at the discretion of the Authority after two years following the grant of the mobile Telecommunications Licence referred to in the preceding paragraph. The Authority may grant a Licence of the same type within such period if the Licensees referred to in the preceding paragraph engage in anticompetitive conduct as set forth in Article 65(a) of this Law. 3. VSAT Licence: one or more such Licences may be granted, provided that this shall not be earlier than 1/1/2004. 4. Paging Licence: one or more such Licences may be granted, provided that this shall not be earlier than 1/1/2004. 5. Public Access Mobile Radio Service Licence: one or more such Licences may be granted, provided that this

---

shall not be earlier than 1/1/2004. 6. National Fixed Service Licence: one or more such Licences may be granted, provided that this shall not be earlier than 1/7/2004. 7. International Facilities Licence: one or more such Licences may be granted, provided that this shall not be earlier than 1/1/ 2004, and provided that no service shall commence before 1/7/2004. 8. International Services Licence: one or more such Licences to be granted, provided that this shall not be earlier than 1/7/2004. 9. Internet Exchange Licence: only one such Licence shall be granted within six months of the effective date of this Law, in accordance with the provisions of Article 41 of this Law. Additional such Licences may be granted after two years of the grant of the first Licence. 10. Internet Service Provider Licences And Value Added Service Licences: such Licences shall be granted as soon as practicable after the effective date of this Law. 11. Any new types of licenses determined by the Authority to reflect changes in technology in the Telecommunications sector. 11 ARTICLE 40 TIMETABLE FOR OTHER MATTERS a) Public Telecommunications Operators with Significant Market Power and every other Licensee whose Licence provides for the following obligations to Subscribers and Users or other Licensees provided for in his/its License shall provide the following: 1. Carrier Pre-Selection: with effect from 1/4/ 2004. 2. Number Portability in fixed services: when the Authority determines that sufficient demand exists for such a service. 11 Added by virtue of the Third Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 3. Number Portability in mobile services: when the Authority is satisfied that sufficient demand exists for such a service. 4. wholesale DSL services: with effect from 1/7/2003. 5. Access to Telecommunications Facilities, (including, DSL co-location, fibre that is not in service or only partially in service and, where the Authority so determines, ducts): from 1/7/2004. 6. Domestic Roaming: from no later than the date of the grant of the mobile Telecommunications Licence referred to in Article 39(b)(1) of this Law provided, however, such obligation shall cease after the one year anniversary of such date unless such period is extended by the Authority. ARTICLE 40(bis) FIXED TELECOMMUNICATIONS INFRASTRUCTURE NETWORK LICENCE a) The Authority shall make the Fixed Telecommunications Infrastructure Network Licence available. Unless the Authority determines otherwise, non-holders of this licence shall not deploy or maintain a fixed telecommunications infrastructure in the Kingdom, including in relation to the deployment and ownership of ducts and fibre optics. b) Notwithstanding the provisions of Article 57 of this Law, until such time as the Authority has issued a Fixed Telecommunications Infrastructure Network Licence pursuant to Paragraph (a) of this Article, the Authority may take the necessary transitional measures to: 1. limit the operational impact on the existing Licensed Operators. 2. adopt, implement and apply functional separation on a gradual basis. 3. safeguard equivalence between Licensed Operators. This may include requiring a Licensed Operator to offer Access on fair, reasonable and nondiscriminatory terms, including in relation to tariffs. The Authority may determine such tariffs and terms as it considers appropriate to safeguard equivalence. ARTICLE 41 BAHRAIN INTERNET EXCHANGE a) The Ministry shall carry out the procedures required to establish a not-for-profit entity to be known as the “Bahrain Internet Exchange”, provided that the Bahrain Internet Exchange shall submit to the Authority an application for an exchange licence within four months of the effective date of this Law. b) The object of the Bahrain Internet Exchange shall be to provide the holders of internet service Licences with a connection mechanism in which internet communications are aggregated, transmitted and distributed to licensed internet services providers. c) The first internet exchange Licence issued by the Authority shall be issued to the Bahrain Internet Exchange within sixty days of the date of the submission of the application for the Licence in accordance with the provisions of paragraph (a) of this Article. Such Licence shall be granted at no charge. d) The Charter of the Bahrain Internet Exchange shall incorporate the internal rules regulating its work, which rules are subject to the approval of the Authority, provided that the contents of such rules shall ensure equality between licensed internet service providers regarding Access to the Exchange. e) The government shall provide the initial funding or credit support required for the Bahrain Internet Exchange, provided that the Exchange shall aim to become selffunding as soon as is practicable. Licensed internet service providers and other users of the exchange shall bear its operating costs in an equitable usage-based manner, as set forth in the Articles of Association of the Exchange. f) The Bahrain Internet Exchange shall make its Telecommunications Facilities available to all Licensees of an internet service provider Licence on fair and nondiscriminatory terms and conditions. g) The Bahrain Internet Exchange shall have Access to the international Telecommunications Facilities of Batelco upon receipt of the Licence referred to in paragraph (c) of this Article. h) Licensed internet service providers shall use the facilities made available by the Bahrain Internet Exchange for two years from the date on which the Licence is issued to the Bahrain Internet Exchange. The internet service providers Licence may provide for the use of other facilities in case the operation of the Bahrain Internet Exchange ceases or the facilities of the Bahrain Internet Exchange are inadequate. i) The Authority may take such measures as it deems necessary to ensure that arrangements between internet service providers are in place such that local internet traffic remains within the Kingdom. 12 CHAPTER 9 RADIOCOMMUNICATIONS ARTICLE 42 SUPERVISION OF TELECOMMUNICATIONS FREQUENCIES 12 Added by virtue of the Third Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 a) The Radiocommunications Authority shall be responsible for overall frequency coordination in the Kingdom and it shall consult with

---

and take into account the requirements of the Authority in connection with Telecommunications Frequencies to enable it to carry out its duties as provided for in this Law. b) Within the framework of the National Frequency Plan, the Authority shall be responsible for the co-ordination, Assignment, and monitoring the enforcement of Telecommunications Frequencies. c) The procedures followed in the Assignment of frequencies, shall be objective, transparent, timely and non-discriminatory. ARTICLE 43 FREQUENCY LICENSE No Person shall operate a Telecommunications Network which uses frequency spectrum in the Kingdom, or operate or use any Radiocommunications Equipment without obtaining a Frequency License from the Authority unless that it is operating on a frequency which the Authority, by way of a decision, has exempted from holding a Frequency License whilst operating in accordance with the terms and conditions of such exemption.13 ARTICLE 44 GRANT OF A FREQUENCY LICENSE a) An application for a Frequency License shall be in writing addressed to the Authority in the form prepared by the Authority for this purpose and accompanied by such information and evidence of payment of the application fees as the Authority shall prescribe by way of a resolution issued in accordance with the provisions of this Law. The Authority shall notify the applicant in writing within fourteen days of its receipt of the application. b) The Authority may require further information in support of the application, including information on the purpose of establishing any Radiocommunications Station, and the types and specifications of Radiocommunications Equipment which will be operated or used. c) The Authority shall, within a period not exceeding thirty days after the date of submission of the application, decide on the application. If the Authority considers it necessary to obtain any further information, the Authority shall notify the applicant of such requirement within fifteen days of the submission of the application. In such case, the final decision shall be passed within the longer of: 1. fifteen days from the date of receipt of such required information, 2. sixty days from the date of submitting the licence application. 13 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 d) The Authority shall, before issuing its decision with respect to the License application, ensure that all the conditions provided for in this Law and in the Regulations and Resolutions issued in enforcement of the provisions hereof with respect to the application for the Licence are satisfied, and shall have regard to the following: 1. the availability of Telecommunications Frequencies and coverage and allocation of Radiocommunications Stations. 2. that the decision issued with respect to the Licence application shall not conflict with the National Frequency Plan. 3. the provisions relating to the introduction of competition provided for in Article 39 of this Law. 4. ensuring the efficient and competent use of radio frequency spectrum. 5. any other factors relating to the field of Telecommunications Frequencies. The Authority shall, immediately upon issuing a decision to reject an application for a Frequency License, notify the applicant of the reasons for its refusal. e) The grant of a Frequency License in accordance with the provisions of this Article shall not prejudice any conditions, licences, permits or other obligations provided for in any other law. f) Without prejudice to the foregoing, the Authority may, with the approval of the Council of Ministers, hold an auction for the grant of Frequency Licenses in accordance with rules and procedures issued by the Authority. Such auction shall be announced in such manner as the Authority deems appropriate at least thirty days prior to the date of holding such auction. g) The Frequency License granted in accordance with the provisions of this Article is personal and may not be assigned without the prior written consent of the Authority. ARTICLE 45 CONTENTS OF A FREQUENCY LICENSE A Frequency License shall include, in the opinion of the Authority, such necessary terms and conditions, including in particular, terms relating to the efficient use of radio frequency spectrum. ARTICLE 46 USE OF RADIOCOMMUNICATIONS STATIONS FOR NAVIGATION PURPOSES No vessel that arrives at the ports or coasts of the Kingdom or aircraft that lands in the airports of the Kingdom shall use its own Radiocommunications Stations for any purpose other than the purposes of sea or air navigation, rescue and emergency operations without obtaining a Frequency License. No foreign vehicle shall use the Radiocommunications Stations located in the Kingdom except after obtaining a Licence therefore. The Radiocommunications Authority shall, in coordination with the Authority, take the necessary measures to report to the government of the relevant country of any acts that take place onboard any aircraft, vessel or foreign vehicle which constitute a violation of the provisions of this Law. ARTICLE 47 MIGRATION OF FREQUENCIES a) b) Within three months of the effective date of this Law, any user of the following frequencies shall cease to use such frequencies and inform the Authority in writing that such frequencies are available for Assignment by the Authority in accordance with Article 44 of this Law: 1. a contiguous set of GSM channels equal to 50% of the total available channels in the 900 MHz band, as directed by the Authority. 2. a contiguous set of GSM channels equal to 66.67% of the total available channels in the 1800 MHz band, as directed by the Authority. A User of frequencies who has complied with the provision of paragraph (a) of this Article shall have the right to such pro rata rebate of the annual fee that it has paid as is proportionate to the period of use remaining. ARTICLE 48 COMPLIANCE WITH INTERNATIONAL TREATIES AND OTHER LEGISLATION In exercising the powers provided for in this chapter, the Authority shall comply with the obligations arising from international treaties to which the Kingdom is a party and the provisions of legislation regulating air and maritime traffic and meteorology. ARTICLE 49 PREVENTING

---

HARMFUL INTERFERENCE WITH RADIOCOMMUNICATIONS No Person shall unlawfully use any Telecommunications Equipment for the purpose of causing harmful interference with any communications or continue to cause such harmful interference after receipt of an order from the Authority to cease such interference unless such interference is caused by force majeure or emergency or rescue operations. ARTICLE 50 OBLIGATIONS OF A FREQUENCY LICENSEE Without prejudice to any condition contained in any Frequency License: 1. The operation of a Telecommunications Network that uses radio frequency spectrum is the sole responsibility of the relevant Licensee. 2. The Frequency License holder and its employees and agents may not use a secret sign or code in messages and conversations over the Telecommunications Network in contravention of the provisions of this Law and the regulations issued for the enforcement of this Law. ARTICLE 51 MODIFICATION AND REVOCATION OF A FREQUENCY LICENSE a) Subject to the provisions provided for in Article 34 of the Law, the Authority may modify the conditions of a Frequency License. b) The Authority shall have the right to revoke a Frequency License before the expiry of its term in any of the following cases: 1. the Licensee consents to the revocation. 2. revocation by the Authority in the same circumstances and by virtue of the procedures provided for in Article 35 of this Law. 3. expiry or revocation of any Telecommunications Licence relating to the Licensee’s own Frequency License. 4. the Licensee is adjudged bankrupt by a competent court or ceases exercising its commercial activity. In both cases, the Licence is deemed automatically terminated and all the frequencies constituting the subject matter of the Licence shall revert to the Authority. CHAPTER 10 REGISTER, INFORMATION AND DISPUTES BETWEEN LICENSEES AND SUBSCRIBERS ARTICLE 52 THE REGISTER a) The Authority shall maintain one or more registers to record the following: 1. the categories of Licences issued. 2. all Licences granted. 3. all Licences revoked. 4. all Licensees determined to be in a Dominant Position. 5. all regulations issued by the Authority and certificates issued in respect of Telecommunications Equipment in accordance with the provisions of Article 38 of this Law. 6. the Authority’s most recent audited accounts pursuant to the provisions of Article 17(d) of this Law, including the auditor’s report. 7. all resolutions issued by the Board waiving ordinary and non-material interests concerning the General Director and any of the Authority’s staff members in accordance with the provisions of Article 21(c) of this Law. 8. other matters that this Law, the regulations or resolutions issued by the Authority require to be entered in the register. The Authority shall keep such register at its principal office and in such form as the Authority may consider appropriate, and shall publish this information in the annual report referred to in Article 17(e) of this Law. b) The Authority shall enter in the register, in particular, the details of: 1. each Licence granted, details of the relevant Licensee, and every modification or revocation of, and every order, consent, notice given, or decision made or revoked in respect of such Licence. 2. all certificates issued and regulations made by the Authority, and any decision that is issued by way of variation, withdrawal or revocation of any of the same. The Authority may, at the request of the Licensee or an interested party, decide not to enter any of the details referred to in subparagraphs (1) and (2) of this paragraph if it determines that this would be contrary to national security, would disclose a business secret or any other confidential information. c) Any Person may inspect the entries in the register during such hours as may be prescribed by the regulations and decisions issued by the Authority in this respect in accordance with the provisions of this Law. d) Any Person may request the Authority to provide him with an official copy of the data recorded in the register, after payment of such fee as may be prescribed in a decision issued by the Authority. ARTICLE 53 UNDERTAKING TO PROVIDE THE AUTHORITY WITH INFORMATION a) Licensed Operators shall provide the Authority, upon its request, with all such information, including information relating to financial matters, as is needed to enable the Authority to carry out its duties and exercise its powers as provided for in this Law, provided that the Authority shall indicate the reasons which justify its request. The Licensee shall furnish such information to the Authority without delay, at such time and in such details as the Authority may specify. b) Without prejudice to the provisions of the preceding paragraph, the Authority shall from time to time collect information relating to the level of overall performance achieved by Licensees and the cost of such performance in connection to the operation of Telecommunications Networks and the provision of Telecommunications services. The Licensees shall furnish the Authority with information relating to the level of their performance in respect of each obligation prescribed in the conditions of the Licences issued to them or in the regulations or decisions issued in this respect, at such time and in such details as the Authority may specify. ARTICLE 54 PUBLICATION OF INFORMATION a) The Authority shall, at least once a year, arrange for the publication, in such form and manner as it deems appropriate, of the information collected in accordance with the provisions of this Law as may appear to the Authority to be appropriate, including such information and advice as may be necessary to the Subscribers and Users. b) When fulfilling the obligation referred to in the preceding paragraph, the Authority shall comply with the need to exclude any information which relates to the private affairs of a Person and information whose publication might, in the opinion of the Authority, seriously and prejudicially affect the interests of any Person. ARTICLE 55 PROCEDURES FOR DEALING WITH COMPLAINTS a) Each Licensee shall establish procedures for dealing with complaints by Subscribers in relation to the operation of a Telecommunications Network or provision of Telecommunications services. b) The

---

Licensee shall publish the procedures indicated in the regulation referred to in the preceding paragraph in such a manner as the Authority shall prescribe and shall provide a description of those procedures, free of charge, to any Person on request. c) The Authority may direct any Licensee to review the articles of the procedures referred to in paragraph (a) of this Article or the manner in which the procedures operate and require modifications. ARTICLE 56 DISPUTES BETWEEN LICENSEES AND SUBSCRIBERS a) Any dispute between a Subscriber and a Licensed Operator may be referred to the Authority by either party after the exhaustion of the procedures referred to in Article 55 of this Law without resolution within sixty days after the date of submitting the complaint to the Licensee. b) The Authority may combine disputes regarding the same subject-matter or Persons into a single dispute and determine such disputes by virtue of one decision. c) The Authority shall issue a reasoned decision with respect to the dispute referred to it and may oblige the parties to the dispute to pay appropriate costs. d) The Authority shall promulgate regulations establishing the procedures to be followed in determining disputes referred to the Authority. CHAPTER 11 INTERCONNECTION AND ACCESS ARTICLE 57 INTERCONNECTION AND ACCESS a) A Public Telecommunications Operator shall have the right to Interconnection and shall negotiate in good faith on request for the Interconnection to its Telecommunications Network at any technical feasible point to the Telecommunications Network of another Public Telecommunications Operator and in each case as specified in its Licence or in the regulations issued by the Authority. b) A Public Telecommunications Operator determined by the Authority to have a Dominant Position in a particular Telecommunications market shall, within three months of such determination and at such times as the Authority may determine, publish a reference Interconnection offer after obtaining the Authority’s approval to such offer. Such offer shall include a full list of basic Interconnection services, conditions of Interconnection and the tariff for every service. The Authority may issue an order specifying the terms and conditions and the tariffs if it does not approve the contents of such offer in this respect, which order shall be effective from the date of issue, unless the Authority specifies another date. Such terms and conditions and tariffs shall be fair, reasonable and nondiscriminatory and the tariffs shall be based on costs or by benchmarking such tariffs against tariffs in comparable Telecommunications markets. The tariffs and terms of the Interconnection offered may differ between a Licensed Operator and another only where objectively justifiable on the basis of the type of Interconnection provided. 14 c) A Public Telecommunications Operator in a Dominant Position shall offer Interconnection with any Licensed Operator on request by the latter on the terms and conditions and the tariffs set out in its most recent reference Interconnection offer announced by the former and shall be obliged to interconnect with the other Licensed Operator on such terms and conditions and tariffs, and shall, within three days of entering into an agreement in this respect, send a copy of such agreement 14 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 to the Authority. d) Publication of the reference Interconnection offer referred to in paragraph (b) of this Article shall be effected by: 1. sending a copy of such offer to the Authority for approval. 2. placing in each office of the Licensed Operator a copy thereof in order for any Person to inspect it free of charge during normal office hours. 3. sending a copy thereof to any Person requesting one. e) A Public Telecommunications Operator in a Dominant Position shall offer upon request Access to its Telecommunications Network on fair and reasonable terms to any Licensed Operator. Such operator shall only be under an obligation to offer Access to the ducts if the Authority considers that there is an essential need for such Access. The Authority may publish regulations with regards to Access, including a regulation concerning the reference Access offer similar to a reference Interconnection offer. If the Authority considers the tariffs and the terms and conditions on which Access is offered by an operator in a Dominant Position are unreasonable, it may determine such tariffs and terms and conditions as it considers appropriate.15 f) A Public Telecommunications Operator that obtains information from another Public Telecommunications Operator during or after negotiations concerning Interconnection or Access procedures shall not use such information for any purpose other than the purpose for which such information is provided, and shall not divulge such information in any way. This restriction also applies to the provision of such information to any other parties or Persons that may derive competitive advantage from such information. g) A Public Telecommunications Operator may refer to the Authority any dispute that arises between it and any other Public Telecommunications Operator with respect to Interconnection or Access, in order for the Authority to resolve such dispute if no agreement in that respect was reached with the other operator within one month of the commencement of negotiations between the parties. h) The Authority may issue regulations containing the procedures for Interconnection and Access requests, the timeframe for response thereto and commencement of negotiations, and may issue a guideline regulation concerning the rules on which it shall rely upon for the resolution of disputes in connection with Interconnection 15 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 and Access. CHAPTER 12 TARIFFS CONTROL ARTICLE 58 TARIFFS FOR TELECOMMUNICATIONS SERVICES a) Licensed Operators with significant market power shall be subject to tariff controls in relation to any Telecommunications services for which the Authority determines that insufficient competition exists. The Authority shall specify in the

---

regulations or in the Licence granted to the operator, the tariff controls and the period during which they shall remain in effect. b) Without prejudice to the provisions of the preceding paragraph, tariffs charged by Licensed Operators for their Telecommunications services shall be fair, equitable and non-discriminatory. 16 The Authority shall have the authority to review and control tariffs, establish the basis for tariff definition and tariff rebalancing plans and take any other steps in this respect in accordance with the provisions of Article 3(c)(14) of this Law. CHAPTER 13 PUBLIC AND PRIVATE PROPERTY ARTICLE 59 USE OF PUBLIC PROPERTY a) A Public Telecommunications Network operator shall have the right to construct any installation or install connections required for the construction, development or maintenance of its network on, under, through or alongside public property if the following conditions are satisfied: 1. that the Authority considers such works necessary. 2. that the conditions of Licence permit such matter. 3. the operator obtains the necessary approvals and permits from the competent authorities are obtained before commencing such works. 4. necessary measures are taken for the protection of public and infrastructure installations existing thereon during the construction, development or maintenance of the Licensee’s network. 5. restoration of public property to the condition in which it was before such work 16 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 was carried out and repair of any destruction or damage to such property. 6. b) compliance with the rules promulgated by virtue of a resolution by the Council of Ministers in connection with the use of public property. The Licensee shall have the right to carry out maintenance of infrastructure or to modify its routes if such conditions are satisfied. ARTICLE 60 PROTECTION OF THE ENVIRONMENT AND HISTORIC AND TOURIST SITES A Public Telecommunications Network operator shall, during the construction, development or maintenance of its telecommunication network, comply with the legal and regulatory provisions relating to the protection of the environment and historic and tourist sites. ARTICLE 61 USE OF PRIVATE PROPERTY a) A Public Telecommunications Network operator shall have the right to construct any installation or install any connections required for the construction, development or maintenance of its network on, under or through private real property after concluding an agreement between the network operator and the owner of such real property or the Person with a right thereto for fair compensation to be paid by such operator to the owner of the real property or the Person with a right thereto. b) If the Public Telecommunications Operator and the owner of the real property or the Person with a right thereto fail to come to an agreement for the construction of the works referred to in the preceding paragraph within a reasonable period of time, the Authority may issue a decision enabling the operator to carry out such works if the following conditions are satisfied: 1. that such works are, at the discretion of the Authority in this respect, necessary for the construction, development or maintenance of the Telecommunications Network. 2. that no other technically and economically reasonable solution exists at the discretion of the Authority. 3. that such works do not, at the discretion of the Authority, preclude ordinary use of the real property by its owner or the Person with a right thereto. 4. that the operator pays to the owner of the real property or the Person with a right thereto such fair compensation as is determined by the Authority. 5. that the operator shall adhere to the conditions and measures prescribed by the Authority for the avoidance or limitation of damages that may be caused to the owner of the real property or a third party. c) If an agreement between the operator and the owner of the real property or the Person with a right thereto cannot be reached with respect to the amount of the compensation, the Authority shall determine a fair compensation to be given to the owner of the real property or the Person with a right thereto. For this purpose, the Authority may seek the assistance of one or more experts. The operator shall in all cases bear the expenses of the Authority and the fees of the experts delegated by the Authority for the determination of the amount of compensation. d) The owner of the real property or the Person with a right thereto may appeal against the decision issued by the Authority in accordance with the provisions of this Article before the High Civil Court within sixty days from the date of notifying said owner or entitled Persons of the decision. ARTICLE 62 EXPROPRIATION a) If the construction or development of a Public Telecommunications Network requires the acquisition of a third party’s real property by the operator of the network, and the owner refuses to sell such property or part thereof at a fair price, the operator shall have the right to request the expropriation of that real property or the part thereof that is necessary – provided that this shall not adversely affect use of the remaining part of the real property – for the construction of the network according to the following procedures: 1. The network operator shall submit an application to the Authority requesting that the necessary legal steps be taken for the expropriation of the real property or part thereof, accompanying his application with the technical grounds that justify such application. 2. If the Board finds that such real property or the relevant part thereof is necessary for the establishment or development of such network and that there is no other technically and economically reasonable solution, it may submit a recommendation to the Minister of Housing and Agriculture to consider the project to construct or develop (as the case may be) the communications network a project for the public benefit and to take

---

the measures for expropriation in accordance with the provisions of the Expropriation of Land for Public Benefit Law. 3. The Minister of Housing and Agriculture shall, after approving the recommendations of the Board, issue a resolution providing for expropriation of the real property or the relevant part thereof for the benefit of the Licensee in accordance with the rules and procedures provided for in the Expropriation of Land for Public Benefit Law. ARTICLE 63 NATURAL OBSTRUCTIONS a) If a tree or other natural object obstructs the construction, development or maintenance of a Public Telecommunications Network and a fair agreement between the owner and the operator of the network for the removal thereof cannot be reached within a reasonable period of time, the operator of the network may refer the matter to the Authority, and the Authority may, after ascertaining that no other reasonable technical and economical solution exists, issue a decision to remove such object at the expense of the Licensee, in return for paying the owner fair compensation to be assessed by the Authority, and for such purpose, the Authority may seek the assistance of one or more experts. The operator shall bear the expenses of the Authority and the fees of the experts delegated by the Authority to assess the compensation. b) The owner or the Person with a right over the property shall have the right to appeal against the decision issued by the Authority in accordance with the provisions of this Article before the High Civil Court within thirty days from the date of notifying it/him of the decision. CHAPTER 14 UNIVERSAL SERVICE ARTICLE 64 UNIVERSAL SERVICE OBLIGATIONS a) The Authority may establish Universal Service obligations to support the provision of Telecommunications services for all Users. Such obligations shall apply to one or more Licensed Operators designated by the Authority as Universal Service provider. b) The Authority may issue regulations in connection with Universal Service, including, the services that it includes and if appropriate regulations to establish a fund to promote Universal Service.17 CHAPTER 15 PROMOTION OF COMPETITION ARTICLE 65 ANTI-COMPETITIVE CONDUCT a) A Licensed Operator shall not do or omit to do anything which has the effect of 17 Replaced by virtue of the First Article of Legislative Decree No. (18) of 2023 in relation to amending some of the provisions of the Telecommunications Law issued by Legislative Decree No. (48) of 2002 materially preventing, restricting or distorting competition in any commercial field concerning the Telecommunications sector in the Kingdom, where such act or omission is done in the course of operating a Telecommunications Network, providing a Telecommunications service or in connection with any such matter. b) c) The act or omission referred to in the preceding paragraph mean the following: 1. abuse by the Licensed Operator, either independently or with others, of a Dominant Position in the market or in a substantial part of it which materially prevents or limits competition in an unfair manner. 2. conclude any agreement, enter into any arrangement or understanding or undertaking any concerted practice with any other Person which materially prevents, restricts or distorts competition in the market. 3. cause anti-competitive changes in the market structure, in particular anticompetitive mergers and acquisitions in the Telecommunications sector. The restrictions provided for in subparagraph (2) of paragraph (b) of this Article shall not apply to any act or omission if it results in improving the provision of any goods or services or promoting technical or economic progress in the Kingdom if the Subscribers and Users have a reasonable share of the resulting benefit, provided that: 1. no restrictions other than those indispensable to attaining such objectives shall be imposed on Subscribers and Users. 2. the act or omission shall not substantially reduce competition in the market for the relevant goods or services. d) The Authority shall, when determining whether an act or omission (whether ongoing or temporary) constitutes anti-competitive conduct, have regard to the provisions of this Law and to the conditions of the Licence of the Telecommunications operator. e) Before issuing a determination in accordance with the provision of the preceding paragraph, the Authority shall notify the Licensed Operator of the following: 1. that it is investigating a possible breach of the provision of this Article. 2. the reasons that made the Authority believe that a breach has occurred or is about to occur, including any facts or legal matters which it thinks relevant. 3. such further information as the Authority may require from the Licensed Operator in order to issue its determination. 4. where appropriate, the steps it considers the Licensed Operator would have to take in order to remedy the alleged breach. 5. giving the Licensed Operator, and any other Person that the Authority considers appropriate to consult, such period as it considers reasonable within which to make written representations in response to the notice. f) The Authority shall then determine whether the act or omission is prohibited pursuant to the provisions of this Article, and shall notify the Licensed Operator and any other Person whom it considers it appropriate of the determination issued by it in this respect and the reasons for issuing such determination. Such determination may include the following: 1. directing the Licensed Operator to do or to refrain from doing such acts as are specified by the Authority in order to remedy, amend or prevent the breach of paragraph (a) of this Article. 2. imposing a fine on the Licensed Operator not exceeding 10% of the annual revenues of such operator. g) Should Batelco violate paragraph (a) of this Article and refrain from remedying such violation within the period of time specified by the Authority, the Authority may issue a resolution to bring forward the dates provided for in Article 39 and Article 40 of this Law, in addition to undertaking any of the said procedures provided for in this Law. h) The Authority may issue regulations in connection with the continuation and regulation of efficient competition in the Telecommunications market, and may

---

issue guideline directions stating therein in detail the conducts that constitute in its opinion anti-competitive conduct in accordance with the provisions of paragraph (a) of this Article. CHAPTER 16 ARBITRATION ARTICLE 66 RESORTING TO ARBITRATION With the exception of the regulations and regulatory decisions issued by the Authority, and the decisions issued in accordance with the provisions of Article 56 of this Law, the Arbitration Panel which shall be formed in accordance with the provision of Article 68 of this Law shall have the power to determine the disputes arising between the Authority and any Licensed Operator. The Licensee shall have the right to resort to arbitration, provided that it shall notify the Authority of its intention within thirty days of the date on which it become aware of the disputed decision, order or measure. The disputed decision, order or action shall remain in effect unless the Arbitration Panel decides to stay the execution of the decision or to nullify it. ARTICLE 67 ARBITRATION RULES AND PROCEDURES Where no particular provision exists in this chapter concerning arbitration, the provisions provided for in Chapter Seven of the Civil and Commercial Procedural Law shall apply and not conflicting with the provisions of this Law. The Appointing Authority may issue a decision with respect to any further procedural rule relating to determining the requests for arbitration, and such decision shall be published in the Official Gazette. ARTICLE 68 FORMATION OF THE ARBITRATION PANEL a) The Arbitration Panel shall consist of three arbitrators, of whom the Authority and the Licensed Operator shall each appoint one arbitrator within fourteen days from the date on which the Licensed Operator notifies the Authority of its intention to refer the dispute to the Arbitration Panel. The appointed arbitrators shall, within fourteen days from the date on which they are notified of the appointment, appoint the third arbitrator to be the Chairman of the Arbitration Panel. The Chairman of the Arbitration Panel shall be proficient and experienced in the field of the dispute referred to the Arbitration Panel. b) If the Authority fails to appoint an arbitrator on its part within the period referred to in the preceding paragraph, or if the two appointed arbitrators fail to agree upon the third arbitrator within the period, the Appointing Authority shall, at the request of the Licensed Operator, make such appointment. If the operator fails to appoint an arbitrator on its part, the application for arbitration shall be deemed null and void. c) The application for referring the dispute to the Arbitration Panel may be submitted by more than one Licensed Operator, provided that the subject matter of the dispute is one and the same. The arbitration applicants shall agree upon choosing one arbitrator in the Arbitration Panel. They may request that such arbitrator be appointed by the Appointing Authority. ARTICLE 69 IMPARTIALITY AND INDEPENDENCE OF THE ARBITRATION PANEL Arbitration Panel members shall be impartial and independent. A selected member shall, prior to the approval of his appointment, disclose to the Appointing Authority any circumstance likely to give rise to any matters or doubts as to the member’s impartiality or independence. ARTICLE 70 PUBLICATION OF THE DECISIONS OF THE ARBITRATION PANEL The Authority shall publish the decisions issued by the Arbitration Panel in such way as it deems appropriate. ARTICLE 71 FINALITY OF THE DECISIONS OF THE ARBITRATION PANEL Decisions issued by the Arbitration Panel are considered final and binding. The original copy of the decision that determines the subject-matter of the dispute shall only be submitted to the Clerks’ Office of the court that has jurisdiction to consider the claim within three days following the issue of such decision. The court clerk shall prepare a summary report on such deposit and a copy thereof shall be served on each of the two parties to the dispute. Any concerned party may file an action to nullify the decision issued by the Arbitration Panel before the court that has jurisdiction to consider the dispute, in the circumstances and in accordance with the procedures provided for in Article 243 of the Civil and Commercial Procedural Law. Unless the court orders otherwise, the filing of a legal action to nullify such decision shall not result in a stay of the execution of the decision. CHAPTER 17 COMPLAINTS AND PENALTIES ARTICLE 72 COMPLAINTS SUBMITTED TO THE AUTHORITY The Authority shall investigate the complaints submitted to it with respect to breach of the provisions of this Law or breach of the regulations or decisions issued for the implementation hereof, and shall issue the appropriate decision with respect thereto within the limits of its duties and powers as provided for in this Law. The Authority may require the complainant to submit a signed written statement to include all the facts and circumstances relating to the complaint. The Authority shall inform the Public Prosecutor’s Office if the Authority becomes, during the consideration of any complaint, suspicious that any of the offences provided for in this Law or in any other law has been committed, in order to take such action as may be necessary. ARTICLE 73 PENALTIES Without prejudice to any stricter penalty provided for in the Law of Penalties or any other law: a) The following shall be punished by a fine not exceeding fifty thousand dinars: 1. a Board member who is proven to be in breach of the provision of Article 7(a) of this Law. 2. the General Director or any staff member of the Authority who is proven to be in breach of the provision of Article 21(a) of this Law. The court may adjudicate that the sums of money acquired by the Board member, the General Director or the staff member, in the case of convicting any of them, be confiscated. b) The General Director or any staff member of the Authority who is proven to be in breach of any of the provisions provided for in Article 22(a) of this Law shall be punished by a fine not exceeding ten thousand dinars.

---

c) Every Person that knowingly employs the General Director or any staff member of the Authority in contravention of the provision of Article 22(b) of this Law shall be punished by a fine not exceeding one hundred thousand dinars. d) The General Director or any staff member of the Authority who is proven to be in breach of the provision of Article 23 of this Law shall be punished by a fine not exceeding twenty five thousand dinars. The court may order confiscation of the sums acquired by the Person convicted for breach of the provision of this Article. e) Every Person who is proven to be in breach of any of the provisions of Articles 24(a) or (c) or Article 37(b) of this Law shall be punished by imprisonment for a period not exceeding six months and/or by a fine not exceeding five hundred thousand dinars. The court may order confiscation of the equipment, tools, connections and everything used in committing the offence. f) Every Person who is proven to be in breach of the provision of Article 24(b) of this Law shall be punished by imprisonment for a period not exceeding three months and/or by a fine not exceeding one hundred thousand dinars. g) Every Person who is proven to be in breach of the provision of Article 43 of this Law shall be punished by a fine not exceeding five hundred thousand dinars. The court shall order the confiscation of the equipment, tools and connections and everything used in committing the offence. h) Every Person who is proven to have violated the provision of Article 49 of this Law shall be punished by a fine not exceeding fifty thousand Dinars. i) Every person who is proven to be in breach of the provision of Article 57(f) or Article 77(c) of this Law shall be punished by a fine not exceeding one hundred thousand dinars. j) The following shall be punished by imprisonment for a period not exceeding three months and/or by a fine not exceeding fifty thousand dinars: 1. every Person that obstructs, modifies or deletes the contents of a message by means of Telecommunications Equipment or Telecommunications Network or instigates another Person to do so. 2. every Person that imports into the Kingdom or trades in or acquires Telecommunications Equipment that are not licensed by the Authority in accordance with the provisions of this Law, and every person who intentionally receives any communications that are not intended for the general public without the written approval of the Authority. The court shall adjudicate to confiscate the equipment, tools and everything used in committing the offence. ARTICLE 74 USE OF FRAUDULENT MEANS Without prejudice to any stricter penalty provided for in the Law of Penalties or any other law, the following shall be punished by a fine not exceeding one hundred thousand dinars: 1. every Person that obtains any service provided by a Licensed Operator, by fraudulent means with intent to avoid payment of any prescribed tariffs for obtaining such service. 2. every Person that acquires, has under his control or provides or offers to provide anything that can be used for obtaining, or for a purpose relating to obtaining, any service provided by a Licensed Operator, with intent to avoid payment of any tariffs prescribed for obtaining such service. 3. every Person that uses or assists in using fraudulent means to obtain a service that is provided by a Licensed Operator with the intention to avoid payment of any tariffs prescribed for obtaining such service. ARTICLE 75 DIVERSION, TAPPING AND DISCLOSURE OF MESSAGES Without prejudice to any stricter penalty provided for in the Law of Penalties or any other law, every Person that uses Telecommunications Equipment or Telecommunications Network shall be punished by a fine not exceeding ten thousand dinars for intending to: 1. send any message in the knowledge that the contents of the message are false, misleading, offensive to public policy or morals, endanger the safety of third parties or prejudice the efficiency of any service. 2. tap into or disclose the secrecy of any conversation or data relating to the contents of any message, its sender or receiver unless such tapping or disclosure is permitted by the Public Prosecutor’s Office or by virtue of an order issued by the court of competent jurisdiction. ARTICLE 76 LIABILITY OF A JURISTIC ENTITY A juristic entity shall be criminally liable if one of the offences provided for in this Law is committed in its name, for its account or by using its equipment or network as a result of an act, material negligence, consent or acquiescence of any board member, director or any other person responsible within that juristic entity or by those acting in such capacity. A juristic entity shall be punished by the fine prescribed for such offence in accordance with the provisions of this Law. Such matter shall not prejudice the criminal liability of natural persons in accordance with the provisions of this Law. CHAPTER 18 INSPECTION AND SUPERVISION PROCEDURES ARTICLE 77 INSPECTION AND SUPERVISION PROCEDURES Without prejudice to the provisions of the Criminal Procedural Law: a) The staff members of the Authority designated by the Board shall have the authority to supervise the implementation of the provisions of this Law, the regulations, decisions and orders issued in implementation of the provisions of this Law, and shall have the right to enter the premises wherein there exists or wherein it is suspected that there exists Telecommunications Equipment, Network or Facilities, or all or a part of the infrastructure used in Telecommunications services to inspect and seize any Telecommunications sets or equipment that are unlicensed, unauthorized or used in an unlicensed activity, or whose use would interfere with or harm the existing Telecommunications systems. In order to achieve this, such staff members shall have the right to: 1. request and examine Licences, permits, books, registers, documents and all papers relating to Telecommunications activity. 2. inspect and examine any Telecommunications Equipment, Telecommunications Facility or any other

---

facilities used in connection with the provision of a Telecommunications service or the establishment, operation or ownership of a Telecommunications Network. 3. examine any information or other documents, in any form whatsoever, related to the provision of Telecommunication services. b) The staff members referred to in the preceding paragraph shall have the right to enter any airplane, ship, boat or any vehicle that lands or docks in the Kingdom, in order to inspect any Radiocommunications Station or Radiocommunications Equipment related to Telecommunications Frequency therein or to examine papers and documents relating thereto. c) No Person shall prevent or hinder any staff member authorised to supervise and inspect from carrying out the duties and powers provided for in this Article. d) If it established from the inspection that any Radiocommunications Equipment interferes without reasonable justification with the proper functioning of, or causes malfunction to other Radiocommunications Equipment, or is in breach of the international treaties to which the Kingdom is a party, the Authority shall notify the Licensee to take preventative measures and procedures within a reasonable period specified by the Authority. e) If the inspection results in a suspicion that any of the crimes provided for in this Law or any other law is committed, the Authority is obliged to inform the Public Prosecutor in order to take such action as may be necessary. f) A resolution of the Minister of Justice and Islamic Affairs in coordination with the Authority shall specify the staff members who are authorised to be Judicial Officers in accordance with the provisions of this Law, regulations and decisions issued in implementation thereof. CHAPTER 19 NATIONAL SECURITY ARTICLE 78 LICENSEES’ OBLIGATIONS CONCERNING NATIONAL SECURITY Every Licensed Operator shall undertake to provide, at its own expense, all technical resources, including Telecommunications Equipment, systems and programs relating to the Telecommunications Network that it is licensed to operate and which allow security organs to have access to the network for fulfilling the requirements of nat ional security, provided that the provision of the service shall continue whilst the required technical resources are provided, giving regard to technical development and in accordance with the provisions of the regulations and decisions issued by the Authority. ARTICLE 79 NATIONAL SAFETY AND MARTIAL LAW It shall be permissible, if a state of national safety or martial law is declared, for the competent Authority to requisition the Telecommunications services and networks of any Licensed Operator as well as the personnel of such operator working in the operation and maintenance of such services and networks, to address the circumstances in respect of which the state of national safety or martial law has been declared. The Licensed Operator shall be entitled to compensation for any damage which it suffers as a result of the exercise of the powers provided for in this Article. CHAPTER 20 TRANSITIONAL PROVISIONS ARTICLE 80 ADAPTATION OF CIRCUMSTANCES a) Every Person that is lawfully providing on the date on which this Law comes into force, any of the services that are subject to the provisions of this Law or is operating a Telecommunications Network or using Radiocommunications frequencies spectrum in the Kingdom at such time shall be deemed a Licensee for a transitional period not exceeding six months from the date on which the provisions of this Law comes into force. b) The Person referred to in the preceding paragraph shall, if it desires to continue carrying out the activity, submit an application to obtain the appropriate Licence within a period not exceeding four months after the date on which this Law comes into force. c) The Authority may, upon the submission of a justified application by the Person referred to in paragraph (a) of this Article, extend the transitional period to more than six months from the date on which this Law comes into force if the Authority considers that the application shows due cause. The Persons referred to in paragraph (a) of this Article may not provide any Telecommunications service, operate any Telecommunications Network or use the Radiocommunications frequency spectrum in the Kingdom after the end of the transitional period without obtaining a Licence therefore in accordance with the provisions of this Law. d) The Authority may amend Licences that are valid on the date on which this Law comes into force to ensure compliance with the provisions of this Law. The provisions provided for in Articles 31 and 34 of this Law shall not apply to such amendment. e) The Authority shall, within a period not exceeding six months after the date on which this Law comes into force, grant to Batelco Licences substantially in the form of the Licences promulgated by a resolution issued by the Council of Ministers within two months from the date on which this Law comes into force, and such resolution shall be published in the Official Gazette. ARTICLE 81 INVALIDATION OF PRIOR POWERS Without prejudice to the provision of Article 80 of this Law, any authorities, rights, privileges, powers, Licences or permits granted to any entity which are inconsistent with the provisions of this Law shall be invalidated. Guidelines issued by the Telecommunications Regulatory Authority on Telecommunications Sector Cybersecurity Controls Date: 5 December 2024 Ref: LAD 1124 068 Purpose: To establish a baseline set of security measures and best practices for the telecommunications industry to protect against cyber and physical threats. These guidelines aim to enhance the overall security posture of the telecommunications sector and ensure the resilience of critical telecommunications infrastructure. By providing a common framework, the guidelines can help organizations in the telecommunications industry implement effective security controls and mitigate cyber and physical risks. INTRODUCTION ..................................................................................................................................................................... 2 ABBREVIATIONS AND TERMINOLOGY .............................................................................................................................. 2 DOMAIN 1 IT SECURITY GOVERNANCE ........................................................................................................................ 3 Subdomain 1.1 Roles and Responsibilities ................................................................................................................ 3 Subdomain 1.2 Cybersecurity Risk Management ....................................................................................................... 4 Subdomain 1.3 Strategies, Policies, and Procedures ................................................................................................. 5 Subdomain 1.4 Asset Management ........................................................................................................................... 6 Subdomain 1.5 Change Management ........................................................................................................................ 7 Subdomain 1.6 Business Continuity Management ..................................................................................................... 7 Subdomain 1.7 Cybersecurity Awareness and Training ............................................................................................. 8 DOMAIN 2 CYBER

---

DEFENSE ........................................................................................................................................ 10 Subdomain 2.1 Identity and Access Management ................................................................................................... 10 Subdomain 2.2 Network Security ............................................................................................................................. 12 Subdomain 2.3 Enterprise Email Protection ............................................................................................................. 13 Subdomain 2.4 Data Security and Encryption .......................................................................................................... 13 Subdomain 2.5 Physical and Environmental Security .............................................................................................. 14 Subdomain 2.6 Social Media Cybersecurity ............................................................................................................. 15 DOMAIN 3 CYBERSECURITY ASSESSMENT, AUDIT, AND THIRD-PARTY CYBER RISK MANAGEMENT ............ 17 Subdomain 3.1 Audit ................................................................................................................................................ 17 Subdomain 3.2 Vulnerability Management ............................................................................................................... 17 Subdomain 3.3 Penetration Testing ......................................................................................................................... 19 Subdomain 3.4 Third Party Services ........................................................................................................................ 20 Subdomain 3.5 Telecoms Products and Vendor Cybersecurity ............................................................................... 21 Subdomain 3.6 Cloud Computing ............................................................................................................................. 22 Subdomain 3.7 Virtualized and Containerized Environments ............................................................................... 23 DOMAIN 4 CYBERSECURITY OPERATIONS AND INCIDENT MANAGEMENT .......................................................... 24 Subdomain 4.1 Incident Detection ............................................................................................................................ 24 Subdomain 4.2 Incident Management ...................................................................................................................... 24 Subdomain 4.3 Threat intelligence and information sharing ..................................................................................... 26 Subdomain 4.4 Testing and Exercises ..................................................................................................................... 27 DOMAIN 5 GENERALLY APPLICABLE TELECOMS SECURITY CONTROLS ............................................................ 28 Subdomain 5.1 Architecture and Design Controls .................................................................................................... 28 Subdomain 5.2 Control Plane Controls .................................................................................................................... 29 Subdomain 5.3 Management Plane Controls ........................................................................................................... 29 Subdomain 5.4 User (Data) Plane Controls ............................................................................................................. 30 Subdomain 5.5 Security Practices ............................................................................................................................ 31 DOMAIN 6 PEERING AND INTERCONNECTION .......................................................................................................... 32 Subdomain 6.1 Internet ............................................................................................................................................ 32 Subdomain 6.2 Voice and Mobility ........................................................................................................................... 33 Subdomain 6.3 Satellite Ground Stations ................................................................................................................. 33 DOMAIN 7 NATIONAL INFRASTRUCTURE AND SERVICES ...................................................................................... 35 Subdomain 7.1 Internet ............................................................................................................................................ 35 Subdomain 7.2 Voice and Mobility ........................................................................................................................... 35 Subdomain 7.3 Domain Name System (DNS) .......................................................................................................... 36 Subdomain 7.4 Messaging ....................................................................................................................................... 37 Subdomain 7.5 Private Wireless .............................................................................................................................. 37 APPENDIX A ........................................................................................................................................................................ 39 GLOSSARY OF ABBREVIATIONS AND ACRONYMS ..................................................................................................................... 39 1 Introduction The telecommunication sector provides important services which allow everyone to communicate locally and internationally. Internet access is possible because of the telecommunication sector. By developing the telecommunication cybersecurity controls, the TRA1 aims at protecting the sector which forms part of the Critical National Infrastructure (CNI) from any cybersecurity threats and attacks. The purpose of these guidelines and the controls within is to provide guidance and recommendations to telecommunication entities to have a robust cybersecurity. The document outlines best practices to be implemented in the following domains: 1. IT Cybersecurity Governance; 2. Cyber Defense; 3. Cybersecurity Assessment, Audit and Third Party Cyber Risk Management; 4. Cybersecurity Operations and Incident Management; 5. Generally Applicable Telecoms Security Controls; 6. Peering and Interconnection; and 7. National Infrastructure and Services. While these Guidelines are currently not binding, they are intended to help telecommunication entities align with industry standards and regulatory expectations. The TRA reserves its right to revisit and amend these Guidelines as necessary to ensure they remain effective and relevant in addressing evolving cybersecurity challenges within the sector. Abbreviations and Terminology Throughout this document many abbreviations are used, as it is intended to be digested by a technical audience. Please see appendix A for a glossary of abbreviations and acronyms. Within this document, we use the term “entities” to refer generally, but not exclusively, to organizations regulated under the Telecommunications Law who fall within the intended scope of this framework. As the framework is intended to help encourage cybersecurity hygiene and resiliency more broadly across the entire telecommunications sector of the Kingdom of Bahrain, these controls may also be beneficial to entities outside the explicit scope of the Telecommunications Law. 1 These controls were developed in cooperation with the National Cyber Security Center 2 Domain 1 IT Security Governance This section of Domains 1 through 4 includes security controls broadly applicable across both a licensee’s enterprise and telecommunications infrastructure. These controls are not necessarily technical in nature, and include a variety of governance, management, and communications activities related to managing cybersecurity risk. This domain aims to ensure that entities define the essential elements for effective governance and oversight of their organizational cyber risk management. These elements include clear definitions of organizational risk thresholds and tolerances, an accountability structure, and clear areas of responsibility. Subdomain 1.1 Roles and Responsibilities This subdomain establishes responsibilities for key strategic decision making relating to cybersecurity, sets a requirement to disseminate information to those who need to know it, and ensures that the plan is regularly reviewed. Defining these responsibilities ensures accountability for key tasks. Control 1.1.1 The Board of Directors is responsible for cybersecurity and must exercise oversight of an entity’s cybersecurity program by ensuring that the entity’s cybersecurity program is appropriately managed and resourced, as well as by endorsing the cybersecurity strategy and policy. Control 1.1.2 The Board must establish or designate a board-level committee responsible for cybersecurity, including:  Monitoring, reviewing, and communicating the entity’s cybersecurity risk appetite periodically or when there is a major change in the risk appetite.  Reviewing the entity’s cybersecurity strategy on at least an annual basis to ensure that it is well aligned with its risk management and broader business objectives.  Approving, supporting, and monitoring cybersecurity strategy, cybersecurity policy, cybersecurity risk management process, the key risk indicators, and key performance indicators for cybersecurity. Control 1.1.3 The entity must designate a senior accountable role for cybersecurity, such as a Chief Information Security Officer. This role must be of sufficient seniority to regularly brief the Board’s cybersecurity committee, and to influence and direct enterprise level investments and change. Control 1.1.4 The entity must establish governance, risk, and compliance functions to formally define, audit, and report on the entity’s cybersecurity and risk management programs. 1.1.4.1 Appropriate confidential escalation paths must be established for the reporting of significant information security risks and issues. 1.1.4.2 Regular internal audits and inspections of organizational compliance with security policies must be conducted, with opportunities for improvements formally 3 catalogued and implementation initiatives tracked and summarized for senior leadership. Control 1.1.5 An entity’s project management methodology must ensure that IT and telecoms infrastructure projects incorporate Secure by Design, Secure by Default, and Privacy by Design principles, and that a security risk assessment is performed before starting any technology related project. 1.1.5.1 The entity must follow a project design process with defined security risk assessment and acceptance stages. 1.1.5.2 The entity must ensure all

---

projects go through a data protection and privacy assessment, aligned to the Guidelines on the Privacy of Individuals and Data Protection in the Telecommunications Sector issued by TRA, the Personal Data Protection Law and requirements of the Personal Data Protection Authority of the Kingdom of Bahrain. 1.1.5.3 Software projects must adhere to principles of the Secure Software Development Lifecycle (SDLC). An entity’s SDLC must include quality control stages, and software testing (static or dynamic) as appropriate. Control 1.1.6 A risk management plan must be implemented by a team specified by the board of directors, using a framework such as the NIST Risk Management Framework, ISO27001 or ISO31000 Series standard. Senior management must approve the plan before implementation and review the plan annually or after a substantial change. Control 1.1.7 All members of an entity’s workforce, including contractors, must be formally advised of and must acknowledge their cybersecurity responsibilities on an annual basis. Control 1.1.8 Key officers or senior managers accountable for cybersecurity activities must be clearly identified and the board of directors must receive, on an at least annual basis, a briefing on the cybersecurity program’s performance, key activities, and intended strategy. Subdomain 1.2 Cybersecurity Risk Management Cybersecurity risk management is the process of identifying, assessing, and reducing risks to an acceptable level. This process is considered the basis for determining the necessary controls to treat cybersecurity risks and establish a contingency plan. Ultimately, to reduce the cybersecurity risks for the information assets, the risks' impact, likelihood, and vulnerability must be accurately identified, assessed, and analyzed. A comprehensive cybersecurity risk management plan must be developed. Control 1.2.1 The entity must develop a comprehensive plan that clarifies the scope and boundaries of the cybersecurity risk management process determining the business areas, people covered in the plan and allocated recourses with consideration of risk appetite. Control 1.2.2 Risk management activities must be overseen by a committee, or any team specified by the Board of Directors, based on the NIST Cybersecurity Framework, ISO27001 or ISO31000 Series standard. 4 Control 1.2.3 The plan must identify the details of the cybersecurity risk management process including risk identification, risk analysis, risk treatment, and risk monitoring along with roles and responsibilities, organizational structure, and charters. Control 1.2.4 Senior management must approve the plan before implementation and review the plan periodically and after a major change is made to the plan. Control 1.2.5 Senior management must ensure implementation and effectiveness of the risk management process and risk treatment plan which includes the board of directors’ review and approval of the cybersecurity risk assessment results. Control 1.2.6 The identified risks must be communicated to relevant risk owners for their endorsement. Risk owners must identify or support the identification of risk treatment decisions. Control 1.2.7 The entity shall maintain the risk register that records risk rating, prioritize risks for treatment and identifies risks that are within the entity’s risk tolerance and reviewed periodically. Control 1.2.8 The entity must monitor and communicate cybersecurity risks as well as review the risk register periodically. Subdomain 1.3 Strategies, Policies, and Procedures This subdomain aims to ensure that all cybersecurity strategies, policies, and procedures are well organized, governed, and documented. The strategies include addressing clearly the cybersecurity goals the entity is willing to achieve. The policies and procedures must be defined, approved, and reviewed at least once every year to ensure achieving the entity’s objectives. Control 1.3.1 The cybersecurity strategy must contain: the importance and benefits of cybersecurity to the entity, the cybersecurity objectives to be achieved, the difficulties that may occur, the cybersecurity initiatives, and projects to achieve the cybersecurity objectives. Control 1.3.2 Entities must have an information security policy, or a suite of policies, governing implementation of the cybersecurity strategy and explicitly defining more granular control objectives and recommended implementation patterns. These policies must be available in written form, formally approved by leaders who have ownership over the cybersecurity strategy and publicized to an entity’s workforce. They must also be reviewed and updated periodically. Control 1.3.3 The Board of Directors, cybersecurity committee, or identified deputies must review the cybersecurity strategy and policy at least once every year. Control 1.3.4 The entity must ensure that its information security policy sets out handling procedures for its workforce which clarify how information at different classification levels must be handled. 5 Subdomain 1.4 Asset Management One of the core subdomains of cybersecurity governance is asset management. Identifying and maintaining the information assets is important to protect the entity’s information infrastructure. Information assets include hardware, software, information systems, information services, virtualization, and information stored on-prem or elsewhere. Control 1.4.1 The entity must define, approve, and implement an asset management process which governs the entire lifecycle of the asset, including its eventual disposal. The process must be monitored and measured on a regular basis. Control 1.4.2 Automated asset discovery tools are highly recommended to be used to identify assets when they are introduced and periodically validated. Control 1.4.3 Assets must be identified, classified, prioritized, and maintained in a centralized asset inventory that is periodically reviewed and updated. Control 1.4.4 All information stored on-premises or elsewhere must be classified based on an entity’s information management policies and the classification must be reviewed periodically. Control 1.4.5 All assets must be labeled with a unique identifier in accordance with their asset classification. Control 1.4.6 Asset details must be recorded such as, but not limited to, asset identifier, asset name or description, asset function, asset classification, asset owner, asset custodian, asset users, physical asset location, license details, and asset severity. Control 1.4.7 Asset maintenance must be recorded, with the date/time conducted, person completing the maintenance, person completing the record, short summary of actions, and any other details the entity deems sufficient for auditing purposes. Control 1.4.8 All assets must be sufficiently protected against loss, theft, unauthorized access, and/or unauthorized disclosure in line with their classification level. Control 1.4.9 Users must only use authorized devices with an endpoint protection solution deployed that comprises anti-virus, anti-malware, Endpoint Detection and Response (EDR), Extended Detect and Response

---

(XDR), device management and control, host firewall, and HIPS or any other solutions recommended or applicable and approved by NCSC. Control 1.4.10 To minimize the risk of confidential information leakage to unauthorized persons, formal procedures for the secure disposal of information and assets must be established, including the proper steps for asset disposal. Control 1.4.11 Systems and devices that are known or suspected to have been exploited, compromised, or over which control has otherwise been lost must be isolated and subsequently evaluated before being returned to operational use. 6 Subdomain 1.5 Change Management Change management involves planning, implementing, and reviewing information system changes to minimize risks and disruptions. The objective of this subdomain is to ensure entities have a consistent and systematic approach to proposing, approving, and documenting changes to security and IT infrastructure. Effective change management helps enhance the resiliency of critical systems and can be essential to diagnosing and resolving unintended system outages and breaches. Control 1.5.1 A change management process must be established to ensure that changes to information assets are planned, evaluated, reviewed, and approved before implementation. Organizational compliance with change management process must be monitored and unauthorized changes to critical systems must be investigated. Control 1.5.2 An entity’s change management process and documentation must consider potential requirements related to controlling changes of and impacts on cybersecurity policies and controls. Control 1.5.3 Where feasible, changes must be tested in a separate environment based on test plans approved by business and IT management. Control 1.5.4 Test results must be reviewed and accepted by authorized personnel before the changes are approved to ensure there is appropriate oversight and review. Control 1.5.5 Tests must not use production data which may contain personal or confidential information. Control 1.5.6 Changes must include a rollback plan to ensure that systems can be restored to full capacity as rapidly as possible in the event of a failed change. Control 1.5.7 Procedures must be defined for assessing, approving, and implementing urgent or emergency changes that need to be implemented without following the standard change management process. These procedures must designate multiple redundant approval personnel so that critical changes can be made even during periods of reduced organizational availability, such as holidays or vacation periods. Control 1.5.8 As soon as possible, emergency changes must be documented and reviewed in accordance with the standard change management process. Emergency changes must also be assessed to ensure that any temporary accesses, bypasses, or circumventions of cybersecurity controls have been reverted. Subdomain 1.6 Business Continuity Management BCM is an act of proactively anticipating and minimizing impacts on mission-critical operations, services, functions, and processes of the entity and ensuring their availability to enhance overall business resilience. BCM also includes efforts to a wide variety of risks. Control 1.6.1 Comprehensive BCM plans must be prepared to cover a wide range of risks and in consideration of the organization’s risk appetites to various lines of business and assets. These plans must describe essential business continuity measures and critical resources. The 7 overall BCM program must be approved and periodically reviewed by the Board of Directors or delegated senior management. Control 1.6.2 The plan must include all steps involved in response to disasters to protect the information assets and restore critical business functions and services. Control 1.6.3 BCM plans must also specify when and how to perform critical and mandatory notifications to insurance brokers, regulators, and other essential third parties in the event of a major disaster. Control 1.6.4 A business impact analysis must be performed to prioritize the protection and ensure the availability of services. The results of business impact analysis must be reviewed regularly or when there is an effective change. Control 1.6.5 Effective crisis communications capabilities must be established to ensure that critical messaging and status updates can be prepared and conveyed to internal team members, customers, citizens, and institutions of the Kingdom of Bahrain. Control 1.6.6 Out-of-band backup communications capabilities must be established so that BCM tasks can be performed even in the event of a significant outage of the conventional enterprise email, voice, or messaging capabilities. Control 1.6.7 The entity must ensure that the required resources to deliver essential services and business functions are adequate to maintain availability in a disaster. Control 1.6.8 A DR plan must be developed and implemented which determines the frequency of data backup including offline backup, the acceptable recovery time, the responsible employees to handle the recovery process steps, RTO and RPO. Control 1.6.9 The plans for business continuity and disaster recovery must be reviewed at least annually or after major organizational or infrastructure changes to identify any weaknesses or gaps. Control 1.6.10 A test plan must be developed to test the plans of business continuity and disaster recovery. The plan must include the test scope and objectives, test scenarios and the details related to the test activities performed. Control 1.6.11 Testing the plans must involve all teams necessary to execute the BCM plan and not be unnecessarily limited to cybersecurity or IT staff. Control 1.6.12 Offline copies of BCM and DR plans must be available at the main site and at the DR site to be reached if an incident prevents access to their primary copies. Subdomain 1.7 Cybersecurity Awareness and Training This subdomain ensures that the workforce of an entity (including contractors and third parties) are provided with the awareness, knowledge, and skills to carry out their organizational responsibilities safely and utilize organizational systems and infrastructure in compliance with the entity’s cybersecurity policies. 8 Control 1.7.1 All users must be informed of and acknowledge their responsibilities for cybersecurity and provided with adequate training on how to use systems and applications in compliance with the organization’s security policies on an annual basis. 1.7.1.1 Completion of the relevant information and training programs must be documented, tracked, and managed organizationally. Supervisors, managers, and leaders must be accountable for their subordinates’ completion of the awareness and training program. 1.7.1.2 Employee cybersecurity training must be integrated with an entity’s onboarding process so that essential training on

---

security policies and responsibilities is delivered on a timely basis as new employees are granted access. Control 1.7.2 Different awareness and training programs must be tailored to various organizational job levels and roles. 1.7.2.1 Privileged users must understand and acknowledge additional cybersecurity requirements related to the use and safeguarding of their privileged accounts. 1.7.2.2 Senior leaders and executives with key cybersecurity roles and responsibilities must understand and acknowledge these. 1.7.2.3 Contractors, suppliers, and other third parties acting as an extension of an entity’s workforce must receive awareness and training on their cybersecurity responsibilities and obligations as part of an entity’s contracting and procurement process. Control 1.7.3 Performance metrics on the organization’s cybersecurity training and awareness program must be annually evaluated and reviewed by senior management and the Board of Directors to ensure that the program is achieving its objectives and improving behaviors. Control 1.7.4 Cybersecurity training and awareness program content must be reviewed at least annually to assess new cybersecurity trends and developments, make necessary updates, and ensure that the material remains engaging and relevant to its audience. Control 1.7.5 Warning banners must appear prior to system login where possible, which specify requirements for accessing the system and penalties for improper use. 9 Domain 2 Cyber Defense The scope of this domain is to address cybersecurity defense processes to ensure they effectively protect an entity’s networks, systems, applications, and IT services. This domain defines and describes many processes in six subdomains: Identity and Access Management, Network Security, Email Protection, Cryptography, Physical and Environmental Security and Social Media Cybersecurity. Subdomain 2.1 Identity and Access Management This subdomain identifies controls to ensure that access to physical and logical assets and related facilities is limited to authorized users, systems, and processes and that these identities are subjected to appropriate verification in relation to the assets being accessed. Control 2.1.1 Identity and Access Management (IAM) policies, including user registration and revoking procedures, and processes must be formally defined, documented, approved, reviewed, and audited on a periodic basis. Control 2.1.2 The approval, provisioning, and use of administrator, superuser, or other privileged accounts must be governed by a policy setting out additional appropriate security controls such as MFA and PIM and designating personnel who will approve, periodically revalidate, and be accountable for requests for such accounts. 2.1.2.1 Where feasible, administrative, or privileged system activities must be conducted only from dedicated management devices which are built from known and trusted operating system images, rather than OEM or ad hoc operating system images. 2.1.2.2 The entity must manage and control privileged access to information systems, using solutions such as a Privileged Identity Management (PIM) or a Privileged Access Management (PAM) system. 2.1.2.3 Local, off-domain administrator or privileged accounts must be present only where strictly necessary and otherwise unavoidable. 2.1.2.4 For high priority systems, where third parties are making changes with high privilege accounts, explicit approval must be provided through the use of process or technologies such as split passwords. 2.1.2.5 Privileged accounts must not be used to perform regular user activities such as reading emails, viewing attachments, or web browsing. Control 2.1.3 Default operating system and application accounts must be disabled, renamed, and have their credentials changed where possible. Control 2.1.4 Users must not share their account information and must not share accounts with other users. Control 2.1.5 Access to networks, systems, and applications by systems and employees must be: 10  Requested, reviewed, approved, implemented, and verified in accordance with business needs and cybersecurity requirements.  Reviewed by the owners or administrators of networks, systems, and applications and access must only be granted after having appropriate approval.  Maintained to help the entity in identifying and recording all access rights granted to the networks, systems, and applications. Control 2.1.6 Service, system, or other automated agent accounts must be requested, authorized, and periodically reviewed. Privileges of these accounts must not exceed those of the requestor or accountable account owner. 2.1.6.1 Where possible, API keys and authentication tokens must be stored in a secrets vault, rotated periodically, and scoped to authorized origin IP addresses or networks. 2.1.6.2 The activities and use of API keys and authentication tokens must be logged and audited. 2.1.6.3 Secrets must not be stored in clear text within public or shared code repositories. Control 2.1.7 The access to networks, systems, and applications must be restricted and granted based on identity and access control principles, including the following:  Need-to-Know Principle: granting access to users whose job duties, roles, and responsibilities involve the need to access and use data or information in accordance with the Need-to-Know principle. Otherwise, the request must be rejected, and access must not be granted.  Least Privilege Principle: assigning a user, system, or process with the least privileges needed to do the necessary activities/actions based on the user’s role and duties.  Segregation of Duties Principle: The entity must consider the conflicting roles (for example, Requestor and approver roles or checker and maker roles) and shall segregate them to ensure that no individual has access to control all phases of an operation/process. Control 2.1.8 MFA must be an entity’s default authentication standard and enabled wherever possible. 2.1.8.1 The use of SMS as an authentication factor must be avoided if possible. Control 2.1.9 An entity’s security policies must set out requirements for the provisioning, use, and management of passwords. 2.1.9.1 Passwords/passphrases that are set or reset on users’ behalf must be randomly generated and must be changed after first access by the user. 2.1.9.2 Server-side passwords and credentials stored in system databases must be hashed and salted where possible, using OWASP best practices as a guideline. 11 2.1.9.3 Passwords/passphrases must be changed when they are directly compromised or suspected of being compromised, found in databases of an online stored data breach, or found to be stored in the clear on a network or transferred in the clear across a network. Control 2.1.10 Accounts must be disabled after a specified threshold of failed login attempts. Control 2.1.11 Authentication via insecure or vulnerable protocols,

---

including outdated or obsolete encryption parameters, must be blocked or disabled. Control 2.1.12 Employee separations from an entity must be documented, and related user accounts must be disabled or deleted once a separation has taken effect. Subdomain 2.2 Network Security The objective of cybersecurity in the communication subdomain is to assure network protection against all threats and risks. Control 2.2.1 An entity’s networks must conform with a formally documented network security architecture that specifies the intended use, operating parameters and security requirements of networks and network segments. Control 2.2.2 Vulnerable or end-of-life systems that cannot be patched, replaced, or decommissioned must be isolated within a network enclave that has the minimum inbound and outbound access required to maintain the required system functions and whose traffic is monitored. Control 2.2.3 Sensitive details and documentation about an entity’s security controls and network configuration, such as system names, network topology, network device types, or account names must not be publicly accessible. Control 2.2.4 Ingress and egress traffic from the entity to other networks and vice-versa must pass through appropriate security and inspection capabilities, such as firewall, IPS, IDS, WAF, or proxy. Control 2.2.5 The entity’s network must be scanned regularly to monitor and identify significant network changes such as new IP addresses, new network ports, new reachable subnets. Control 2.2.6 The configurations of network security devices and information systems used by the entity must be backed-up periodically. Control 2.2.7 The network security systems and solutions must be upgraded with the necessary modules to assure optimal firewall performance. The firewall administrator must be aware of any hardware and software bugs, as well as firewall software upgrades that are issued by the vendor. Control 2.2.8 Any remote access to the entity’s network must use secure connections such as a VPN. 12 Control 2.2.9 Entities must move towards zero-trust architectures in existing corporate networks such as IT, Finance, HR, Legal, etc., except the service-provider platform that is used to serve the end user. Control 2.2.10 Where possible and applicable, the use of SD-WAN and SD-LAN technologies must be used to:  Enable intent-based networking, and policy-based automation.  Provide end-to-end secure segmentation of users, device, and applications.  Cover both wired and wireless enterprise networks.  Have the capability to deploy access control and ensure continuous compliance by monitoring it actively. Subdomain 2.3 Enterprise Email Protection This subdomain ensures that proper controls are in place to minimize the risks associated with email services, servers, and applications. Control 2.3.1 Secure Email Gateway (SEG) functionality must be used to protect the entity from email attacks. This may be implemented in different ways, such as an on-premises appliance or a cloud-based service. Control 2.3.2 All emails must be automatically scanned for phishing and spam. The findings and infections must be blocked or quarantined depending on the severity level. The email server administrator has the right to reject any recovery of Infected/Quarantined emails that might compromise the system or network. The source of suspicious emails must be blacklisted. Control 2.3.3 All files including compressed files sent as attachments in the incoming and outgoing mail (SMTP traffic) must be scanned, any detected malware must be cleaned automatically, and the infected file must be deleted otherwise the email/file must be quarantined. Control 2.3.4 Email messages must be protected using email filtering solutions and authenticated by enforcing Domain-based Message Authentication, Reporting, and Conformance (DMARC), Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) on inbound and outbound emails. Subdomain 2.4 Data Security and Encryption This subdomain sets out controls to prevent unauthorized access, use, modification, or destruction of data. Data security and encryption help to safeguard personal information, sensitive business data, and intellectual property from cyber threats. Effective encryption is also a critical dependency for IAM. Control 2.4.1 An entity’s security policies must specify encryption requirements for different categories of data and information, both while in transit and at rest. These encryption 13 requirements must consider the confidentiality or sensitivity of the data being transmitted, relevant threat models for the system and data being protected, as well as applicable network or IAM context. Control 2.4.2 Encryption key management must be consistent with best practices. Control 2.4.3 Where possible, key material must be managed using a HSM independently certified to standards such as ISO-19790, FIPS, Common Criteria, or PCI-HSM. Control 2.4.4 Encryption must be based on 3GPP, ISO or NIST-recommended algorithms. Control 2.4.5 Encryption schemes using Null methods/ciphers must not be used, unless explicitly required (for example, un-authenticated emergency calls in mobility). Control 2.4.6 In cloud environments, entities must understand where encryption is being provided by a cloud provider and where it is customer-provided. Where feasible, customer- managed keys must be used. Subdomain 2.5 Physical and Environmental Security The purpose of this subdomain is to ensure the physical protection of assets, including networks, systems, and applications from unauthorized physical access, loss, theft, and damage, and to reduce the risks of a physical attack being used to disable other security controls or facilitate a logical attack. Control 2.5.1 Systems and devices must be physically secure from environmental threats. Adequate measures and procedures must be implemented to address and respond to environmental threats including fire, floods, earthquakes, and others. Control 2.5.2 Network infrastructure and security devices must be physically located in access-controlled and environmentally protected facilities to prevent unauthorized physical access, damage, and interference. 2.5.2.1 Physical access controls to a data center must be consistent with and not more permissive than the logical access controls granted to the infrastructure within that data center. 2.5.2.2 Equipment, such as Wi-Fi access points, which must be located outside of a secure room must be tamper resistant, and physical intrusion must trigger an alert to a monitoring system. Control 2.5.3 Facilities and equipment installed in physical locations not owned by the entity must be secured in an entity-controlled enclosure or room, monitored, and alarmed in real- time, with a secure management and/or signaling channel. Control 2.5.4 Environmental controls, including fire, flood, gas and heating, ventilation, and air conditioning (HVAC) systems

---

must be interlinked with monitoring capabilities. 14 Control 2.5.5 Information assets must be monitored remotely and regularly including using video surveillance to monitor access to critical data centers. This data must be retained for no less than 30 days. Control 2.5.6 Access to facilities such as data center/server rooms or areas where sensitive information is kept must be restricted using an access control system with multi-factor authentication to prevent any unauthorized physical access. Data center access lists must be logged, reviewed, and maintained daily. Control 2.5.7 The records of the entrance and exit management systems must be protected. The keys to doors, cabinets, and containers in the data center must be kept safe. Control 2.5.8 No equipment/media shall be taken off-premises without prior documented authorization, stored in an easily retrievable location such as the asset register. Subdomain 2.6 Social Media Cybersecurity Social media applications can create several cybersecurity risks to entities when used in an inappropriate or unsafe manner. Due to their popularity, social media applications are a common way for an adversary to gather information on entities and their employees. When sensitive information is posted to social media, it has the potential to harm the public and the entities' interests. Therefore, entities are required to follow the controls in this subdomain to protect their social media accounts. Control 2.6.1 The authorized individuals and uses of the entity’s social media accounts must be communicated to its workforce. Control 2.6.2 Only authorized employees must have access to the entity’s social media accounts and must be provided with training on their secure use, including management of credentials and authentication factors. Control 2.6.3 Entities should specify which devices, for example corporate or personal devices, authorized employees may use to access official social media accounts. Control 2.6.4 An entity’s social media accounts must not be configured to automatically sign in. Control 2.6.5 Employees managing the entity’s social media accounts must not share access credentials with anyone except with prior approval of senior management. Control 2.6.6 MFA must be implemented for access to the entity’s social media accounts with a complex password/passphrase where possible. Control 2.6.7 Employees managing social media accounts must use their official work email address to log in to the social media accounts. Control 2.6.8 If asked to set up security questions to recover social media accounts, the employee must not provide answers that could be easily obtained from public sources of information. The answers to the security questions must be securely stored with the account credentials and accessible by other authorized personnel such as a manager. 15 Control 2.6.9 Employees managing social media accounts must not post sensitive information. Control 2.6.10 Access to an entity’s social media accounts must be revoked immediately when there is no longer a requirement for access. Control 2.6.11 An entity’s social media account credentials must be reset upon personal re- positioning, transfer, or termination. Control 2.6.12 Procedures must be created for managing the social media accounts. The procedure must include managing multi-users for a single account and specifying the roles for writing and approving the posts. 16 Domain 3 Cybersecurity Assessment, Audit, and Third-Party Cyber Risk Management Cybersecurity Assessment is a process that enables the discovery of cybersecurity weaknesses in a system. This is essential as the attackers usually exploit a weakness in a system to perform an attack and breach the entity’s system. This domain guides entities in performing vulnerability assessment and penetration testing. Dealing with a third-party brings many threats and risks to the entity especially when third- party is allowed to access the networks, applications, and systems of the entity. To protect the entity from third-party misconduct, this domain includes cybersecurity controls starting from selecting a third party until the termination of the third-party contract. Subdomain 3.1 Audit Cybersecurity audits help ensure the performance of cybersecurity controls and an entity’s overall cybersecurity strategy by continually reviewing the implementation of these controls, noting improvement opportunities, and ensuring that these opportunities are acted on. Audits help demonstrate compliance with established policies, operational procedures, and relevant standard, legal, and technical requirements. Control 3.1.1 An entity must have a formalized security audit program which systematically and continually reviews organizational activities for compliance with established policies, contractual requirements, regulations, or legislation. Control 3.1.2 Audit plans must be established at least annually outlining specific auditing engagements to be carried out over a review period. This plan must be reviewed and approved by the Board of Directors. Control 3.1.3 Individual audits must have a clear scope, be carried out by auditors who will be able to conduct an impartial and objective review and evaluation and be formally documented in a report with itemized findings, improvement opportunities, and an agreed upon implementation date. Control 3.1.4 Summarized major findings and the status of improvement opportunities must be briefed to the Board of Directors. Control 3.1.5 Follow-up audits must be performed to validate that findings have been addressed and committed implementation actions have been carried out. Control 3.1.6 Entities must perform audits of their partners and third-party suppliers to ensure adherence to contract security clauses. Subdomain 3.2 Vulnerability Management A vulnerability is a weakness or flaw in a hardware or software system’s design that can be exploited by a threat actor to gain unauthorized access to networks, systems, and applications and conduct malicious activities. These vulnerabilities can be mitigated in various ways, including applying relevant patches, replacing vulnerable products, or isolating vulnerable 17 systems. This subdomain includes controls to manage this attack surface by effectively identifying and mitigating vulnerabilities. Control 3.2.1 Vulnerability assessments must be conducted on a regular basis to measure and maintain internal and external baselines of its aggregate exposure to vulnerabilities. Control 3.2.2 An entity must systematically and on a regular basis measure its exposure to vulnerabilities. This may be accomplished with a variety of automated tools such as vulnerability scanners and attack surface management solutions. These tools may be configured with appropriate credentials to gain access to infrastructure elements to be scanned. Control 3.2.3 Vulnerability assessments must conform to

---

an entity’s change control and change management procedures. They must be planned carefully, with an evaluation of potential adverse impacts on the infrastructure being tested and preparation of any necessary contingency measures. Control 3.2.4 Where applications or infrastructure are delivered using continuous integration/continuous development (CI/CD) pipelines, vulnerability assessments must be integrated into the pipeline so that the vulnerability exposure level of incremental builds is continuously and systematically evaluated and measured over time. Control 3.2.5 The vulnerability exposure level of software or firmware components and dependencies must be continuously evaluated. This may be accomplished with a variety of application security testing approaches, including static application software testing (SAST), dynamic application software testing (DAST), and software composition analysis (SCA). Control 3.2.6 Detected vulnerabilities must be addressed, and corrective action must be performed based on vulnerability classifications and priorities. Control 3.2.7 An entity’s information security policy or policies must set out patch management requirements and guidelines for both scheduled and unscheduled patches or hotfixes. This must include evaluation guidelines and approval personnel for the deployment of emergency patches or hotfixes in the event of a major cyber incident or a zero-day vulnerability. Control 3.2.8 An entity must have the ability to test and stage patches, hotfixes, and ruleset or signature updates. Ideally, for a given set of users or type of infrastructure, an entity will have identified a subset of elements which can be used to test these elements before deploying them more broadly. Conversely, an entity must also understand where important infrastructure should receive these updates only after they have been tested elsewhere. A variety of mechanisms may be used to effect staged deployments across these subsets, and a soak testing approach may be employed to better evaluate the impacts of hotfixes and patches. Control 3.2.9 A software register, including versions, integrity signatures, and patch status of devices, applications, drivers, operating systems, and firmware for workstations, servers, mobile devices, and network devices must be maintained and regularly audited. 18 Subdomain 3.3 Penetration Testing Penetration tests are exercises where a variety of exploitation techniques are employed against people, systems, and infrastructure to evaluate the effectiveness of an organization’s cybersecurity controls, operations, and strategy and identify weaknesses that can be rectified before a real-world attacker discovers them. This subdomain sets out controls to use penetration testing to perform this evaluation and continuous improvement. Control 3.3.1 Penetration tests must be conducted on a regular basis at appropriate intervals. A proportion of these tests must be by independent third parties to ensure that the tests reflect an objective evaluation. 3.3.1.1 Internally sourced penetration tests must be executed by resources who can reasonably be expected to perform independently. Testing personnel must generally be independent from the teams that built and maintain the infrastructure being tested or which are themselves within the test scope. 3.3.1.2 Externally sourced tests must be provided by a variety of independent third parties. Third parties performing a given test must be rotated at least every two years. Control 3.3.2 Penetration tests must be authorized and approved by an entity’s senior leadership as part of its annual cybersecurity strategy, and summarized findings must be briefed to the Board of Directors. 3.3.2.1 Each test must be formally documented and state the test’s scope, identifying elements to be tested and any constraints on the test, such as acceptable techniques, tools, or other elements of the test. 3.3.2.2 This scope must also clarify how any production data exposed or retrieved during the test will be handled and protected in accordance with the entity’s data management policies. 3.3.2.3 After a test is complete, its findings must be formally documented in a report and a full recounting of the test execution and results must be provided. This report must also clarify the disposition of any data exposed or retrieved during the test. Control 3.3.3 An entity must ensure the integrity of its penetration tests and the validity of their findings through the following measures:  Providing testers with as much discretion as possible to employ any tools, techniques, and procedures that a real-world attacker would likely use.  Refraining from alerting monitoring or incident response teams ahead of time if their responses are part of the test scope.  Not adjusting cybersecurity controls or their configurations in advance of the tests.  If the test is not being conducted in the production environment, ensuring the test environment is as close an approximation of the production environment as possible.  Ensuring that the penetration testers have the necessary knowledge, experience, qualifications, and certifications to perform the test. 19 Control 3.3.4 A document authorizing the test and identifying the entity who has approved it on behalf of the entity must be provided to the testers. Control 3.3.5 The entity must identify, prioritize, and address the findings of the test. Subdomain 3.4 Third Party Services Third parties include, but are not limited to, external suppliers of products and services to an entity, both of which can introduce a variety of cyber risks to an organization. The objective of this subdomain is to establish controls to govern the security obligations of third parties, including restricting unauthorized activities and enforcing compliance with an entity’s cybersecurity policies. Control 3.4.1 An entity’s cybersecurity policy must set out minimum security requirements for third-party service agreements, particularly those where access to the entity’s systems or data may be required. Before a contract or service agreement is finalized, an entity must perform a risk assessment to analyze and identify potential cybersecurity risks associated with the service. Control 3.4.2 An entity’s contracts with third parties must consider the confidentiality, integrity, and availability of its infrastructure and data, and must be consistent in all respects with the entity’s cybersecurity policies, procedures, and standards. Contracts must specify appropriate liability and recourse for compliance failures. 3.4.2.1 The use of standardized security contract clauses is recommended to reduce ambiguity and provide a central mechanism for revising and updating cybersecurity contractual language as required. Where appropriate, contracts may refer to an externally available code of

---

conduct for suppliers rather than integrating the language itself. 3.4.2.2 If the products and services provided by the third party require cyber insurance or other coverage, this must be set out in a contract between the entity and the third party. The third party must also undertake in the contract to maintain any cybersecurity controls or other requirements stipulated by these insurance policies. 3.4.2.3 An entity’s contract with a third party must identify clear points of contact on both sides for cyber incident notifications. Where feasible, these points of contact must be group or role addresses rather than individuals to ensure that such notifications can be made even if personnel on either side have changed roles. Control 3.4.3 Third party access, particularly to privileged accounts or critical systems, must be monitored, logged, and audited to ensure that it is consistent with the business purposes of its service agreement or contract with an entity. Control 3.4.4 Entities must provide a proxy or jump-point system for third-party remote access to the entity’s systems and data. 3.4.4.1 Where a third-party must directly access the entity’s networks and data without a proxy or jump-point, an entity-provided device that is actively managed to enforce security controls and policies must be used. 20 Control 3.4.5 The entity must approve all subcontractors to the contract. The roles and responsibilities of both the lead and subcontracted suppliers shall be documented, as applicable, and the security obligations of the prime contractors must also be contractually applied to these subcontractors. Control 3.4.6 Outsourcing contracts shall include the Service Level Agreement (SLA) to be provided, the level of availability in the event of a disaster and after termination the customer data must be retrieved. Control 3.4.7 The entity must ensure that the outsourcing service provider encrypts the customers’ confidential information and stores it separately from other client data. Control 3.4.8 Third party contracts must include the following security clauses:  Mandatory breach reporting where the breach is relevant to the entity or directly impacts entity data/services/products.  Security requirements that align the third-party with the entity’s own security policies, to ensure consistency in security posture and achieve entity objectives (for example, vulnerability remediation times for vulnerability severity, and incident response procedure).  The entity’s right to audit the third-party for adherence to contract security clauses. Subdomain 3.5 Telecoms Products and Vendor Cybersecurity This subdomain sets out controls to ensure that a wide range of telecoms and IT products used by an entity directly or resold to customers adhere to core product security principles. In general, these controls aim to ensure that entities perform security due diligence on such products to ensure that they adhere to Secure by Design / Secure by Default design principles, and that the product developer or vendor accepts and upholds security responsibilities over its entire lifecycle. Control 3.5.1 Entities must ensure, at the start of a new contract, that vendors demonstrate the presence of a secure SDLC (integrity of the process, presence of security embedded in developing product, and so forth) for products that they develop and provide and must periodically review this security at appropriate periods during the life of the contract. Control 3.5.2 Entities must ensure that vendors provide a Software Bill of Materials (SBOM) for products they provide. Control 3.5.3 Entities must require vendors to demonstrate that the products they provide have undergone successful security testing (for example, Common Criteria, ISO certification, GSMA NESAS, internal penetration testing, and vulnerability scanning). Control 3.5.4 Entities must require vendors to provide software integrity checking mechanisms for the software they provide. Control 3.5.5 Entities must require vendors to explicitly define the supported lifecycle of a product and verify that it has a product security incident response team (PSIRT) to investigate 21 and mitigate direct or third-party security vulnerabilities that may impact the product over this entire lifecycle. 3.5.5.1 The entity must require that the vendor patch all in-support products on a timeline aligned with the severity of security vulnerabilities as well as the entity’s own internal timelines for patch management. If patching is not possible, a workaround must be implemented such that the vulnerability is not exploitable. Control 3.5.6 Entities must ensure that no products supplied by a vendor have unsupported components (third-party or otherwise). Control 3.5.7 Entities must not use any equipment that is end-of-life or unsupported for security updates and patches. Where temporary exclusions to this control are required, appropriate compensating controls should be implemented, and the exclusion should be tracked and reviewed periodically. Subdomain 3.6 Cloud Computing The main objective of this subdomain is to ensure that an entity’s cloud infrastructure is protected by cybersecurity controls that are consistent with its overall cybersecurity strategy and any on-premises controls that may be in place. Control 3.6.1 An entity must ensure that outsourced cloud services provide an SLA which permits effective execution of the entity’s cyber incident response plan and is consistent with its cybersecurity policies. This may include details such as: encryption standards, vulnerability or breach notifications, access to a cloud service provider’s cyber incident response team (CIRT), access to digital forensic captures, or access to relevant alert, event, or log data. Control 3.6.2 Similarly, an entity’s business continuity management (BCM) capabilities in cloud infrastructure must be generally consistent with its capabilities for on-premises infrastructure. Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO) for cloud infrastructure must be generally consistent with those for on-premises infrastructure. Control 3.6.3 An entity must ensure that its outsourced cloud service providers are not unilaterally authorized to release the entity’s data or information, including details pertaining to a breach of this information. In situations where that provider is compelled by a legal authority to release the entity’s information, the entity must be informed as soon as possible. Control 3.6.4 Infrastructure and change management practices for cloud infrastructure must be generally consistent with those established for on-premises infrastructure. Assets in cloud computing must be identified, and an inventory of all assets must be created and maintained. The entity must maintain logical,

---

conceptual, and network connection diagrams for the entity’s account. Virtual network infrastructure must adhere to a documented network architecture with appropriate zoning, segmentation, and segregation. Control 3.6.5 The entity must ensure MFA is implemented for all types of access where possible, and specifically mandate MFA for access to privileged cloud accounts. Control 3.6.6 Backups must be taken for services in cloud computing including taking offline and offsite backup for critical servers and storage where possible. Cloud-based backups need to be appropriately separated from production resources such that a compromise of security 22 measures in production will not automatically lead to compromise of the backup (for example, different credentials and access methods). Control 3.6.7 Vulnerability assessment, penetration testing, and risk assessment activities for cloud services must be performed at the same frequency as internally hosted services. Subdomain 3.7 Virtualized and Containerized Environments This subdomain addresses security controls relevant to virtualized or containerized environments, especially where part of a Network Functions Virtualization (NFV) environment. Control 3.7.1 An entity must ensure that only approved, known, and secure container images or code can be deployed. Control 3.7.2 An entity must deploy appropriate role-based access controls and strong authentication for all container and repository management systems. Control 3.7.3 Security isolation capabilities must be deployed to ensure sensitive or critical containers or workloads are appropriately protected from less sensitive and publicly exposed infrastructure. Control 3.7.4 Hypervisors and other virtualization fabric elements must be monitored for malicious or anomalous activity and must be appropriately segregated from the virtualized functions they support. Control 3.7.5 Virtualized hosts and containerized environments must also be monitored and must be deployed with sufficient redundancy and isolation to minimize the impact of the exploitation of a specific host. Control 3.7.6 Entities must ensure that containers are not running as root by default. Control 3.7.7 The root or admin user must not be used within virtual machines or containers, except during initialization. Control 3.7.8 Entities must make use of read-only containers, file systems, and minimal virtualization images to reduce risk of hypervisor escape. Control 3.7.9 Remote-management services (for example, SSH, and RDP) must be disabled within VMs and containers unless required. If required, public access to these services should be disabled or managed via dedicated jump-servers (for example, proxies, and SSH relays) with multi-factor authentication. Control 3.7.10 Different containers and VMs must not run on the same node unless they have the same data classification, sensitivity, and network exposure (for example, internet facing). Control 3.7.11 VMs and containers must be based on secure, verified 'golden images' that are rebuilt on a regular schedule to ensure that they are kept up to date with security patches. Control 3.7.12 Periodic and final state relevant snapshots (for example, VM snapshots, or memory dumps) of running VMs and Containers must be captured and kept for a period of time consistent with forensic evidence retention policy, to facilitate incident investigation. 23 Domain 4 Cybersecurity Operations and Incident Management Cybersecurity-related incidents may occur even when cybersecurity controls are implemented. However, the cybersecurity controls mentioned in this domain are critical to minimizing the impact of current and future incidents. Subdomain 4.1 Incident Detection The purpose of this subdomain is to ensure necessary controls are in place to activate, protect and maintain the cybersecurity event logs within networks, systems, and applications. In addition, this subdomain ensures that monitoring is conducted to required events within the networks, systems, and applications to identify any suspicious behavior which may lead to cybersecurity incidents. Control 4.1.1 An entity must collect, manage, correlate, and analyze alerts, logs, and events from all systems to enable early warning, detection, and response to cyber incidents. This must include the characterization and detection of suspicious or anomalous activities in addition to confirmed malicious activities. 4.1.1.1 A variety of technologies and systems may be employed in this context, such as SIEM, UEBA, XDR, and SOAR. 4.1.1.2 Alerts, logs, and events from user activities, system and network and physical environments must be monitored. This monitoring must include a measurement of normal operating baselines to enable effective detection of anomalous or suspicious activities. Control 4.1.2 Alert, log, and event sources and repositories must be protected from and monitored for unauthorized access, modification, and deletion. Control 4.1.3 System time for all information processing systems must be synchronized regularly. Alerts, logs, and events must clearly indicate the time zone in which they were created. Control 4.1.4 Alerts, logs, and events must be backed up and a sufficient history maintained to enable cyber incident response, investigations, and threat hunting. Subdomain 4.2 Incident Management This subdomain sets out appropriate controls for ensuring that an entity maintains a robust organizational capacity to respond to a cybersecurity incident quickly and effectively. This response capability must not only be able to effectively address the immediate cyber threat under a wide variety of adverse circumstances but must also anticipate a wide variety of post- incident measures that are likely to be necessary. Control 4.2.1 An entity must maintain a cyber incident response plan which sets out procedures for all aspects of managing and responding to a cyber incident. This plan must be formally endorsed by senior leadership and the Board of Directors. 24 4.2.1.1 The cyber incident response plan must identify a cyber incident response team (CIRT) that is responsible for assessing and responding to cyber incidents. In large or complex organizations where this function may be fulfilled by multiple teams, the division of responsibilities must be made clear. 4.2.1.2 The cyber incident response plan must designate an appropriate cyber incident reporting mechanism, available internally and externally, that is monitored and broadly available for the reporting and triage of potential cyber incidents. 4.2.1.3 The cyber incident response plan must designate roles and individuals who are authorized to make critical decisions in the event of a cyber incident, such as authorizing negotiations with a threat actor or shutting down potentially impacted systems or services. The plan must also include a list of alternates and procedures for emergency authorizations when primary or alternate designates

---

are unavailable. 4.2.1.4 The cyber incident response plan must set out clear thresholds for notifying an entity’s senior leadership, Board of Directors, and/or public authorities. The plan must make clear who is authorized to conduct such a notification and by what means it must be made. 4.2.1.5 The cyber incident response plan must also consider when contractually obligated notifications to third parties, such as customers, insurers, or other entities must be made. Entities must have a mechanism to identify relevant third-party contracts and fulfil any obligations regarding cyber incident notifications. 4.2.1.6 The cyber incident response plan must set out clear procedures for documenting all decisions and actions taken during a potential or actual cyber incident. This documentation must include critical metrics on the entity’s performance during the incident response that will allow for measurement and continuous improvement of the response capability. 4.2.1.7 The cyber incident response plan must also require an after-action review after cyber incidents, in order to objectively evaluate how the incident response was executed and to identify improvement opportunities. The plan must identify how this review will be conducted and how lessons learned will be captured and acted on. Control 4.2.2 An entity must have an out-of-band communications mechanism for the CIRT and other critical participants in a cyber incident response to use for coordination if primary systems are unavailable or are potentially compromised. 4.2.2.1 This out of band communications mechanism must be separate from the primary organizational domain or IAM system, contain a separate copy of critical contact information, and must be tested regularly to ensure that the list of members and their access credentials are kept current. 4.2.2.2 Examples of suitable out-of-band communications mechanisms include a separate Microsoft 365 or Google Workspace instance. A combination of other collaboration capabilities, such as a telephone bridge, may also be suitable. Control 4.2.3 An entity must provide training to the CIRT to ensure that it maintains essential incident response and recovery capabilities as personnel and technology continually evolves, 25 is aware of the current cyber threat landscape, and that continually shares and reviews lessons learned and best practices. 4.2.3.1 The CIRT must have the authority, access, and abilities, even if outsourced, to rapidly isolate, contain, and recover from a cyber incident while preserving and capturing necessary digital forensics. This may require direct access to endpoint, network, cloud, or other infrastructure environments or their related operations teams. Control 4.2.4 An entity must ensure that its entire workforce, including contractors and third parties, is advised of their cybersecurity responsibilities in the event of an incident. 4.2.4.1 In particular, an entity’s workforce must be reminded never to directly engage or communicate with a threat actor and that such interactions will be carried out by individuals authorized by the incident response plan. 4.2.4.2 An entity’s workforce must also be reminded to follow the directions of the CIRT in the event of a cyber incident, particularly regarding any instructions to disconnect and leave impacted systems running so that forensic evidence can be preserved. Control 4.2.5 Evidence related to cybersecurity incidents must be collected and protected from any loss or tampering before the containment process. Evidence must be retained and only disposed of after consultations with an entity’s legal department. Control 4.2.6 A centralized cybersecurity incident repository must be maintained by the entity and reviewed periodically. Subdomain 4.3 Threat intelligence and information sharing Cyber threat intelligence is information about current and emerging cyber threats, in the form of both indicators of compromise (IOCs) and information on the tools, techniques, and procedures (TTPs) of a given cyber threat adversary. This subdomain sets out controls to help entities take proactive measures to prepare for and respond to the relevant cyber threats which may be targeting a geographic region or market vertical. Control 4.3.1 Entities must participate in industry-wide information sharing forums to ensure rapid communication, problem resolution, mutual aid, education, and best practices development. Existing international forums include NANOG and the GSMA Fraud and Security Group. National forums may also exist for more focused sharing. Within these forums and subject to appropriate information sharing rules, entities must share high-level lessons learned from major cyber incidents with other entities. Control 4.3.2 Entities must make use of threat intelligence sources to make sure that cyber detection and analysis systems have up-to-date knowledge on current indicators of compromise (IOCs) and other relevant information on the latest tools, techniques, and procedures (TTPs) employed by threat actors. 4.3.2.1 Entities must make use of an automated threat intelligence information sharing platform and subscribe to relevant threat intelligence feeds such as the T-ISAC feed. 26 Control 4.3.3 Entities must maintain an ‘abuse’ function, which responds to external security complaints about their subscribers and notifies them of the complaint, with the goal of remediating the security vulnerability. (IETF RFC 2142). Subdomain 4.4 Testing and Exercises Cyber exercises are simulated scenarios that test the preparedness and resilience of an organization against cyber threats. They help to identify gaps, improve skills, and enhance coordination among different stakeholders. This subdomain identifies controls to continually measure and reinforce this organizational preparation and resilience. Control 4.4.1 Entities must periodically conduct cyber exercises using different threat scenarios to test and validate different aspects of their cybersecurity controls and capabilities. Control 4.4.2 Exercises must be formally planned, executed, and documented, with a summary of the exercise briefed to senior leaders and the board of directors. This summary must include lessons learned, root cause analysis, and an action plan to address these findings. Control 4.4.3 Exercises must involve a complete cross section of organizational resources and teams who may be required to fully respond to the threat scenario being exercised. This may include representatives from an entity’s communications, customer service, legal, privacy, or finance departments. 27 Domain 5 Generally Applicable Telecoms Security Controls The recommendations in domains 1 through 4 broadly apply to all areas of the organization including telecommunications systems. The following three domains set out controls which are specific to the technology of telecommunications systems. This domain focuses on telecom

---

security controls that are broadly applicable and relevant across all environments and technologies, as well as on managing and operating networks based on the GSMA mobile cyber security knowledge base. Where possible, controls are scoped to Signaling, Management, and User planes based on the ITU X.805 security architecture definition of these planes Subdomain 5.1 Architecture and Design Controls The following represents design patterns and practices that can be broadly applied to all areas of the telecommunications provider to serve as a foundation for strong security. Control 5.1.1 Physical or logical separation must be maintained between Signaling, Management and User planes and prevent communication between planes (for example, user to signaling, and management to user). Control 5.1.2 Systems that support more than one plane (such as DNS) must ensure logical or physical separation to avoid cross-contamination and abuse. Control 5.1.3 Network Security Monitoring must be designed and enabled by the operator through specific and dedicated devices to allow for anomaly and attack detection through the use of techniques that may include network flow analysis and in-band tapping. Control 5.1.4 Network products must have the ability to filter incoming IP packets at the network and transport layer (for example, RFC 3871, and 3GPP TS 33.117). Control 5.1.5 Communications integrity protection must be enabled where supported and recommended by industry standards (for example, 5G air interface, and user-plane). Control 5.1.6 Centralized logging must be used for all systems via the management plane. Control 5.1.7 Centralized AAA with MFA and command-logging must be used for all systems, where supported and possible. Control 5.1.8 Centralized timing must be used for all systems (for example, NTP), generated from an authoritative and secure internal source (for example, atomic clock), and propagated outward to external and user plane systems as required. Where supported, at least two different time sources are used to ensure that the timestamps in logs are consistent. Control 5.1.9 All systems must be hardened via the application of security controls following the vendor recommendation and/or security best practices. This includes the configuration of security features on the systems, the integration with security systems (centralized authentication), and the application of new security software and agents where possible. Control 5.1.10 Entities must validate the integrity of software prior to use. 28 Control 5.1.11 Where possible, hardware must support secure boot process (such as, defined memory device for boot image, UEFI, Hardware-Based Root of Trust, and so forth). Control 5.1.12 Security agents must be used on systems that support it for the detection of anomalous or malicious events and intrusions. Control 5.1.13 All API connections, including those used in mobility such as CAPIF, network slicing, SDN and NFV MANO deployments, must use TLS protection. Subdomain 5.2 Control Plane Controls The control plane supports the integrity of the telecommunications infrastructure. The following controls aim to ensure that signaling, which controls the topology and traffic flow of the network, are secure. Control 5.2.1 Signaling endpoints and path must be controlled and validated (such as an allow list) through the use of techniques that include logically or physically separate network resources, firewalls or packet filters, and IPSec VPNs. Control 5.2.2 Cryptographic protection of signaling must be used where supported and recommended by industry standards (such as S1-MME). Control 5.2.3 Signaling origin must be cryptographically authenticated with unique credentials per signaling source and administrative domain. Control 5.2.4 Signaling content must be filtered to ensure receipt and/or transmission of desired signals only (whitelist). Control 5.2.5 Signaling speaker resources (such as CPU and so forth) must be protected with interface and control-plane filters to prevent denial of service attacks. Control 5.2.6 Signaling anomalies and abuse must be monitored and alerted. Subdomain 5.3 Management Plane Controls Ultimately, the primary concern of a telecommunications provider is to maintain control over its infrastructure, and this is done primarily through the management plane. The management plane is among the highest priority and sensitivity networks in critical infrastructure. Control 5.3.1 The management plane must be separate (from any other network) with perimeter access controls (such as firewalls), strong user authentication (multi-factor), and granular user-access control designed to provide the least privilege required per connection. Control 5.3.2 The management plane must not have an Internet connection. Control 5.3.3 Least privilege network access must be enforced via network segmentation in a hub-and-spoke architecture, with central systems in the hub and managed elements on isolated spokes, and routing controls. 29 Control 5.3.4 Managed elements, by default, must not be able to inter-communicate on the management plane. Control 5.3.5 All communicating endpoints on the management interface must be mutually authenticated (for example. pre-shared client-based IPSec or TLS certificates). Control 5.3.6 Management systems must only be able to view elements that they are intended to manage, using separate logical and physical segmentation and routing controls. Control 5.3.7 Access to the management plane must be via dedicated jump-servers (for example, proxies, and SSH relays) with multi-factor authentication. Control 5.3.8 Root or administrator accounts must be limited to console access only. Control 5.3.9 Entities must not provision or enable multi-user, shared accounts. Control 5.3.10 Remote access must be restricted to provide only the minimum privileges necessary to accomplish designated tasks or functions. Remote access systems must be accessed with origin validation (whitelist) and multi-factor authentication, must be encrypted, and fully logged. Control 5.3.11 Vendor and third-party remote access must be escorted by entity team members (physically, or logically through the use of techniques which include sharing split MFA token credentials) and monitored at all times, with logs stored for later review if required. Control 5.3.12 Where static or shared passwords are required, or user-level access controls are not available, systems must be protected by authentication and authorization proxies and network segmentation. Control 5.3.13 Comprehensive audit logs of all management and administrative functions, including per-command logs, must be maintained, and monitored for abuse. Subdomain 5.4 User (Data) Plane Controls The primary role of the telecommunications provider is to maintain the availability of the user plane for its customers and the country. To that end, the following simple

---

controls ensure that the telecommunications provider’s network minimizes the amount of disruptive traffic on its network. Control 5.4.1 All connections to the entity’s network, both customer and peers, must be validated to prevent false traffic sources (spoofing). Control 5.4.2 An entity must prevent malicious or inappropriate traffic from being received and transmitted through the use of packet and route filtering and/or payload inspection. Control 5.4.3 Entity must prevent volumetric attacks (DoS) via packet and protocol filters, rate-limiting, or mitigation systems. 30 Subdomain 5.5 Security Practices The following high-level best practices ensure that the telecommunications environment can support and maintain the security controls referenced in this document. Control 5.5.1 Network and design documentation and diagrams must be created and maintained for all telecom systems, including hardware and software inventory, and a description of data flows. Control 5.5.2 Logging must be reviewed regularly for evidence of abuse and real-time alerting must be enabled for pre-defined security use-cases. Control 5.5.3 Vulnerability scans must be performed in both lab and production systems to reduce the attack surface and eliminate flaws from systems. Control 5.5.4 Lab security must be maintained at the same level as that of production systems. Control 5.5.5 Formal change control with dual oversight must be used throughout to maintain resiliency and ensure stability of the technology and to prevent abuse. Control 5.5.6 A SIRT function must exist and have scope for telecom systems and services to respond to security incidents in any of the entity environments and technologies. 31 Domain 6 Peering and Interconnection This domain focuses on security controls which are relevant in the context of international peering and interconnection. Implementing these controls will help the Kingdom of Bahrain enhance the security of its regional and global interconnections and maintain its position as one of the region’s leading countries for IT infrastructure and connectivity. Subdomain 6.1 Internet Internet peering is the primary data connection for the national critical infrastructure and the connection to the rest of the world. This subdomain sets out the basic security controls for a secure global interconnect. While these controls are primarily aimed at network service providers, these controls may also apply to enterprises that do not provide network services to customers but own their own ASN and publicly registered network resources for corporate use. Control 6.1.1 Entities must define a clear routing policy and implement a system that ensures correctness of their own announcements and announcements from their customers to adjacent networks with prefix and AS-path granularity. Control 6.1.2 Publicly documented routing policy, ASNs and prefixes must be registered with the IRRs to ensure appropriate transit filters and contact information. Control 6.1.3 Entities must maintain globally accessible and current contact information in official public registries (such as RIPE, RADB, and PeeringDB) in addition to on their public web site. Control 6.1.4 Entities must communicate to their adjacent networks which announcements are correct, via IRR information and/or PKI ROAs. Control 6.1.5 Entities must be able to validate received route announcements via IRR information and/or PKI ROAs and must be able to drop prefixes with invalid ROAs. Control 6.1.6 Entities must prevent source spoofing by blocking received route advertisements for their own network or networks of their customers. Control 6.1.7 Entities must implement a mechanism to secure Border Gateway Protocol (BGP) routing, such as Resource Public Key Infrastructure (RPKI), to prevent route prefix hijacking and ensure the integrity and reliability of telecommunications services. Control 6.1.8 Entities must filter BGP for invalid ASNs via AS path filtering. Control 6.1.9 Entities must filter BGP communities from all received and transmitted routes across the ASN boundary, unless explicitly required. Control 6.1.10 Entities must monitor route advertisements and registrations for abuse and hijacking. Control 6.1.11 Entities must implement anti-spoofing filtering to prevent packets with incorrect source IP address from entering and leaving the network. 32 Subdomain 6.2 Voice and Mobility Voice and mobility peering involves a number of legacy technologies from legacy PSTN to current 5G mobile networks. As a result, it has a wide attack surface, and many legacy vulnerabilities may be exposed. Control 6.2.1 Entities must implement Home Routing. Control 6.2.2 Entities must monitor edge network nodes, such as STP/DEA/DRAs, for SS7 and Diameter signaling attacks. Control 6.2.3 Entities must prevent SS7 and Diameter signaling attacks by implementing a signaling firewall at edge network nodes, either on-premises or via an upstream IPX service. Control 6.2.4 Entities must also prevent SS7 and Diameter signaling attacks by filtering core network elements, such as the VLR and MME. Control 6.2.5 Entities must harden signaling termination points per GSMA guidelines (such as HLR, and MSC). Control 6.2.6 Entities must protect roaming and interconnections from attacks (such as eavesdropping, and denial of service) through the use of techniques listed in GSMA FS.31, which includes filters for malformed and/or inappropriate requests, signaling proxies, and rate- limits. Subdomain 6.3 Satellite Ground Stations Satellite has previously been a relatively isolated network but is increasingly being used for Internet and mobility backhaul. As a result, it is important to secure the ground station to ensure the integrity of the ground-to-space connection. In addition, as the satellite is a difficult device to remediate, ensuring that it is protected from attack through the ground-station is equally important. Control 6.3.1 Satellite ground station consists of two centers which must be kept separate: Mission Operations Center (which controls the satellite itself), and Payload Control Centers (which controls the various payloads on the satellite). The satellite itself is out of scope of these guidelines. Control 6.3.2 Mission Operations Centers and Payload Control Centers must be kept separate at both a systems and network level, and protected by firewalls and other security measures to prevent unauthorized access. These represent different administrative zones and policies. Control 6.3.3 Mission Operations Center must be kept securely isolated from all other networks (such as the internet) with appropriate separation (for example, an air gap or DMZ). This is the highest priority zone for protection as it controls the satellite itself. Control 6.3.4 Spot beams (concentrated signals to geographic

---

areas) and frequency hopping must be employed to avoid eavesdropping. Control 6.3.5 Satellite transmissions must be encrypted and authenticated. 33 Control 6.3.6 To protect against replay attacks or spoofing, entity must employ measures such as a command count or nonce on encrypted satellite transmissions. Control 6.3.7 Entity must employ hardware or software integrated into the ground station to detect and mitigate radio frequency jamming and spoofing events in addition to radio frequency interference and degradation. Control 6.3.8 Network activity at satellite ground stations must be monitored to detect malicious or anomalous events. Control 6.3.9 As satellites have limited abilities for self-protection, the satellite transmissions must be monitored for malware or attacks at the ground station, in both the Mission Operations Centers and Payload Operations Centers for their respective transmissions. Where possible, network monitoring on this segment must be correlated with that in the ground station to identify active attacks against the satellite. Control 6.3.10 Payloads providing user-plane connectivity (such as internet) must meet the same requirements as wireline providers for user-plane security (such as filtering, and so forth). Control 6.3.11 Entities must be able to contain security events in the ground station, which may include transitioning Mission and Payload Operations to an alternate site. Playbooks governing this decision must be created in advance and tested. Control 6.3.12 Software, firmware and code must be protected to maintain integrity and prevent tampering. 34 Domain 7 National Infrastructure and Services This domain focuses on telecoms security controls that are principally applicable within the Kingdom of Bahrain’s domestic networks and infrastructure. Subdomain 7.1 Internet In addition to global Internet peering security, some basic security practices are required to ensure the integrity of the national Internet network. Control 7.1.1 Entity must apply due diligence when checking the correctness of its customer’s announcements, specifically that the customer legitimately owns the ASN and the address space it announces. Control 7.1.2 Entity must maintain an abuse-reporting function to receive complaints about inappropriate or illegal use of network resources originating from the entity, an ability to notify entity’s customers of abuse, and a remediation function to prevent abuse from repeat offenders. This is applicable to entities offering customer network services, as well as entities that do not, as the abuse complaints can reflect a corporation’s incidents as well as its customers. Control 7.1.3 Entity must deploy RPKI and validate national peer prefix advertisements, dropping advertisements that do not have valid ROAs. Subdomain 7.2 Voice and Mobility This subdomain outlines the requirements for secure voice and mobility services with the goal of reducing spoofed content, ensuring the security of user equipment, preventing eavesdropping and interception of customer traffic, and protecting the privacy of customers. Control 7.2.1 Entity must prevent the connection and use of stolen, defective, or counterfeit devices. This may be done by using community-sourced information on such devices (such as the GSMA FASG IMEI registry). Control 7.2.2 Entity must have a program to securely manage (e)UICC/SIMs, including secure provisioning and purchase from reputable vendors. Control 7.2.3 The administrative function of moving (porting) SIM/eSIM between entities must be protected from abuse through security mechanisms which include the use of robust customer authentication, MFA, out-of-band confirmation, and wait periods. Control 7.2.4 SIP server connections must be protected by Session Border Controllers (SBCs). Control 7.2.5 Entities must implement means to cryptographically sign the calls they originate and validate the origin of received calls (such as the STIR/SHAKEN protocols). Control 7.2.6 ENUM service (E164 Number to URL Mapping) must use a trusted and protected (internal only) DNS service. 35 Control 7.2.7 Entity must use temporary mobile identifiers (for example SUPI, and TMSI) to prevent user tracking. Control 7.2.8 The strongest encryption must be enabled on mobility networks (such as 2G, and 3G) with the use of Null encryption, if required, as the last resort. Control 7.2.9 For over-the-air mobility traffic, including for GSM, GPRS, UMTS, LTE, and NR networks, an entity must comply with telecoms encryption best practices to protect against unauthorized interception or interference. 7.2.9.1 For GSM, A5/3 must be enabled. A5/4 and A5/1 must be enabled if possible. 7.2.9.2 For GPRS, GEA3 must be enabled. GEA4 must be enabled if possible. Control 7.2.10 5G functions in the SBA are authenticated cryptographically, and accessed via properly configured OAUTH, per industry specifications (3GPP). This includes inter-SEPP communication in all cases. Control 7.2.11 The 5G UPF must validate receipt of GTP-U traffic from whitelisted senders only and drop unvalidated connections, either on the UPF or an associated security device. Control 7.2.12 Entities must ensure that internal 5G core information such as SUPI, DNN, S- NSSAI is not disclosed by NEF to application functions residing outside the MNO domain. Control 7.2.13 VMs and containers in MEC must be encrypted in storage. Control 7.2.14 Both the physical security of base-stations and small-cells must be protected with methods that include secure buildings or tamper-resistant casings. Subdomain 7.3 Domain Name System (DNS) The DNS system is, in essence, a control plane for data networks, as it translates between addresses and names. As a result, it can be a target for an attacker who is trying to subvert any of the telecommunications’ services and must be secured. These controls apply to both those entities that provide DNS services to customers, as well as those that simply use and maintain DNS services for corporate use. Control 7.3.1 DNS servers must be separated into public-facing server which responds to queries (recursive), and the private authoritative server which maintains the entity DNS database, separated by a firewall or other protective device. Control 7.3.2 Authoritative servers must be protected by refusing all connections except those from valid resolvers. Control 7.3.3 Authoritative servers must be geographically separate to maximize resiliency against DNS attacks. Control 7.3.4 Client DNS queries must be resolved by authorized recursive resolvers which are allowed to query authoritative servers. Control 7.3.5 Recursive resolvers must be protected by rate limiting and packet filters. 36 Control 7.3.6 Properly configured and managed DNSSEC must be used to protect queries and responses between servers.

---

Control 7.3.7 DNS servers must use cryptographic methods to secure stub, recursive and authoritative communications (for example, DNSSec, DTLS per RFC 7858 and RFC8310). Control 7.3.8 Entity must protect DNS transactions (such as updates of resolution data, or data replication between nodes) with cryptographic techniques per IETF TSIG (transaction signature) specification. Control 7.3.9 Entity must maintain an ability to monitor DNS service for abuse. Control 7.3.10 Entity must maintain an ability to filter DNS service for abuse and malicious content using techniques which include RPZ (Response Policy Zones) on recursive servers. Subdomain 7.4 Messaging Messaging abuse is one of the more pervasive abuses on the Internet. Simple content and volume controls at the provider edge can reduce this impact and ensure that telecommunications providers are acting as Internet ‘good neighbors’. These controls apply both to entities that are providing messaging services for customers, as well as those that simply use messaging in a corporate setting. In all cases, messaging abuse must be managed. Control 7.4.1 Entity must filter outbound SMTP from itself and subscribers, where possible, to remove abuse (such as SPAM, and volumetric attacks). Control 7.4.2 Messaging (SMS, MMS, and so forth) must be filtered to prevent subscribers from receiving attacker traffic (such as OTA solicitation attempts). Control 7.4.3 SMS gateways, such as email-to-SMS, must implement rate-limiting to minimize abuse Control 7.4.4 Entities must be responsive to direction and regulations from the TRA regarding the management of unsolicited messaging. Control 7.4.5 Entities sending bulk messages must ensure that:  Recipient permission is obtained.  Recipient opt-out is provided and honored.  Message originator is properly identified.  Recipient information is protected when stored. Subdomain 7.5 Private Wireless For private mobile networks (especially private 5G networks) offered as a managed service by the entities, the following controls must apply to ensure security of the private network and protection between it and other entity networks: 37 Control 7.5.1 Entities must provide a separate data gateway for private network user-plane (for example, GGSN, PGW, UPF, and APN). Control 7.5.2 Entities must provide separate data network external addressing for private networks, to isolate the attack surface. Control 7.5.3 Entities must ensure logical and/or physical separation of user-planes in the RAN (such as separate GTP tunnels from other networks). Control 7.5.4 Entities must employ dedicated SIM/eSIMs for the private network, not usable on other networks. Control 7.5.5 Entities must not offer the air interface Null encryption scheme on IoT or private networks where the UE is well defined and supports encryption. Control 7.5.6 Where telecommunications equipment is deployed at a customer site for private mobile, it must be physically secured with operator access only. Control 7.5.7 Where the private network is deployed partially on non-telecommunications facilities, encryption must be used on all links containing signaling or management plane traffic. Control 7.5.8 Where a customer-facing system is provided for management (such as an IoT console), the entities must ensure logical or physical separation between customers. Control 7.5.9 All private network elements and systems must be secured, including remote management, as per the standards for the entities own network. 38 Appendix A Glossary of Abbreviations and Acronyms 3rd Generation Partnership Project (3GPP) – An umbrella term for several standards organizations which develop protocols for mobile telecommunications. Access Point Name (APN) – A gateway between a GSM, GPRS, 3G or 4G mobile network and another computer network, frequently the public Internet. A mobile device making a data connection must be configured with an APN to present to the carrier. Application Programming Interface (API) – A set of definitions and protocols for building and integrating application software. Authentication, Authorization, and Accounting (AAA) – Authentication is the process of confirming the correctness of the claimed identity, Authorization is the approval, permission, or empowerment for someone or something to do something, and Accounting is the recording of actions to form an audit trail. Autonomous System (AS) – A very large network or group of networks with a single routing policy. Each AS is assigned a unique ASN. Autonomous System Number (ASN) – Each AS is assigned an official number, or autonomous system number, similar to how every business has a business license with a unique, official number. They are unique 16-bit numbers between 1 and 65534 or 32-bit numbers between 131072 and 4294967294. ASNs are only required for external communications with inter-network routers. Border Gateway Protocol (BGP) – BGP is the protocol that makes the Internet work by enabling data routing. When a user in Singapore loads a website with origin servers in Argentina, BGP is the protocol that enables that communication to happen quickly and efficiently. Bring Your Own Device (BYOD) – Allows employees to use their personal devices such as laptops, tablets, mobile phones and other devices, to connect to the internal network. Business Continuity Management (BCM) – Holistic management process that identifies potential threats to an organization and the impacts to business operations those threats, if realized, might cause, and which provides a framework for building organizational resilience with the capability of an effective response that safeguards the interests of its key stakeholders, reputation, brand, and value-creating activities. Business Continuity Plan (BCP) – A Business Continuity Plan is the plan for emergency response, backup operations, and post-disaster recovery steps that will ensure the availability of critical resources and facilitate the continuity of operations in an emergency situation. Business Impact Analysis (BIA) – A Business Impact Analysis determines the tolerable levels of impact to a system. 39 Central Processing Unit (CPU) – The central processing unit or processor is the unit which performs most of the processing inside a computer. It processes all instructions received by software running on the PC and by other hardware components and acts as a powerful calculator. Chief Information Security Officer (CISO) – A CISO focuses on developing and leading the information security program. This involves protecting the organization's assets, applications, systems, and technology while enabling and advancing business outcomes. Common API Framework (CAPIF) – A standardized API framework for use in 5G

---

networks. Continuous Delivery (CD) – A software engineering approach in which teams produce software in short cycles, ensuring that the software can be reliably released at any time and, following a pipeline through a "production-like environment", without doing so manually. Continuous Integration (CI) – The practice of merging all developers' working copies to a shared mainline several times a day. Nowadays it is typically implemented in such a way that it triggers an automated build with testing. Continuous Integration and Continuous Delivery (CDI/CD) – the combined practices of continuous integration (CI) and continuous delivery (CD) or, less often, continuous deployment. Cyber Incident Response Team (CIRT) – Group of individuals usually consisting of Security Analysts organized to develop, recommend, and coordinate immediate mitigation actions for containment, eradication, and recovery resulting from computer security incidents. Also called a Computer Security Incident Response Team (CSIRT) or a CIRC (Computer Incident Response Center, Computer Incident Response Capability, or Cyber Incident Response Team). Data Network Name (DNN) – A network representation in 5G networks, typically in the form of an Access Point Name. Demilitarized Zone (DMZ) – A perimeter network that protects and adds an extra layer of security to an organization’s internal local-area network from untrusted traffic. Denial of Service (DoS) – The prevention of authorized access to a system resource or the delaying of system operations and functions. Diameter Edge Agent (DEA) – A network component in a telecommunications network that performs routing functions and acts as an interface between the core Diameter network and external networks. Diameter Routing Agent (DRA) – A functional element in a 3G or 4G (such as LTE) network that provides real-time routing capabilities to ensure that messages are routed among the correct elements in a network. Disaster Recovery (DR) – Disaster Recovery is the process of recovery of IT systems in the event of a disruption or disaster and is normally codified in a DR plan. 40 Domain Name System (DNS) – The domain name system is the way that Internet domain names are located and translated into Internet Protocol addresses. A domain name is a meaningful and easy-to-remember "handle" for an Internet address. Domain Name System Security Extensions (DNSSEC) – A feature of the Domain Name System that authenticates responses to domain name lookups. It does not provide privacy protections for those lookups but prevents attackers from manipulating or poisoning the responses to DNS requests. Domain-based Message Authentication, Reporting, and Conformance (DMARC) – DMARC is a technical specification that allows Message Senders and Message Receivers to cooperate and thereby better detect when messages don't originate from the Internet domain they claim to have been sent from. It does this by allowing the Domain Owner to indicate they are using email authentication on the messages they send, optionally requesting that messages that fail to authenticate be blocked. Message Receivers honor these requests (unless there is a local policy overriding this action) and send reports on all the messages - whether or not they pass email authentication - to the Domain Owner. DomainKeys Identified Mail (DKIM) – Domain Keys Identified Mail is a signature-based Email Authentication technique. It is the result of merging the DomainKeys and Identified Internet Mail specifications. Dynamic Application Software Testing (DAST) – A non-functional testing process where one can assess an application using certain techniques and the end result of such testing process covers security weaknesses and vulnerabilities present in an application. Embedded Subscriber Identity Module (eSIM) – A SIM where the subscriber profile can be changed over the air without changing the actual SIM. Extended Detection and Response (XDR) – A software as a service (SaaS) tool that offers holistic, optimized security by integrating security products and data into simplified solutions. Firewall – A logical or physical discontinuity in a network to prevent unauthorized access to data or resources. Fraud and Security Group (FASG) – GSMA’s FASG provides an open, receptive, and trusted environment within which fraud and security intelligence and incident details can be shared in a timely and responsible way. Gateway GPRS Support Node (GGSN) – Converts the incoming data traffic coming from the mobile users through the Service gateway GPRS support node (SGSN) and forwards it to the relevant network, and vice versa. The GGSN and the SGSN together form the GPRS support nodes (GSN). General Packet Radio Service (GPRS) – Also called 2.5G, is a packet oriented mobile data standard on the 2G cellular communication network's global system for mobile communications. Global System for Mobile Communications (GSM) – A standard developed by the European Telecommunications Standards Institute to describe the protocols for second- generation digital cellular networks used by mobile devices such as mobile phones and tablets. 41 Global System for Mobile Communications Association (GSMA) – A global organization unifying the mobile ecosystem to discover, develop and deliver innovation that helps business and society thrive. Governance, Risk, and Compliance (GRC) – A set of processes and procedures to help organizations achieve business objectives, address uncertainty, and act with integrity. GPRS Tunnelling Protocol - Userplane (GTP-U) – GTP-U is used to carry the user traffic within the mobility RAN network. Hardware Security Module (HSM) - a physical computing device that safeguards and manages secrets (most importantly digital keys), performs encryption and decryption functions for digital signatures, strong authentication and other cryptographic functions. High-Level Diagram (HLD) – Overall Network Design describing the relationship between various system modules and functions. Hypertext Transfer Protocol (HTTP) – An application layer protocol designed to transfer information between networked devices and runs on top of other layers of the network protocol stack. It is the foundation of the World Wide Web, and is used to load webpages using hypertext links. Hypertext Transfer Protocol Secure (HTTPS) – When used in the first part of a URL (the part that precedes the colon and specifies an access scheme or protocol), this term specifies the use of HTTP enhanced by a security mechanism, which is usually SSL. Identity and Access Management (IAM) – The process of employing emerging technologies

---

to manage information about the identity of users and control access to company resources. Indicators of Compromise (IOCs) – IOCs are pieces of digital forensics that suggest that an endpoint or network may have been breached. Information Sharing and Analysis Centers (ISACs) – Organizations that provide a central resource for gathering information on cyber threats (in many cases to critical infrastructure) as well as allow two-way sharing of information between the private and the public sector about root causes, incidents, and threats, as well as sharing experience, knowledge, and analysis. International Mobile Equipment Identity (IMEI) – A numeric identifier, usually unique, for 3GPP and iDEN mobile phones, as well as some satellite phones. GSM networks use the IMEI number to identify valid devices and can stop a stolen phone from accessing the network. Internet Engineering Task Force (IETF) – The IETF creates voluntary standards that are often adopted by Internet users, network operators, and equipment vendors, and it thus helps shape the trajectory of the development of the Internet. Internet Protocol (IP) – The method or protocol by which data is sent from one computer to another on the Internet. Internet Protocol Security (IPsec) – A developing standard for security at the network or packet processing layer of network communication. 42 Internet Routing Registry (IRR) – IRRs contain information that has been submitted and maintained by internet service providers or other entities, about Autonomous System Numbers (ASNs) and routing IP number prefixes. IRRs can be used to develop routing plans. Intrusion Detection System (IDS) – A security management system for computers and networks. An IDS gathers and analyses information from various areas within a computer or a network to identify possible security breaches, which include both intrusions (attacks from outside the organization) and misuse (attacks from within the organization). Intrusion Prevention System (IPS) – Intrusion Prevention Systems (IPS) commonly employ countermeasures to prevent intruders from gaining further access to a computer network. IP Exchange (IPX) – A set of packet-switching and packet-sequencing protocols designed to function in small and large networks. Key Performance Indicators (KPIs) – A quantifiable measure of performance over time for a specific objective. Key Risk Indicators (KRIs) – Key risk indicators monitor changes in the levels of risk exposure and contribute to the early warning signs that enable organizations to report risks, prevent crises and mitigate them in time. Least Privilege – This is the principle of allowing users or applications the lowest amount of permissions necessary to perform their intended function. Local Area Network (LAN) – A local area network is a computer network that interconnects computers within a limited area such as a residence, school, laboratory, university campus or office building. Long-Term Evolution (LTE) – A standard for wireless broadband communication for mobile devices and data terminals, based on the GSM/EDGE and UMTS/HSPA standards. It improves on those standards' capacity and speed by using a different radio interface and core network improvements. Low-Level Diagram (LLD) – Detailed design depicting in depth information of the HLD. Management and Network Orchestration (MANO) – Management and Network Orchestration for NFV networks. MANO is the collection of systems that control and orchestrate the deployment of virtual machines in the NFV network. Mobile Network Operator (MNO) – An entity that provides mobile network services and operates its own physical infrastructure. Multi-access Edge Compute (MEC) – A computing framework to leverage the features of a 5G network and deliver edge computing in the 5G RAN. Multi-Factor Authentication (MFA) – MFA is multiple levels of authentication in which an individual authenticates not only with a password (something they know), but some type of unique code or device they have. Multimedia Messaging Service (MMS) – MMS is a way to send messages on mobile devices, which include media objects. 43 National Institute of Standards and Technology (NIST) – An agency of the United States Department of Commerce whose mission is to promote American innovation and industrial competitiveness. Network Equipment Security Assurance Scheme (NESAS) – GSMA scheme to facilitate improvements in network equipment security levels, across the mobile industry. Providing one universal and global security assurance framework. Network Exposure Function (NEF) – The standardized API gateway in the 5G architecture. Network Function Virtualization (NFV) – A network architecture concept that leverages IT virtualization technologies as the building blocks of the network. Network Time Protocol (NTP) – NTP is an internet protocol that’s used to synchronize the clocks on computer networks to within a few milliseconds of universal coordinated time (UTC). It enables devices to request and receive UTC from a server that, in turn, receives precise time from an atomic clock. New Radio (NR) – Also called 5G NR, is a new radio access technology developed by the 3rd Generation Partnership Project (3GPP) for the 5G (fifth generation) mobile network. NIST Cybersecurity Framework – Voluntary guidance, based on existing standards, guidelines, and practices for organizations to better manage and reduce cybersecurity risk. NIST Risk Management Framework – The Risk Management Framework provides a process that integrates security, privacy, and cyber supply chain risk management activities into the system development life cycle. North American Network Operators' Group (NANOG) – An educational and operational forum for the coordination and dissemination of technical information related to backbone/enterprise networking technologies and operational practices. Open Authorization (OAUTH) – An open standard for the delegation of access to systems. Open Worldwide Application Security Project (OWASP) – An online community that produces freely-available articles, methodologies, documentation, tools, and technologies in the field of web application security. Over-the-Air (OTA) – A technology that updates and changes data in the SIM card without having to reissue it. Packet Network Data Gateway (PGW) – Acts as the interface between the LTE network and other packet data networks, such as the Internet or SIP-based IMS networks. Penetration Testing (PT) – Penetration testing is used to test the external perimeter security of a network or facility. Personal Data Protection Law – Safeguarding of information in any form which identifies an individual, to prevent breach of

---

and protect his/her privacy, especially in light of digital challenges. 44 Privileged Access Management (PAM) – Computer access with higher access rights than those of a standard user in an enterprise Privileged identity management (PIM) – Part of privileged access management (PAM) process. PIM involves a set of security controls to monitor, control, and audit access to privileged enterprise identities including service accounts, database accounts, passwords, SSH keys, digital signatures, and so on. Product Security Incident Response Team (PSIRT) – A dedicated team that receives, investigates, and publicly reports security vulnerability information that is related to their product. Public Key Infrastructure (PKI) – A Public Key Infrastructure (PKI) is used to confirm identity. It does this by proving ownership of a private key. It is a 'trust service' which can be used to verify that a sender or receiver of data are exactly who they claim to be. Public Switched Telephone Network (PSTN) – The aggregate of the world's telephone networks that are operated by national, regional, or local telephony operators. It provides infrastructure and services for public telecommunication. Recovery Point Objectives (RPO) – The point in time to which data must be recovered after an outage. Recovery Time Objectives (RTO) – The overall length of time an information system’s components can be in the recovery phase before negatively impacting the organization’s mission or mission/business processes. Remote Desktop Protocol (RDP) – A system and network protocol to facilitate remote access to a system over a connected network. Resource Public Key Infrastructure (RPKI) – RPKI is a cryptographic method of signing records that associate a BGP route announcement with the correct originating AS number. Response Policy Zones (RPZ) – Response policy zones are a way for you to control what your queriers can and can’t look up using a recursive DNS server. By understanding the reputation of the servers and services that clients are querying, you can determine actions to take when the recursive server receives queries for certain domain names or sees information in the DNS responses that point to those malicious servers. Route Origin Authorization (ROA) – ROA is a cryptographically signed object that states which Autonomous System (AS) is authorized to originate a certain prefix. This means ROAs say something about the BGP announcements that are done with your address space. Secure Email Gateway (SEG) – A SEG is an email security product that uses signature analysis and machine learning to identify and block malicious emails before they reach recipients’ inboxes. Secure Shell (SSH) – An encrypted communication channel for command-line access to systems. 45 Secure Telephony Identity Revisited (STIR) – Part of the STIR/SHAKEN or SHAKEN/STIR suite of protocols and procedures intended to combat caller ID spoofing on public telephone networks. Security Edge Protection Proxy (SEPP) – The 5G function that protects the signaling interconnection point between 5G networks. Security Incident Response Team (SIRT) – SIRT engineers work for companies to monitor for attacks and work on remediation immediately when they are detected. Security Information and Event Management (SIEM) – Security information and event management (SIEM) technology supports threat detection, compliance and security incident management through the collection and analysis (both near real time and historical) of security events, as well as a wide variety of other event and contextual data sources. Security Orchestration and Response (SOAR) – Technology that helps coordinate, execute, and automate tasks between various people and tools all within a single platform. This allows organizations to not only quickly respond to cybersecurity attacks but also observe, understand, and prevent future incidents, thus improving their overall security posture. Sender Policy Framework (SPF) – Sender Policy Framework, originally Sender Permitted From, is a path-based Email Authentication technique. Service-Based Architecture (SBA) – The underlying architectural principle for the 5G core network. Session Border Controller (SBC) – A special-purpose device that protects and regulates IP communications flows. As the name implies, session border controllers are deployed at network borders to control IP communications sessions. Short Message Service (SMS) – A text messaging service component of most telephone, Internet, and mobile device systems. It uses standardized communication protocols that let mobile devices exchange short text messages. Signal Transfer Point (STP) – A Signal Transfer Point is used in a SS7 or CC7 network. The STPs transfer SS7 messages between interconnected nodes (signaling end points) based on information contained in the SS7 address fields. Signalling System No. 7 (SS7) – A set of telephony signaling protocols developed in the 1970s, which is used to set up and tear down telephone calls in most parts of the world-wide public switched telephone network (PSTN). The protocol also performs number translation, local number portability, prepaid billing, Short Message Service (SMS), and other services. Signature-based Handling of Asserted information using TOKENs (SHAKEN) – Part of the STIR/SHAKEN or SHAKEN/STIR suite of protocols and procedures intended to combat caller ID spoofing on public telephone networks. Simple Mail Transfer Protocol (SMTP) – Used to send and receive email. SMTP primarily sends messages to a server for forwarding. Single-Network Slice Selection Assistance Information (S-NSSAI) – A unique identifier in 5G networks that is used to identify a network slice. 46 Software as a Service (SaaS) – A software licensing and delivery model in which software is licensed on a subscription basis and is centrally hosted. SaaS is also known as on-demand software, web-based software, or web-hosted software. Software Bill of Materials (SBOM) – A list of all the software components contained in a software package, including third-party libraries, drivers, and open-source software packages. Software Defined Local Area Network (SD-LAN) – A type of networking technology that uses software-defined networking (SDN) principles to manage and optimize the performance of local area networks (WANs). Software Defined Networking (SDN) – An architecture that decouples the network control and forwarding functions, enabling network control to become directly programmable and the underlying infrastructure to be abstracted for applications and network services. Software Defined Wide Area Network (SD-WAN) – A type of networking technology that uses software-defined networking (SDN) principles to manage

---

and optimize the performance of wide area networks (WANs). Software Development Lifecycle (SDLC) – A formal or informal methodology for designing, creating, and maintaining software (including code built into hardware). Source Code Analysis (SCA) – An automated process that identifies the open-source software in a codebase. This analysis is performed to evaluate security, license compliance, and code quality. Static Application Software Testing (SAST) – Used to secure software by reviewing the source code of the software to identify sources of vulnerabilities. Subscriber Identity Module (SIM) – The SIM is a smart card necessary to make use of a mobile phone for communication. The SIM is an integrated circuit that is intended to securely store the international mobile subscriber identity (IMSI) number, which is used to identify and authenticate subscribers on mobile telephone systems. Memory is also available on the SIM for personalized data, such as a telephone book and messages. Subscriber Permanent Identifier (SUPI) – The globally unique 5G identifier for an individual subscriber. Subscription Concealed Identifier (SUCI) – A unique identifier designed to protect the privacy of the subscriber's identity. It's generated by the User Equipment (UE) using an Elliptic Curve Integrated Encryption Scheme (ECIES)-based protection scheme. Superuser – A user that is authorized (and therefore, trusted) to perform security-relevant functions that ordinary users are not authorized to perform. Telecommunication Information Sharing and Analysis Center (T-ISAC) – GSMA’s central hub of information sharing for the Telecommunication Industry. Telephone Number Mapping (ENUM) – The mapping of telephone numbers with Internet identification and addressing name spaces. E.164 Number Mapping (ENUM) is an Internet Engineering Task Force (IETF) standard for mapping public switched telephone networks (PSTN) in the DNS. 47 Temporary Mobile Subscriber Identities (TMSI) – A temporary identification number that is used in the GSM network instead of the IMSI to ensure the privacy of the mobile subscriber. Transaction Signature (TSIG) – A secure method for communicating from a primary to a secondary Domain Name server (DNS). Transport Layer Security (TLS) – A cryptographic protocol designed to provide communications security over a computer network. The protocol is widely used in applications such as email, instant messaging, and voice over IP, but its use in securing HTTPS remains the most publicly visible. Unified Extensible Firmware Interface (UEFI) – A specification for a software program that connects a computer's firmware to its operating system. Uniform Resource Locator (URL) – The global address of documents and other resources on the World Wide Web. The first part of the address indicates what protocol to use, and the second part specifies the IP address or the domain name where the resource is located. Uninterruptible Power Supplies (UPS) – A device with an internal battery that allows connected devices to run for at least a short time when the primary power source is lost. Universal Integrated Circuit Card (UICC) – Smart card (integrated circuit card) used in mobile terminals in GSM and UMTS networks. The primary component of a UICC is a SIM card. Universal Mobile Telecommunications System (UMTS) – A third generation mobile cellular system for networks based on the GSM standard. User Entity and Behavior Analytics (UEBA) – A cybersecurity solution that uses algorithms and machine learning to detect anomalies in the behavior of not only the users in a corporate network but also the routers, servers, and endpoints in that network. User Plane Function (UPF) – The data gateway in 5G networks between mobility RAN and external Data Network. Virtual Machine (VM) – A compute resource that uses software instead of a physical computer to run programs. Virtual Private Network (VPN) – A restricted-use, logical (i.e., artificial or simulated) computer network that is constructed from the system resources of a relatively public, physical (i.e., real) network (such as the Internet), often by using encryption (located at hosts or gateways), and often by tunnelling links of the virtual network across the real network. For example, if a corporation has LANs at several different sites, each connected to the Internet by a firewall, the corporation could create a VPN by (a) using encrypted tunnels to connect from firewall to firewall across the Internet and (b) not allowing any other traffic through the firewalls. A VPN is generally less expensive to build and operate than a dedicated real network, because the virtual network shares the cost of system resources with other users of the real network. Vulnerability Assessment (VA) – Systematic examination of an information system or product to determine the adequacy of security measures, identify security deficiencies, provide data from which to predict the effectiveness of proposed security measures, and confirm the adequacy of such measures after implementation. 48 Web Application Firewall (WAF) – A WAF or web application firewall helps protect web applications by filtering and monitoring HTTP traffic between a web application and the Internet. Wide Area Network (WAN) – A wide area network is a telecommunications network that extends over a large geographic area. Wide area networks are often established with leased telecommunication circuits. Write Once Read Many (WORM) – Write-Once, Read-Many is a data storage technology mechanism that stores unerasable and/or unmodifiable information after it has been written on a drive. 49 Quality of Service Regulation A Regulation issued by the Telecommunications Regulatory Authority of the Kingdom of Bahrain Resolution No. (11) of 2018 Date: 16 Aug 2018 Quality of Service Regulation Chapter 1 General Provisions Article 1. Definitions Unless the context otherwise requires, any word, phrase or expression used in this Regulation or in the Schedules annexed to this Regulation shall have the meaning given to it in Article 1 of Legislative Decree No. (48) of 2002 Promulgating the Telecommunications Law. And the following terms and expression shall have the following meaning: 1. “Authority” means the Telecommunications Regulatory Authority established by virtue of the provisions of the Telecommunications Law; 2. “Core means the central part of the Telecommunication Network which Network” provides services to the End User through the access network. Each service, such as fixed voice, mobile voice and broadband

---

has a Core Network that provides the actual service through an access network; 3. "End User" means any Person using or requesting a Telecommunications Service; 4. “Fining means the Guidelines for the setting of the amount of a fine for Guidelines" violations of Articles 35 and/or 65 of the Telecommunications Law of the Kingdom of Bahrain, dated 16 March 2014, Ref: LAD 0314 038; 5. "Fixed means any Telecommunications Service that is not a Mobile Service; Telecommunic ations Service" 6. “Fixed Voice a Fixed Telecommunications Service that offers Voice Service; Service” 7. “Internet means any Telecommunications Service that is provided substantially Service” for data communications directly to or from network termination points that are associated with End Users and that have IP addresses assigned through delegation from the Internet Assigned Numbers Authority (IANA); 8. “Maintenance” means planned work that must be performed for a Telecommunications Network or Telecommunications Services to continue operating effectively; 9. “Measurement means a numerical value obtained by measuring using a ” Measurement Method with respect to a specific Reporting Period; 10. "Measurement means a method of measuring a Parameter of a Monitored Service; Method" 11. "Monitored means a Telecommunications Service for which Measurements of a Service” Parameter must be made as identified in Schedule 2 of this Regulation; 12. “Mobile means any Telecommunications Service which may be used while in Service” motion that uses mobile radiocommunications to provide Page 2 of 49 Quality of Service Regulation communications to or from network termination points that are associated with End Users; 13. “Network means a report filed by a Licensed Operator in accordance with Maintenance Article 12(b) of this Regulation; Report” 14. “Network means a report filed by a Licensed Operator in accordance with Outage Article 11(c) of this Regulation; Report” 15. “Network means a report filed by a Licensed Operator in accordance with Outage Follow- Article 11(d) of this Regulation; up Report” 16. “Outage” means an event that can cause a loss of integrity of a Telecommunications Network or Telecommunications Service; 17. “Parameter” means a measurable characteristic of the Quality of Service; 18. "Published means a Measurement intended for publication with the content and Measurement" format prescribed by the Authority from time to time; 19. "Quality of means the totality of characteristics of a Telecommunications Service Service" that bear on its ability to satisfy stated and implied needs of the End User of the service; 20. “Reference means a numerical value for specific Parameters of a Monitored Values” Service as established in Schedule 5 that shall be used by the Authority to monitor Quality of Service’s performance in accordance with this Regulation; 21. “Regulation” means this Quality of Service Regulation; 22. “Reporting means a period of time established for each Parameter in accordance Period” with Schedule 2 of this Regulation; 23. “Target” means a numerical value that represents a minimum satisfactory level for a Parameter of a Monitored Service as prescribed by a determination issued by the Authority in accordance with this Regulation; 24. "Telecommuni means Legislative Decree No. 48 of 2002 promulgating the cations Law" Telecommunications Law; 25. "Telecommuni Telecommunications service provided by a Licensed Operator to cations Subscribers, who may be End Users or Licensed Operators; Service" 26. “Voice Service” A Telecommunications Service of direct transport of real-time speech via the Public Telecommunications Network such that any user can use equipment connected to a network termination point to communicate with another user of equipment connected to another termination point. Page 3 of 49 Quality of Service Regulation Scope of the Regulation Article 2. The provisions of this Regulation shall apply to all Licensed Operators in the Kingdom of Bahrain, provided such Licensed Operators offer a Monitored Service to mass market Subscribers and serve at least one thousand (1,000) Subscribers for such Monitored Service. Notwithstanding the exceptions above, all Licensed Providers that offer Telecommunications Services shall be subject to the Outage and Maintenance notification requirements set forth in this Regulation. (1) The Licensed Operators subject to this Regulation shall undertake the necessary changes to their operation systems and processes, if needed, to ensure compliance with the provisions of this Regulation and any associated determinations issued by the Authority from time to time in relation to this Regulation. Chapter 2 Purpose and Objectives Article 3. The purpose of this Regulation is to set out a framework for measuring, reporting, monitoring, auditing and enforcing the Quality of Service of Telecommunications Services in the Kingdom of Bahrain. In furtherance of this purpose, this Regulation: (1) imposes obligations on Licensed Operators to periodically measure and submit to the Authority a set of Quality of Service Measurements of the Monitored Services that they provide in accordance with Schedule 1 and ensure Licensed Operators’ compliance with the Targets associated with specific Parameters, where applicable; (2) grants the Authority the power to: a. conduct Measurements, either directly or through a qualified third party, to monitor and audit the Quality of Service of the Telecommunications Services provided in the Kingdom of Bahrain; b. set out Targets associated with specific Parameters and its associated Reference Values pursuant to this Regulation; c. enforce compliance of the requirements and obligations set forth herein; and d. ensure that all or part of the Quality of Service Measurements reported by Licensed Operators and the Quality of Service Measurements, either conducted directly by the Authority or by a qualified third party on behalf of the Authority, are published in a manner that is easy to understand by End Users. Page 4 of 49 Quality of Service Regulation Article 4. This Regulation has the following objectives: (1) provide information to assist: a. End Users with their selection of Telecommunications Services by ensuring Quality of Service information provided to End Users is accurate, accessible and comparable; b. Licensed Operators with the design and operation of their Telecommunications Services and Telecommunications Networks; and c. the development of the telecommunications industry in the Kingdom of Bahrain. (2) further the interests of End Users in respect to choice, price, Quality of Service, and value for

---

money of Telecommunications Services. (3) ensure timely, complete and accurate reporting of Quality of Service Measurements by Licensed Operators; (4) assist in the maintenance and the improvement of the Quality of Service of Telecommunications Services provided by Licensed Operators. Article 5. The Parameters and Measurements specified in Schedule 1 of this Regulation will facilitate the Authority's monitoring of the telecommunications industry's performance in the Kingdom of Bahrain as well as provide data to support the evolution of an optimised regulatory framework. Chapter 3 Principles of Quality of Service Article 6. Quality of Service Measurements in the Kingdom of Bahrain shall: (1) apply to all Monitored Services as specified in Schedule 2; (2) enable End Users to compare the performance achieved by Licensed Operators in regard to the Quality of Service of Monitored Services; (3) be described in such terms that provide flexibility in the provision of future services; (4) support self-regulation within the framework for Quality of Service set forth in this Regulation, provided the Authority considers that: a. competitive forces are able to deliver and maintain adequate levels of Quality of Service for End Users, and Page 5 of 49 Quality of Service Regulation b. other public interest concerns do not require intervention by the Authority. (5) enable the Authority to establish appropriate Targets, as required, to improve and/or maintain minimum levels of Quality of Service which the Authority believes are satisfactory to meet the needs and expectations of End Users in the Kingdom of Bahrain. Measurement and Reporting of Quality of Service by Licensed Operators Article 7. Licensed Operators shall conduct Measurements for the Parameters of Monitored Service that they provide to the End Users specified in Article 3 of Schedule 1 and submit to the Authority timely, complete, comparable, accurate and up-to-date information on the Measurements conducted under this Article. Article 8. Quality of Service Measurements and other information submitted to the Authority in accordance with this Regulation shall not be considered as confidential information. Article 9. For each Reporting Period, Licensed Operators shall: (1) conduct Measurements, either directly or through a qualified third party, by using the prescribed Measurement Method for each reportable Parameter in accordance with Article 3 of Schedule 1; (2) no later than thirty (30) calendar days after the end of the Reporting Period, submit to the Authority a report containing the Measurements in electronic format using the form that may be issued by the Authority; (3) if directed by the Authority, submit any information that has been used in making the Measurements and any other information that is requested by the Authority from time to time, including but not limited to details of the observations and calculations made for the Measurements; and (4) maintain the Measurements and any information, observations and calculation used in making the Measurements for at least twelve (12) months after the end of the respective Reporting Period or as otherwise directed by the Authority. Article 10. In the event that a Licensed Operator has not filed a report containing the Measurements within the timeframe set forth in Article 9(2), the Authority shall, within two (2) working days of the filing deadline, require the Licensed Operator to file the omitted report within five (5) working days; and advise such Licensed Operator that failure to submit the omitted report in a complete and accurate manner within the timeframe set forth will result in enforcement actions in accordance with Article 40.3(a) of this Regulation. Article 11. Page 6 of 49 Quality of Service Regulation Licensed Operators must certify the accuracy and completeness of the Measurements submitted to the Authority. This certification shall be provided by a senior officer of the Licensed Operator. The Authority will not accept a report until the Licensed Operator provides the requisite certification. Article 12. In case of significant variation in a Measurements reported to the Authority, the reporting Licensed Operator shall file, in conjunction with the report referred to in Article 9(2) of this Regulation, a detailed explanation of the reasons that have caused such variation. Article 13. For the purpose of Article 12, significant variation means a ten (10) percent or more variation in the Measurement of a specific Parameter between two (2) consecutive Reporting Periods. The Authority may, from time to time, modify this threshold by issuing a reasoned determination. Article 14. The reporting form may be reviewed by the Authority from time to time and may determine the manner in which each Monitored Service must be reported, including but not limited to, reporting Parameters by specific access networks or technologies. Review and Audit of Quality of Service Information Article 15. The Authority may review and audit the information reported by Licensed Operators to ensure the accuracy and completeness of such reported information, and for this purpose may: (1) require Licensed Operators to submit supplementary information, documents or clarifications; and (2) inspect and examine any documents, information, databases, registries, Telecommunications Equipment, Telecommunications Facilities and other facilities deemed relevant by the Authority to assess completeness and accuracy of the information reported. Failure to submit complete and accurate supplementary information within the timeframe specified by the Authority shall result in enforcement actions set forth in Article 41 or Article 42 of this Regulation. Page 7 of 49 Quality of Service Regulation Publication of Quality of Service Information Reported by Licensed Operators Article 16. The Authority shall, from time to time, publish on its website or in any other manner or format it considers appropriate a Quality of Service report, by using all or part of the Measurements submitted by Licensed Operators pursuant to this Regulation. Article 17. The Quality of Service report published by the Authority shall contain: (1) the definition of each Parameter in a manner that is simple and easy to understand by End Users; (2) the achieved Measurement for each Parameter that is submitted by each Licensed Operator; (3) the manner of publication of the information; (4) the timing of publication of the information; (5) an indication of any Reference Value, if applicable,

---

for each Parameter; (6) an indication of any Target for each Parameter that Licensed Operators should achieve, if applicable; (7) any explanatory remarks from any Licensed Operator that have previously been accepted and approved by the Authority; and (8) any other remarks that are regarded as appropriate by the Authority. Article 18. In approving explanatory remarks by a Licensed Operator, the factors that the Authority may take into account include, but are not limited to, the following: (1) any service deficiencies that arise partly or wholly from the Telecommunications Services of another Licensed Operator, or another operator licenced to provide services in other countries that may contribute to the Telecommunications Service which is subject to the Quality of Service Measurement; (2) any changes in environmental or operating conditions that could not have been reasonably foreseen by the Licensed Operator; and (3) any expectations about Quality of Service that are appropriate to the tariffs for the Telecommunication Services of the Licensed Operator. Article 19. The Authority may use numbers of End Users submitted by Licensed Operators and Measurements that are reported under Article 9 of this Regulation, for publication of information pursuant to Article 54 of the Telecommunications Law. Page 8 of 49 Quality of Service Regulation Article 20. Notwithstanding any enforcement actions set forth in accordance with Articles 40 - Article 47 of this Regulation, in the event that one or more Licensed Operators fails to report timely, complete or accurate information to the Authority relating to one or more reportable Parameters, the Authority may: (1) publish Quality of Service reports referred to in this Article omitting the information that has not been reported on a timely, complete or accurate manner; and (2) indicate in such reports that one or more specific Licensed Operators has failed to report Quality of Service information on a timely, complete or accurate manner on one or more reportable Parameters. Article 21. Licensed Operators shall provide a link on their websites to the Quality of Service reports published by the Authority in accordance with this Article. Such link shall: (1) be identified as “Quality of Service Information”; and (2) be prominently displayed on the bottom of the Licensed Operator´s home page with the same font type and size as other items on that section of the website. Chapter 4 Measurement of Quality of Service by the Authority Article 22. The Authority may, directly or through a qualified third party, conduct Measurements of: (1) Parameters identified in Articles 4, 5 and 6 of Schedule 1; and (2) such other Parameters that, from time to time, the Authority considers relevant to assess the Quality of Service of Telecommunications Services in the Kingdom of Bahrain. Article 23. Provided that the testing methodology has not substantially changed from the previous Reporting Period, prior to conducting Measurements in accordance with this Article the Authority shall: (1) inform Licensed Operators whose Telecommunications Services will be measured on the testing methodology to be employed, and (2) consider any comments such Licensed Operators may submit on the matter. Article 24. The Authority shall, from time to time, publish the results of some or all of the Measurements conducted in accordance with this Article on its website or in any other Page 9 of 49 Quality of Service Regulation format it considers appropriate in a manner consistent with the requirements set forth pursuant to Article 17 of this Regulation. Article 25. With regard to Measurements conducted, the Authority may: (1) require Licensed Operators to submit, within the timeframe specified by the Authority, accurate supplementary information, documents and explanatory remarks; and (2) inspect and examine any documents, information, databases, registries, Telecommunications Equipment, Telecommunications Facilities and other facilities. Article 26. In t h e event that any Measurements obtained by the Authority differ from information reported or submitted for the same Parameter and Monitored Service for the same Reporting Period by a Licensed Operator, the Authority shall publish in its Quality of Service report the Measurements conducted by itself or through a qualified third party. Target Setting Article 27. If the Authority determines that adequate Quality of Service levels are not being provided to End Users, the Authority may set binding Targets for Parameters of Monitored Services for all Licensed Operators, or individual Licensed Operators. Article 28. In assessing whether Targets are warranted, the Authority shall take into account, at least, the following factors: (1) international benchmarks to compare Quality of Service levels for a specific Parameter or Parameters in the Kingdom of Bahrain with representative countries as determined by the Authority; (2) the Reference Values established by the Authority; (3) Quality of Service performance trends in the Kingdom of Bahrain for at least the previous calendar year; (4) the relative Quality of Service levels of the Licensed Operators providing the Monitored Service; or (5) the likelihood, based on the Authority’s technical judgement, that voluntary corrective measures implemented by Licensed Operators will be insufficient to deliver adequate Quality of Service levels for End Users. Page 10 of 49 Quality of Service Regulation Article 29. Targets set in accordance with this Article shall be: (1) established in a determination issued by the Authority in accordance with the Telecommunications Law and enter into effect three (3) months after publication of such determination; (2) achieved by Licensed Operators within a specified period of time as the Authority may establish in its determination; (3) reviewed, amended or modified by the Authority from time to time; and (4) removed where the Authority is satisfied that a Target is no longer warranted. Article 30. Notwithstanding the provisions above, the Authority may impose Targets on an individual Licensed Operator in respect to Parameters of Monitored Services for which such Licensed Operator fails to submit timely, complete or accurate Quality of Service Measurements in accordance to this Regulation, provided, however, that such failure occurs in any two (2) Reporting Periods within four (4) consecutive Reporting Periods. Article 31. Failure to achieve a Target set by the Authority will be a material breach and will

---

be subject to enforcement actions in accordance with this Regulation. Reference Values Article 32. The Authority may use Reference Values to assess whether End Users are being provided adequate levels of Quality of Service in accordance with this Regulation. The Authority may, from time to time, revise the Reference Values established in Schedule 5 to this Regulation; or add Reference Values for additional Parameters not included in Schedule 5 to this Regulation by issuing a reasoned determination justifying the proposed changes. Article 33. In setting Reference Values, the Authority shall take into account, at least, the following factors: (1) international benchmarks to compare Quality of Service levels for a specific Parameter or Parameters in the Kingdom of Bahrain with representative countries as determined by the Authority; (2) Quality of Service performance trends in the Kingdom of Bahrain for at least the previous calendar year; or (3) the relative Quality of Service levels of the Licensed Operators providing the Monitored Service. Page 11 of 49 Quality of Service Regulation Outage Notifications Article 34. Licensed Operators shall notify the Authority when an Outage affecting their Telecommunications Network or Telecommunications Service occurs according to the reporting requirements set forth in this Article. The following categories of Outages shall be notified to the Authority: (1) critical Outages are those affecting: a. emergency services, or b. the entire Telecommunications Network, including the Core Network, such that thirty (30) percent or more of the traffic or End Users of the Licensed Operator are affected; (2) major Outages are those affecting a Telecommunications Network or Telecommunications Service impacting less than thirty (30) percent of traffic or End Users of the Licensed Operator; and (3) Minor Outages are those affecting individual sites and/or components of the access network that do not interrupt the Telecommunications Services and exceed twelve (12) hours. Article 35. Licensed Operators shall submit a Network Outage Report to the Authority within: (1) two (2) hours of a critical Outage; and (2) twenty four (24) hours of a major Outage. Article 36. Licensed Operators shall submit a Network Outage Follow-Up Report within two (2) working days after a critical Outage or a major Outage is resolved and the network or service is restored. Article 37. The Network Outage Report and Network Outage Follow-Up Report shall be filed using the forms included in Schedules 3 and 4 to this Regulation. While Licensed Operators shall notify the Authority of all minor Outages for a Reporting Period in the Quality of Service Measurement report set forth in this Regulation. Article 38. Licensed Operators shall notify End Users affected by a critical Outage or a major Outage as soon as reasonably practicable, but no later than six (6) hours after the Licensed Operator becomes aware of the Outage. Such notification shall be made using the most effective and reliable means available to the Licensed Operator at the time. Page 12 of 49 Quality of Service Regulation Maintenance Notifications Article 39. A Licensed Operator shall provide at least forty eight (48) hours prior notice before conducting Maintenance on its Telecommunications Network that will result or is likely to result in a Telecommunications Service being interrupted for End Users. The notification shall be made to: (1) the Authority by submitting a Network Maintenance Report using the form provided in Schedule 3; and (2) the End Users likely to be affected by the Maintenance using the most effective and reliable means available to the Licensed Operator. Enforcement of Quality of Service reporting requirements Article 40. In the event that a Licensed Operator is found to have failed to submit a Quality of Service report within the time frame specified by the Authority, the Authority may apply one or more of the following enforcement actions: (1) a one-time fine of no less than BHD 120 and no more than BHD 600 per Reporting Period; (2) a daily fine of BHD 50 for each working day of delay in submitting the Quality of Service report up to a maximum of twenty (20) working days, starting on the first working day after the deadline set forth in Article 9(2) of this Regulation; (3) The obligation for the Licensed Operator to publish a half page notice prominently displayed in two (2) local newspapers, Arabic and English, informing the general public of the breach; and/or a notice in the “Quality of Service Information” link referred to in Article 21 of this Regulation informing the general public of the breach. The notices shall: a. state that the Licensed Operator failed to submit a Quality of Service report in a timely manner; b. identify the specific Parameters and Monitored Service for which the Licensed Operator failed to submit timely Measurements to the Authority; c. identify the Reporting Period in question; d. establish the reasons for not reporting Quality of Service information in a timely manner; e. be published within five (5) working days from the day the Authority published its Quality of Service report for the Reporting Period in question in accordance with Article 16 of this Regulation, unless otherwise determined by the Authority; and f. the notice shall remain on the Licensed Operator’s website for a period of time equivalent to the subsequent Reporting Period. Page 13 of 49 Quality of Service Regulation (4) a warning that the Authority may set individual Targets for specific Parameters in accordance with Article 30 of this Regulation. Article 41. In the event that a Licensed Operator is found to have failed to submit complete supplementary information within the time frame specified by the Authority, the Authority may apply one or more of the following enforcement actions: (1) a one-time fine of no less than BHD 15 and no more than BHD 75 per reportable Parameter for which the Licensed Operator has submitted incomplete information within a Reporting Period; (2) a daily fine of BHD 50 for each working day of delay in submitting a complete Quality of Service report up to a maximum of twenty (20) working days, starting on the first

---

working day after the deadline set forth in Article 9(2) of this Regulation; (3) the obligation for the Licensed Operator to publish a half page notice prominently displayed in two (2) local newspapers, Arabic and English, informing the general public of the breach; and/or a notice in the “Quality of Service Information” link referred to in Article 21 of this Regulation informing the general public of the breach. The notices shall: a. state that the Licensed Operator failed to submit a complete Quality of Service report in a timely manner; b. identify the specific Parameters and Monitored Services for which the Licensed Operator failed to submit complete Measurements to the Authority; c. identify the Reporting Period in question; d. establish the reasons for not reporting complete Quality of Service information in a timely manner; e. be published within five (5) working days from the day the Authority published its Quality of Service report for the Reporting Period in question in accordance with Article 16 of this Regulation, unless otherwise determined by the Authority. f. the notice shall remain on the Licensed Operator’s website for a period of time equivalent to the subsequent Reporting Period. (4) a warning that the Authority may set individual Targets for specific Parameters in accordance with Article 30 of this Regulation. Article 42. In the event that a Licensed Operator is found to have failed to submit accurate supplementary information within the time frame specified by the Authority, the Authority may apply one or more of the following enforcement actions: (1) a one-time fine of no less than BHD 1,000 and no more than BHD 5,000 per reportable Parameter for which the Licensed Operator has submitted inaccurate information within a Reporting Period; (2) the obligation for the Licensed Operator to publish a half page notice prominently displayed in two (2) local newspapers, Arabic and English, informing the general Page 14 of 49 Quality of Service Regulation public of the breach; and/or a notice in the “Quality of Service Information” link referred to in Article 21 of this Regulation informing the general public of the breach. The notices shall: a. state that the Licensed Operator failed to submit an accurate Quality of Service report in a timely manner; b. identify the specific Parameters and Monitored Services for which the Licensed Operator failed to submit accurate Measurements to the Authority; c. identify the Reporting Period in question; d. establish the reasons for not reporting accurate Quality of Service information in a timely manner; e. be published within the timeframe determined by the Authority; and f. the notice shall remain on the Licensed Operator’s website for a period of time equivalent to the subsequent Reporting Period. (3) A warning that the Authority may set individual Targets for specific Parameters in accordance with Article 30 of this Regulation. Article 43. In the event that a Licensed Operator is found to have failed to maintain the Measurements and any information, observations and calculation used in making the Measurements, the Authority may apply one or more of the following enforcement actions: (1) a one-time fine of no less than BHD 1,000 and no more than BHD 5,000 per reportable Parameter for which the Licensed Operator has failed to maintain Measurements and any information, observations and calculation used in making the Measurements; (2) the obligation for the Licensed Operator to publish a half-page notice prominently displayed in two (2) local newspapers, Arabic and English, informing the general public of the breach. Such notice shall: a. state that the Licensed Operator failed to maintain relevant Quality of Service information; b. identify the specific Parameters and Monitored Services for which the Licensed Operator failed to maintain relevant Quality of Service information; c. identify the Reporting Period in question; d. establish the reasons for not maintaining the relevant Quality of Service information in the manner required in accordance with this Regulation; and e. be published within the timeframe determined by the Authority. (3) a requirement that the Licensed Operator submit to the Authority for its review and approval a compliance plan detailing the processes to be implemented by the Licensed Operator to prevent a future breach of the obligation to maintain Measurements and any information, observations and calculation used in making the Measurements. Page 15 of 49 Quality of Service Regulation Article 44. Any action or omission that may, directly or indirectly, delay, hinder or impede the Authority´s ability to exercise its enforcement powers of this Regulation is a breach and may result in a one-time fine of no less than BHD 1,000 and no more than BHD 5,000 per occurrence. Article 45. In the event a Licensed Operator fails to comply with the obligations to publish newspaper notices, the Authority shall on behalf of the Licensed Operator in question, directly publish the relevant notice in the manner set Articles 40(3), 41(3), 42(2) and 43(2) of this Regulation, as applicable; and recover the cost of publication from the Licensed Operator with any interest that may accrue. Article 46. In the event a Licensed Operator fails to comply with the obligation of publishing information on its “Quality of Service Information” link, the Authority shall publish the relevant notice on its website. Article 47. Failure to provide information in accordance with Article 25(1) of this Regulation is a breach and may result in a one-time fine of no less than BHD 1,000 and no more than BHD 5,000 per occurrence, as determined by the Authority. Enforcement of Outage and Maintenance notifications and corrective measures Article 48. In the event that a Licensed Operators is found to have failed to submit the reports required in accordance with Article 35, Article36 or Article 39(1), the Authority may impose a one-time fine of no less than BHD 320 and no more than BHD 1,600 per occurrence. Article 49. The Authority may inspect and examine any documents, information, databases, registries, Telecommunications Equipment, Telecommunications Facilities and other facilities deemed relevant by the Authority to investigate any Outage. Based on its investigation and/or any

---

proposed corrective measures made by the Licensed Operator, the Authority may direct the Licensed Operator to take those corrective measures that it may deem necessary. Article 50. In the event that the Authority determines that the Licensed Operator failed to effectively implement the corrective measures included in the Network Outage Report or the Network Outage Follow-Up Report; or the corrective measures directed by the Authority in accordance with Article 49 of this Regulation, the Authority may treat such failure as a material breach of the Licensed Operator’s licenses and/or the provisions of the Telecommunications Law and Page 16 of 49 Quality of Service Regulation take any enforcement action it deems appropriate in accordance with Article 35 of the Telecommunications Law. Enforcement of Targets set by the Authority Article 51. Notwithstanding any enforcement action applicable, failure by a Licensed Operator to report timely, complete and accurate Quality of Service information relating to a specific reportable Parameter for which the Authority has set a Target shall be construed as such Licensed Operator having failed to meet the applicable Target for the reportable Parameter during the Reporting Period in question by five (5) units of deviation, unless proven otherwise by the Licensed Operator. Article 52. In the event that a Licensed Operator fails to meet a Target for a specific Parameter within the terms established in a determination issued by the Authority in accordance with Article 27 or Article 30 of this Regulation for one Reporting Period, the Authority shall require such Licensed Operator to submit, within thirty (30) calendar days, a compliance plan for the Authority´s review and approval consisting of corrective measures to be implemented by Licensed Operators to meet and maintain the Target in question. The Authority shall within thirty (30) calendar days from receipt of the compliance plan review such plan and may approve the plan as proposed by the Licensed Operator and publish a summary of the plan on its website that includes the key actions to be taken, the expected results and the deadlines for achieving such results; or make reasoned observations and require modifications to the proposed compliance plan. Article 53. If the Authority requires modifications to the proposed compliance plan; the Licensed Operator shall submit a revised compliance plan for review and approval by the Authority within ten (10) working days of receiving notice; and the Authority shall review the revised compliance plan within fifteen (15) working days from receiving it and may approve the revised compliance plan as submitted; or reject the revised compliance plan as submitted and issue a determination setting the compliance plan to be implemented by the Licensed Operator. Article 54. In the event a Licensed Operator fails to submit a compliance plan, or fails to submit a revised compliance plan compliant with the observations of the Authority; the Authority may treat such failure as a material breach and may take appropriate enforcement action according to Article 35 of the Telecommunications Law, or may impose: (i) a one-time fine of no less than BHD 1,000 and no more than BHD 5,000 per occurrence; (ii) a daily fine of BHD 250 for each working day of delay in submitting the compliance plan. Article 55. Page 17 of 49 Quality of Service Regulation In the event that, a Licensed Operator fails to meet a Target for a specific Parameter covered by such compliance plan for any two (2) Reporting Periods within four (4) consecutive Reporting Periods, the Authority may treat such failure as a material breach and may take any appropriate enforcement action according to Article 35 of the Telecommunications Law. Article 56. Failure to meet a Target in the terms provided in this Article may result in a fine of no less than BHD 200 and no more than BHD 1,000 per unit of deviation from the relevant Target in the last Reporting Period as set forth in the determination issued by the Authority in accordance with Article 27 or Article 30 of this Regulation. Unless determined otherwise by the Authority in its determination, units of deviation shall be calculated as follows: (i) For Targets set as a percentage, a unit of deviation shall be a value from 0.1 to 1 percentage points, rounded up to the nearest tenth of a percentage or percentage point, as determined by the Authority in its determination; (ii) For Targets set as a number of days, a unit of deviation shall be one (1) day, rounded up to two significant numerical figures ; (iii) For Targets set as a number of hours, a unit of deviation shall be one (1) hour, rounded up to two significant numerical figures ; (iv) For Targets set as a number of seconds, a unit of deviation shall be one (1) second, rounded up to two significant numerical figures; (v) For Targets set as a number of milliseconds, a unit of deviation shall be one (1) millisecond, rounded up to two significant numerical figures. (vi) For Targets set based on any other metric, the Authority shall determine the unit of deviation in the determination that sets the Target. Imposition of fines Article 57. If, following a determination that there has been a failure to comply with an obligation, the Authority orders the payment of a financial penalty in accordance with Section 35 of the Telecommunications Law, the penalty ranges set out in this Regulation may be used by the Authority to establish the baseline amount of the financial penalty in accordance with paragraph 46 of the Fining Guidelines. The baseline amount may then be adjusted upwards or downwards at the Authority's discretion in accordance with paragraphs 47 – 52 of the Fining Guidelines. Deadlines on holidays or weekends Article 58. When the date of a deadline set forth in this Regulation or its Schedules falls on a weekend or a holiday, such deadline shall be deemed automatically extended to the next working day. Page 18 of 49 Quality of Service Regulation Chapter 6 Final Guidelines Article 59. Licensed Operators shall: (i)

---

take all actions necessary to ensure that they are able to conduct the Measurements required in accordance with this Regulation; (ii) begin conducting Measurements in accordance with Article 7 of this Regulation immediately following the date this Regulation comes into force. Article 60. This Regulation shall enter into force ninety (90) calendar days after its publication in the official gazette. Page 19 of 49 Schedule 1: Quality of Service Parameters and Measurements Article 1. Scope of Schedule 1 This schedule identifies the grouping of Parameters that shall be measured in the Kingdom of Bahrain and provides a definition of each Parameter, its Measurement Method, applicable international standard and Measurement. Article 2. Grouping of Parameters For the purpose of this Regulation, the Authority shall monitor Quality of Service of Telecommunications Services based on the following four (4) groups of Parameters: (i) general Parameters: horizontal Parameters that apply independent of the service and access technology deployed by Licensed Operators. (ii) voice Parameters: apply to fixed and mobile voice services offered by Licensed Operators. (iii) mobile Parameters: apply only to mobile voice services offered by Licensed Operators. (iv) broadband Parameters: apply to fixed and mobile broadband services offered by Licensed Operators. Article 3. General Parameters Published Measurement and Parameter Measurement Method reference International Standards G- Supply time The Supply time initial connection is the duration from the instant of a valid service order being received from an End a) the times by which the 1 initial User to the instant a working service is made available by the Licensed Operator for use by the End User. This should fastest 95% and 99% of orders connection include cases where: are completed; and b) percentage of orders  a new access line is installed; completed by the date agreed with the customer. Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards  an existing access line is taken over by another customer;  an additional access line is provided to a customer who already has service, this includes an upgrade from ETSI EG 201 769 V1.1.2 (2000- PSTN to ISDN. 10) specifies “Supply time initial connection” in paragraph 5.1 The following statistics should be provided: ETSI ES 202 057-1 V2.1.1 (2013- a) the times by which the fastest 95% and 99% of orders are completed; and 01) also specifies “Supply time b) percentage of orders completed by the date agreed with the customer. for fixed network access” in The time should be measured in elapsed days (including all public holidays, etc.) paragraph 5.1, “Supply time for Internet access” in paragraph Licensed Operators may exclude from a) cases where delays to provision are requested by the end User. 5.2 Licensed Operators may exclude from "a" and "b" cases where essential access to End User premises is not provided by the End User on the agreed date and time. Formulas for calculation:  The provisioning time for each order i, G1i, is given by: 𝐺1𝑖 = 𝑡2𝑖 − 𝑡1𝑖 Where: t1i is the point of time when supply event for order i is ordered t2i is the point of time when supply event for order i actually occurs t2i – t1i is measured in elapsed days (including all public holidays etc.) i is equal to 1, 2, 3, … , N, where N is the total number of orders in the regulatory period Based in all N provisioning times, G1i, provide the time, G1(95%), by which the fastest 95 % of orders are completed. Page 21 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards Based in all N provisioning times, G1i, provide the time, G1(99%), by which the fastest 99 % of orders are completed.  The percentage of orders completed by the date agreed with the customer, G1, during the regulatory period, is given by: 𝑂𝐶 𝐺1𝐶 = × 100% 𝑂𝑇 Where: OC is the number of orders completed by the date agreed with the customer OT is the total number of orders G-2 Fault A fault report is a report of disrupted or degraded service that is made by an End User and is attributable to the Number of valid fault reports report rate network of the service Licensed Operator or any interconnected public network, and that is not found to be per access line per Reporting invalid. Faults in any equipment on the End User side of the network termination point are excluded. Period Network faults reported against either basic or primary rate access, or single or multi-line analogue access, should be counted as one fault, regardless of the number of channels activated or affected. The count of the number of ETSI EG 201 769 V1.1.2 (2000- access lines should be one for basic or primary rate access regardless of the number of channels activated. For 10) specifies “Fault rate” in indirect service provision the number of service registrations (CLI registrations or registered pin codes) should be paragraph 5.2. used instead of the number of access lines. ETSI ES 202 057-1 V2.1.1 (2013- The number of valid fault reports per access line per Reporting Period should be provided. 01) also specifies “Fault report This statistic should be calculated by dividing the number of valid fault reports observed during the Reporting rate per fixed access lines” in Period by the average number of access lines or service registrations in the network under consideration during paragraph 5.4 the same Reporting Period. The averaging is necessary because the number of access lines may vary during the reporting Period. Licensed Operators that cannot distinguish between: Page 22 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards  valid faults attributable to the network;  faults attributable to Customer Premise Equipment (CPE); or  invalid faults, may use the total number of reported faults. Fault reports should be assumed to be valid unless there is a specific reason to consider that they are invalid. Cases where an End User reports a fault

---

that is found to be cleared when tested should be counted as a valid report unless the Licensed Operator has reason to believe that the fault did not occur. A report that concerns more than one access line between End Users and the local exchange should be counted in terms of the number of fault reports received rather than the number of lines affected. However only one fault report should be included for each access line affected. Statistics should include all valid fault reports in the data collection period. Formulas for calculation:  The number of valid fault reports per access line Reporting Period, G2y, is given by: 𝐹𝑉 𝐺2𝑦 = 𝐴𝐿 Where: FV is the number of valid fault reports observed during the Reporting Period. For Licensed Operators that cannot distinguish between:  valid faults attributable to the network;  faults attributable to CPE; or  invalid faults, Page 23 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards FV may be equal to the total number of reported faults. AL is the average number of operational access lines or service registrations in the network under consideration during the same Reporting Period  The fault report rate, G2FR, is given by: 𝐹𝑉 𝐺2𝐹𝑅 = × 100% 𝐴𝐿 G-3 Fault repair The duration from the instant a fault has been notified by the End User (to the published point of contact of the a) the time by which the fastest time Licensed Operator) to the instant when the service element or service has been restored to normal working order. 80 % and 95 % of valid faults on access line are repaired The following statistics should be provided: (expressed in clock hours); a) the time by which the fastest 80 % and 95 % of valid faults on access line are repaired (expressed in clock hours); b) the time by which the fastest b) the time by which the fastest 80 % and 95 % of all other valid faults are repaired (expressed in clock hours); and 80 % and 95 % of all other valid c) the percentage of faults cleared any time stated as an objective by the service provider. faults are repaired (expressed For this Parameter every mobile number shall be considered a “mobile access line” in clock hours); and Formulas for calculation c) the percentage of faults cleared any time stated as an  The “fault repair time” for each fault i on an access line, G3ALi, is given by: objective by the service 𝐺3 provider. 𝐴𝐿𝑖 = 𝑡2𝐴𝐿𝑖 − 𝑡1𝐴𝐿𝑖 Where: t1ALi is the time when the request for repair event for fault i on an access line occurs ETSI EG 201 769 V1.1.2 (2000- 10) specifies “Fault repair time” t2ALi is the time when the service repair event for fault i on an access line actually occurs in paragraph 5.3 t2ALi – t1ALi is expressed in clock hours i is equal to 1, 2, 3, … , N, where N is the total number of faults on access lines during the regulatory period Page 24 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards Based in all N “fault repair times” on access lines, G3ALi, provide the time, G3AL(80%), by which the fastest 80 % ETSI ES 202 057-1 V2.1.1 (2013- of valid faults on access lines are repaired, expressed in clock hours. 01) also specifies “Fault repair Based in all N “fault repair times” on access lines, G3ALi, provide the time, G3AL(95%), by which the fastest 95 % time for fixed access lines” in of valid faults on access lines are repaired, expressed in clock hours. paragraph 5.5 Let TALo be the objective time expressed in clock hours established by the service provider to repair an access line fault. Based in all N faults on access lines, provide the percentage of faults, G3AL%, for which G3ALi ≤ TALo, that is: 𝑁𝐴𝐿𝑜 𝐺3𝐴𝐿% = × 100% 𝑁 Where: NALo is the total number of faults for which for which G3ALi ≤ TALo Repeat the above procedure but for all other valid faults, different from faults on access lines, i.e., obtain G3AOj, G3AO(80%), G3AO(95%), and G3AO%, where j is equal to 1, 2, 3, …, M, and M is the total number of all other valid faults, different from faults on access lines. G-4 Response The duration from the instant when the address information required for setting up a call is received by the network a) mean time to answer; and time for call (e.g. recognized on the calling user's access line) to the instant the human operator answers the calling End User to b) percentage of calls answered centre provide the service requested. Services provided wholly automatically, e.g. by voice response systems, are excluded. within 20 seconds. service The services covered are the general call centre services excluding directory enquiries which are covered under Parameter G-5: Response time for directory enquiry services. The period in this definition includes waiting times because operators are busy, and times for going through voice Based on ETSI EG 201 769 response systems to reach the operator. However it excludes the handling of the call by the operator, e.g. V1.1.2 (2000-10) specifies conversation with the operator. The reasons are that the variety of calls to operators is too wide and that it is too “Response times for operator difficult/costly in practice to measure the operator's performance precisely. services” in paragraph 5.6 The following statistics should be provided: Page 25 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards a) mean time to answer; and Based on ETSI ES 202 057-1 V2.1.1 (2013-01) also specifies b) percentage of calls answered within 20 seconds. “Response times for operator Statistics should either: services” in paragraph 5.6  include all calls to call centre services in the Reporting Period; or  be based on a representative sample, in which case the number of observations should

---

be provided. Formulas for calculation  The response time for a human operator to answer call i, G4i, is given by: 𝐺4𝑖 = 𝑡2𝑖 − 𝑡1𝑖 Where: t1i is the point of time when setting up a call i t2i is the point of time when the call i actually reaches a human operator t2i – t1i is expressed in seconds i is equal to 1, 2, 3, … , N, where N is the total number of calls to a human operator during the regulatory period. In case statistics are based on a representative sample, the number of observations, ?̂?, should be provided (?̂? replaces N)  The mean time for a human operator to answer, G4, is given by: ∑𝑁 𝑖=1 𝐺4𝑖 𝐺4 = 𝑁  The percentage of calls answered within 20 seconds, G4(20), is given by: Page 26 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards 𝑁20 𝐺4(20) = × 100% 𝑁 Where: N20 is the number of calls to a human operator for which G4i ≤ 20 seconds G-5 27. Response The duration from the instant when the address information required for setting up a call is received by the network a) mean time to answer; and times for (e.g. recognized on the calling End User's access line) to the instant the human operator or an equivalent voice- b) percentage of calls answered directory activated response system answers the calling End User to provide the number information requested. within 20 seconds. enquiry The period in this definition includes waiting times because attendants are busy, and times for going through services voice response systems to reach the point where the enquiry can be handled. However it excludes the handling of the enquiry itself, e.g. conversation with the attendant and the response of any database used by the ETSI EG 201 769 V1.1.2 (2000- attendant. The reasons are that the variety of enquiries is too wide and that it is too difficult/costly in practice to 10) specifies “Response times measure when the answer is given. for directory services” in paragraph 5.7 The following statistics should be provided: ETSI ES 202 057-1 V2.1.1 (2013- a) mean time to answer; and 01) also specifies “Response b) percentage of calls answered within 20 seconds. times for directory services” in paragraph 5.7 Statistics should either:  include all calls to directory enquiry services in the Reporting Period; or  be based on a representative sample, in which case the number of observations should be provided. Formulas for calculation  The response time for a human operator or an equivalent voice-activated response system to answer directory enquiry i, G5i, is given by: Page 27 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards 𝐺5𝑖 = 𝑡2𝑖 − 𝑡1𝑖 Where: t1i is the time when the request for directory enquiry i occurs t2i is the time when the service directory enquiry i actually occurs t2i – t1i is expressed in seconds i is equal to 1, 2, 3, … , N, where N is the total number directory enquiries during the regulatory period. In case the following statistics are based on a representative sample, the number of observations, ?̂?, should be provided (?̂? replaces N)  The mean time for a human operator or an equivalent voice-activated response system to answer, G5, is given by: ∑𝑁 𝑖=1 𝐺5𝑖 𝐺5 = 𝑁  The percentage of calls answered within 20 seconds, G5(20), is given by: 𝑁20 𝐺5(20) = × 100% 𝑁 Where: N20 is the number of directory enquiries to a human operator or an equivalent voice-activated response system for which G5i ≤ 20 seconds G-6 Billing The proportion of bills resulting in an End User complaining about the correctness of a given bill. Percentage of bills resulting in correctness an End User complaint A bill correctness complaint is an expression of dissatisfaction with the accuracy of a bill received from an End complaints User. ETSI EG 201 769 V1.1.2 (2000- rate 10) specifies “Billing Page 28 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards The percentage of bills resulting in an End User complaint should be provided. correctness complaints” in Statistics should include all billing complaints received in the Reporting Period, regardless of the validity of the paragraph 5.9 complaint and the dates of calls (or any other channels of complaints) or any other occurrences that are the ETSI ES 202 057-1 V2.1.1 (2013- subject of the complaint. 01) also specifies “Bill Formula for calculation correctness complaints” in paragraph 5.11  The percentage of bills resulting in an End User complaint, G6, is given by: 𝐵𝐶 𝐺6 = × 100% 𝐵𝑇 Where: BC is the total number of billing complaints BT is the total number of bills G-7 28. Availability Probability that “core” network services are available for an End User. Core Network availability refers to network Time the “core” network is of the Core availability excluding local unavailability of a network due to access network unavailability. available as a percentage of Network Any Outage time classified as a critical Outage in accordance with Article 10.2(a)(ii) of this Regulation shall be total time in the Reporting considered as unavailability time towards the network availability of the Core Network. Period. The Core Network availability is measured as the percentage of time the Core Network is available within a Reporting Period. ETSI ES 202 765-4 V1.2.1 (2014- Formula for calculation 05) specifies “Availability” for a  The percentage availability of the Core Network, G8, is given by: specific case, Internet Access, in paragraph 6.1. 𝐻𝐴 𝐺8 = × 100% ETSI TS 102 250-2 V2.5.1 (2016- 𝐻𝑇 06) specifies “Radio Network Where: Unavailability” for the specific Page 29 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards HA is the total hours of availability of the Core Network case of radio access networks, H in paragraph 5.1 T is the

---

total hours during the reporting Period ETSI TS 102 250-1 V2.2.1 (2011- 04) specifies “unavailability” in paragraph 8.1 Page 30 of 49 Quality of Service Regulation Article 4. Voice Parameters Published Measurement and Parameter Measurement Method reference International Standards V-1 29. Call set-u3p0. The ratio of successful calls to the total number of call attempts in a Reporting Period. Percentage of successful call success rate set-ups in a Reporting Period An unsuccessful call is a call attempt to a valid number where neither called party busy tone, nor ringing tone, nor answer signal, is recognized on the access line of the calling End User within 30 seconds from the instant when the address information required for setting up a call is received by the network. ETSI EG 201 769 V1.1.2 (2000- 10) specifies “Unsuccessful Call The following statistics should be provided separately for each Reporting Period: Ratio” in paragraph 5.4 a) the percentage of successful calls for national calls; ETSI EG 202 057-2 V1.3.2 b) the percentage of successful calls for international calls; (2011-04) specifies c) the total number of calls performed for each value. “Unsuccessful Call Ratio” in The statistics should be calculated from: paragraph 5.1 a) measurements on all real traffic; or b) measurements on real traffic for outgoing calls in a representative population of local exchanges to a representative set of destinations; or c) test calls in a representative population of local exchanges or Network Termination Points (NTPs) to a representative set of destinations; or d) a combination of the above. Formulas for calculation  The percentage of successful calls, national or international, V1i, is given by: 𝑆𝐶𝑖 𝑉1𝑖 = ( ) × 100% 𝑇𝐶𝑖 Where: Page 31 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards Sci is the total number of successful calls TCi is the total number of calls set-ups i is equal to 1 for national calls and 2 for international calls The total number of calls for i = 1 (national calls), N1, and for i = 2 (international calls), N2, should be provided. 31. V3-2. Call set-u3p3. The duration from the instant when the address information required for setting up a call is received by th3e4. a) the mean value in seconds for 2 time network ( e.g. recognized on the calling End User's access line) and the instant when the called party busy tone or national calls; ringing tone or answer signal is received by the calling End User (e.g. recognized on the calling End User's access b) the time in seconds within line). which the fastest 95 % of The following statistics should be provided separately for each Reporting Period: national calls are set-up; a) the mean value in seconds for national calls; c) the mean value in seconds b) the time in seconds within which the fastest 95 % of national calls are set-up; for international calls; c) the mean value in seconds for international calls; d) the time in seconds within which the fastest 95 % of d) the time in seconds within which the fastest 95 % of international calls are set-up; international calls are set-up; e) the number of calls performed for national and international calls in the Reporting Period. Calls that are classified as unsuccessful calls should be excluded. ETSI EG 201 769 V1.1.2 (2000- Formulas for calculation 10) specifies “Call Set-up Time”  The call set-up time for call i, V2ji, is given by: in paragraph 5.5 𝑉2𝑗𝑖 = 𝑡2𝑗𝑖 − 𝑡1𝑗𝑖 ETSI EG 202 057-2 V1.3.2 (2011-04) specifies “Call Set-up Where: Time” in paragraph 5.2 t1i is the instant when the address information required for setting up a call i is received by the network Page 32 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards t2i is the instant when the called party busy tone or ringing tone or answer signal is received by the calling party, for call i t2i – t1i is expressed in seconds j is equal to 1 for national calls, and to 2 for international calls i is equal to 1, 2, 3, … , Nj, where N1 is the total number of national calls and N2 is the total number of international calls during the Reporting Period. Calls that are classified as unsuccessful calls should be excluded.  The mean value in seconds for national calls, j = 1, and international calls, j = 2, 𝑉̅̅̅̅2̅ 𝑗, is given by: 𝑁 ∑ 𝑗 𝑉2𝑗 𝑉̅̅̅̅2̅ 𝑗 = 𝑖=1 𝑖 𝑁𝑗 Based on all Nj call set-up times, V2ji, provide the time, V2j(95%), i.e., for national and international calls separately, by which the fastest 95 % calls are set-up. Provide the number of observations performed, Nj, i.e., for national and international calls separately. Calls that are classified as unsuccessful calls should be excluded. 35. V3-6. Voice 37. Represents the intrinsic quality of speech signal after transmission. This Parameter takes into account th3e9. Mean Opinion Score [0 , 5] per 3 quality degradations generated on the signal by the transmission links. network, exceeded for 90% of the measurements 38. Measurements must be performed for each fixed and mobile network separately using a method which is suitable for todays and tomorrows voice services, including wideband audio, HD Voice, VoLTE, W-AMR, EVS, etc. ETSI ES 202 765-2 V1.2.1 (2014- 05) paragraph 7.11 specifies The following statistic should be provided for each Reporting Period: “Listening speech quality” a) Mean Opinion Score [0 , 5] per network, exceeded for 90% of the measurements ITU-T P.863 Page 33 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards ETSI EG 202 057-2 V1.3.2 (2011-04) specifies “Speech connection quality” in paragraph 5.3 40. V4-1. Speech 42. The end-to-end delay is the delay from mouth to ear, which means the transmission delay over the whole a) the mean value in 4 delay transmission path. For the purpose of this Regulation, end-to-end delay does not take into account

---

the transducers milliseconds for national calls delay (loudspeaker and microphone) while measurements are done at the electrical interfaces of the end b) the mean value in terminals. milliseconds for international calls The following statistics should be provided separately: ETSI ES 202 765-2 V1.2.1 (2014- a) the mean value in milliseconds for national calls 05) paragraph 7.13 specifies b) the mean value in milliseconds for international calls “End-to-end delay” Formula for calculation ITU-T G.114 specifies “One-  The mean value in milliseconds for national calls, j = 1, and international calls, j = 2, V4j, is given by: way transmission time” 𝑁 ∑ 𝑗 𝑡 𝑉4 𝑖=1 𝑗𝑖 𝑗 = 𝑁𝑗 Where: i is equal to 1, 2, 3, … , Nj, where N1 is the total number of observations for national calls and N2 is the total number of observations for international tji is the end-to-end time delay in milliseconds from mouth to ear, not including transducers delay, for national (j = 1) call i, or international (j = 2) call i Page 34 of 49 Quality of Service Regulation Article 5. Mobile Parameters Published Measurement and Parameter Measurement Method reference International Standards M-143. Dropped ca4l4l . The proportion of incoming and outgoing calls which, once they have been correctly established and therefore have The percentage of dropped calls rate an assigned traffic channel, are dropped or interrupted prior to their normal completion by the End User, the cause ETSI EG 202 057-3 V1.1.1 of the early termination being within the Licensed Operator's network. (2005-04) chapter 6.4.2 Measurements should reflect accurately traffic variations over the hours of a day, the days of the week and the specifies “Dropped Call Ratio” months of the year. When conducting Measurements based on network element counters, the Measurement must be made via an automatic data collection system, based on the network counters which register the real traffic of the network. The network counters collect information for 24 hours a day, every day of the year. The following statistics should be provided: The percentage of dropped calls, calculated from all the calls in the Reporting Period Formulas for calculation  The percentage of dropped calls, M1, calculated from all the calls in the Reporting Period, is given by: 𝐶𝐷 𝑀1 = × 100% 𝐶𝑇 Where: CD is the total number of dropped calls CT is the total number of calls  When using test calls, the percentage of dropped calls, M1, is given by: 𝐶𝐷𝑇 𝑀1 = × 100% 𝐶𝑇𝐶 Page 35 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards Where: CDT is the total number of dropped calls from the group of test calls CTC is the total number of test calls used For both calculation approaches presented above, the measurements must provide a relative accuracy greater than 10 % with a level of reliability of 95 %. M-2 45. Coverage 46. Network coverage is defined as the specific signal level indication at which the mobile device can log in to the Percentage of population network and initiate a call and/or data session. covered for each mobile network technology 47. The following minimum thresholds shall be used to determine network coverage  GSM: Received Signal Strength Indicator (RSSI) > -95 dBm  3G/HSPA+: Received Signal Code Power (RSCP) > -105 dBm  LTE: Reference Signal Received Power (RSRP) > -115 dBm. An additional 15-20 margin can be used for indoor coverage for all technologies since there is no technology dependency. The following statistics should be provided: a) Percentage of population covered for each mobile network technology M-3 48. SMS The ratio of correctly sent and received short messages (SMS) between two terminal equipment. Ratio of successfully sent and completion The following statistics should be provided: received short messages rate a) The ratio of successfully sent and received short messages, together with the number of test samples used ETSI EG 202 057-2 V1.3.2 and, (2011-04) chapter 5.6.1 b) The absolute accuracy limits for 95 % confidence calculated from this number. The statistics should be calculated from: Page 36 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards a) measurements on real traffic for SMS; or specifies “Successful SMS b) measurements on real traffic for SMS in a representative population of the Network Termination Points and Ratio” the Service Access Points (NTPs/SAPs); or c) test calls in a representative population of NTPs/SAPs; or d) a combination of the above. Guidance on the choice of adequate origin and destination NTPs/SAPs may be found in annex G of the ETSI EG 202 057-2 V1.3.2 standard Measurements should be scheduled so as to reflect accurately traffic variations over the hours of a day, the days of the week and the months of the year. SMS monitoring can be done by monitoring every Kth SMS where K is to be calculated from the total expected number of SMS sent in the relevant time intervals and from the needed number of observations. Formula for calculation  The percentage of SMS completion rate, M3, is given by: 𝐶𝑆𝑀𝑆 𝑀3 = × 100% 𝑇𝑆𝑀𝑆 Where: CSMS is the total number of completed SMS messages TSMS is the total number of SMS messages Provide the absolute accuracy limits for 95 % confidence. Page 37 of 49 Quality of Service Regulation Article 6. Broadband Parameters Published Measurement and Parameter Measurement Method reference International Standards B-14 9. Throughput50. The data transmission speed is defined as the data transmission rate that is achieved separately for downloading and Mean value for uplink and uploading specified test files between a remote web site and a user's computer. downlink per commercial plan measured The following statistic should be provided separately for download and upload direction: a) The highest 95 % of the data transmission rate in kbit/s achieved. ETSI EG 202 057-4 V1.2.1 (2008- b) The lowest 5 % of the data transmission rate in kbit/s achieved. 07) chapter 5.2 specifies “Data c) The mean value and

---

standard deviation of the data transmission rate in kbit/s. transmission speed achieved” The data transmission rate is calculated by dividing the size of the test file by the transmission time required for a complete and error-free transmission. The transmission time is the time period starting when the access network has received the necessary information to start the transmission and ending when the last bit of the test file has been received. Formula for calculation  The data transmission rate in kbit/s for test i, B1i, is given by: 𝑆𝑖 𝐵1𝑖 = 𝑡𝑖 Where: Si is the size in of the test file for test i ti is the transmission time required for a complete and error-free transmission (is the time period starting when the access network has received the necessary information to start the transmission and ending when the last bit of the test file has been received. Page 38 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards B-25 1. Latency 52. Refers to the round trip time required for a packet to travel from a source to a destination and back. It is used to a) mean value for local latency measure the delay on a network at a given time. in milliseconds b) mean value for international The procedure to take a round-trip measurement is then as follows: latency in milliseconds  The destination host is prepared to reply to test packets sent from the source host.  The source host constructs an identified test packet, and stores any information necessary to calculate a ETSI EG 202 765-3 V1.1.2 (2010- round-trip time from the packet's identification information. The test packet may have additional payload or 07) specifies in chapter 4.2 header fields in order to simulate the properties of real traffic. “Round Trip Delay”  The source host sends the test packet to the destination host. ETSI TS 102 250-2 V2.5.1 (2016- 06) specifies in chapter 6.3 the  The destination host receives the test packet. PING Round Trip Delay  The destination host constructs a test reply packet containing the identification information back to the source host. The test reply packet may have additional payload or header fields in order to simulate the properties of real traffic. The delay here should be minimized; if it is known, it may be transmitted back to the source host, possibly in line with the reply packet, in order to allow the destination host processing delay to be taken into account in the round trip measurement.  The destination host sends the test reply packet back to the source host.  The source host receives the test reply packet from the destination host. If the source host does not receive a test reply packet in a reasonable amount of time, the packet is considered lost, and the round-trip delay is considered undefined.  The source host calculates a round-trip delay from the received test reply packet and any stored information linked to the test packet's identifying information. The source host calculates the delay by subtracting the time Page 39 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards at which the source host sent the test packet from the time at which the source host received the test reply, if possible adjusted for processing delay at the source and destination hosts. Formula for calculation  The mean value for local and international latency in milliseconds, B2j, is given by: 𝑁 ∑ 𝑗 𝑇 𝐵2 𝑖=1 𝑗𝑖 𝑗 = 𝑁𝑗 Where: j = 1 for local latency and j = 2 for international latency i is equal to 1, 2, 3, …, Nj, and N1 is the total number of local latency measurements, and N2 is the total number of international latency measurements Tij is the end-to-end time delay in milliseconds (ping round trip latency time) for measurement i given by: 𝑇 𝑃𝑅 𝑗𝑖 = 𝑡𝑗 − 𝑡𝑃𝑆 𝑖 𝑗𝑖 Where: 𝑡𝑃𝑅 𝑗𝑖 is the time when a packet is received for Measurement i and local or international latency, j = 1 or j = 2 respectively (see above trigger points) 𝑡𝑃𝑆 𝑗𝑖 is the time when packet is sent for Measurement i and local or international latency, j = 1 or j = 2 respectively (see above trigger points) B-35 3. Web pag5e4. Duration between the instant the download request of the Web page is sent by the End User to the host server and Mean time in milisecond for loading time the instant when the Web page download is correctly completed. Web page loading Formula for calculation Page 40 of 49 Quality of Service Regulation Published Measurement and Parameter Measurement Method reference International Standards  The mean value for Webpage loading time B4, is given by: ETSI ES 202 765-4 V1.2.1 (2014- 05) specifies the Web Page ∑𝑁 𝑖=1 𝑊𝑒𝑏 𝑝𝑎𝑔𝑒 𝐿𝑜𝑎𝑑𝑖𝑛𝑔 𝑇𝑖𝑚𝑒𝑖 𝐵4 = Download Speed, measured in 𝑁 ms (time) Where: ETSI TS 103 256 V1.1.1 (2014- Web page Loading Timei is the end-to-end time delay in milliseconds, for web page loading time measurement 10) describes a “standard” web i page for comparative web page i is equal to 1, 2, 3, …, N, and N is the total number of web page loading time measurements loading time tests. Page 41 of 49 Schedule 2: Monitored Services and Quality of Service Reporting Requirements 1. The following table provides the Reporting Period for each Parameter and Monitored Service: Parameter Monitored Service Reporting Period General Parameters G-1 Supply time for initial connection Fixed Voice Service Quarterly Mobile Service Internet Service New fixed (copper) line New fixed (fiber) lines G-2 Fault report rate Fixed Voice Service Quarterly Mobile Service Internet Service G-3 Fault repair time Fixed Voice Service Quarterly Mobile Service Internet Service G-4 Response time for call centre Operator call centre Quarterly services G-5 Response time for directory Directory service Quarterly services G-6 Billing correctness complaints Fixed Voice Service Quarterly rate Mobile Service Internet Service G-7 Availability

---

of the “core” network Fixed Voice Service Quarterly Mobile Service Internet Service Voice Parameters V-1 Call set-up success rate Voice Service (Fixed and Quarterly Mobile) V-2 Call set-up time Voice Service (Fixed and Quarterly Mobile) V-3 Voice quality Voice Service (Fixed and Quarterly Mobile) V-4 Speech delay Voice Service (Fixed and Quarterly Mobile) Quality of Service Regulation Mobile Parameters M-1 Dropped call rate Voice Service (Mobile) Yearly M-2 Coverage Voice Service (Mobile) Yearly M-3 Completion rate for SMS Voice Service (Mobile) Yearly Broadband Parameters B-1 Throughput Internet Service Quarterly B-2 Latency Internet Service Quarterly B-3 Web page loading time Internet Service Quarterly 2. Quarterly Reporting Periods over which Measurements are made, shall be three (3) consecutive months, starting on: 1 January, 1 April, 1 July, and 1 October of the Gregorian calendar each year. 3. Yearly Reporting Periods over which Measurements are made shall be determined by the Authority from time to time. Page 43 of 49 Schedule 3 Network Maintenance/Outage Report Form NETWORK MAINTENANCE AND OUTAGE REPORT CONTACT INFORMATION Name of Reporting Entity: Primary Contact Person: Email: Phone Number: MAINTENANCE/OUTAGE INFORMATION Type of outage: ☐Emergency Services outage ☐Critical ☐ Major ☐Planned Maintenance Timing of the Outage Date of Outage: Local Time Outage Began: Local Time Outage Resolved: Outage Duration: If not resolved, expected time service(s) to be resolved: Timing of Planned Maintenance Date of Maintenance: Local Time Maintenance to Begin: Local Time Maintenance to End: Maintenance Duration: Description of Maintenance/Outage Service(s) affected: Area(s) affected: Network Element(s) affected: Percent of traffic affected: Percent of End Users affected: Ability for End Users to access emergency service(s) during the activity: ☐Yes ☐No Does the outage involve a security issue?: ☐Yes ☐No If resolved, proposed corrective measures to be implemented (for critical and major outages): Certification I certify that I am authorized by the Reporting Entity, that I have examined this Report and that I affirm that the information contained herein is true, complete, and accurate to the best of my knowledge. Signature: Printed Name: Date: Quality of Service Regulation Schedule 4: Network Maintenance/Outage Follow-Up Report NETWORK MAINTENANCE AND OUTAGE REPORT CONTACT INFORMATION Name of Reporting Entity: Primary Contact Person: Email: Phone Number: MAINTENANCE/OUTAGE INFORMATION Type of outage: ☐Emergency Services outage ☐Critical ☐ Major ☐Planned Maintenance Timing of the Outage Date of Outage: Local Time Outage Began: Local Time Outage Resolved: Outage Duration: Does the outage involve a security issue?: ☐Yes ☐No Follow-Up Details on the Outage (including greater detail on network element(s), traffic, and End Users affected): Corrective Measures Implemented (or to be Implemented): Certification I certify that I am authorized by the Reporting Entity, that I have examined this Report and that I affirm that the information contained herein is true, complete, and accurate to the best of my knowledge. Signature: Printed Name: Date: Page 45 of 49 Quality of Service Regulation Schedule 5: Reference Values Parameter Monitored service Reference Value Existing lines: < 5 days target for the 95% ; <10 days for the 99% Fixed Voice Services (PSTN, New lines: < 30 days for 95% where network is VoIP) available within 100 mts of the premise; < 60 days for 99% Mobile Services 2 hours for 95% (Voice/VoLTE/Broadband) Fiber: < 30 days for 95% where network is Supply time available within 100 mts of the premise; < 60 days G-1 for initial Fixed Line (fiber) for 99% connection Fixed Line (copper) Copper: < 30 days for 95% where network is available within 100 mts of the premise; < 60 days for 99% Existing lines: < 5 days target for the 95% ; <10 days for the 99% Internet services (DSL, FTTH, New lines: < 30 days for 95% where network is Fixed Wireless) available within 100 mts of the premise; < 60 days for 99% Fixed Voice Services (PSTN, < 24 hours for 80% VoIP) < 48 hours for 95% Fault repair Mobile Services < 24 hours for 80% G-3 time (Voice/VoLTE/Broadband) < 48 hours for 95% Internet services (DSL, FTTH, < 24 hours for 80% Fixed Wireless) < 48 hours for 95% Fixed Voice Services (PSTN, 99.90% Network VoIP) availability of Mobile Services G-7 99.90% the “core” (Voice/VoLTE/Broadband) network Internet services (DSL, FTTH, 99.90% Fixed Wireless) Call Set-Up Voice Services (PSTN, VoIP, V-1 Fixed > 99%; Mobile > 98% Success Rate Mobile Voice, VoLTE) Fixed: mean < 5 seconds; 95% fastest < 7 seconds Call set-up Voice Services (PSTN, VoIP, V-2 Mobile: mean < 8 seconds; 95% fastest < 10 time Mobile Voice, VoLTE) seconds Voice Services (PSTN, VoIP, Fixed MOS > 3.75 for 90% of measurements; V-3 Voice Quality Mobile Voice, VoLTE) Mobile MOS > 3.5 for 90% of measurements Voice Services (PSTN, VoIP, National < 150 ms V-4 Speech Delay Mobile Voice, VoLTE) International < 200 ms (Europe); < 300 ms (US) Dropped call Mobile Services (Mobile Voice, M-1 < 1% rate VoLTE) Completion M-3 Mobile Services (SMS) > 99% Rate for SMS Internet services (DSL, FTTH, B-1 Throughput Mobile Broadband, Fixed Within the advertised typical throughput Wireless) Page 46 of 49 Quality of Service Regulation Internet services (DSL, FTTH, Fixed National < 50 ms; Fixed international <200 ms B-2 Latency Mobile Broadband, Fixed (Europe), <300 ms (US); Mobile < 100 ms Wireless) Internet services (DSL, FTTH, Web page B-3 Mobile Broadband, Fixed Fixed < 3 seconds; Mobile < 3 seconds loading time Wireless) Page 47 of 49 Quality of Service Regulation Schedule 6: Summary of fine ranges Breach Fine Failure to submit a Quality of Service  One-time fine of BHD 120 to BHD 600 per report within the time frame specified Reporting Period; and by the Authority in accordance with Article 10 of this Regulation.  A daily fine of BHD 50 for each working day of delay in submitting the Quality of Service report up to a maximum of twenty (20) working days. Failure to submit complete  One-time fine of BHD 15 to BHD 75 per supplementary information within the reportable Parameter for which the Licensed time frame specified by the Authority

---

in Operator has submitted incomplete accordance with Article 15 (1). information within a Reporting Period; and  A daily fine of BHD 50 for each working day of delay in submitting the Quality of Service report up to a maximum of twenty (20) working days. Failure to submit accurate  One-time fine of BHD 1,000 to BHD 5,000 per supplementary information within the reportable Parameter for which the Licensed time frame specified by the Authority in Operator has submitted inaccurate accordance with Article 15 (1) of this information within a Reporting Period. Regulation. Failure to maintain the Measurements  One-time fine of BHD 1,000 to BHD 5,000 per and any information, observations and reportable Parameter. calculation used in making the Measurements in accordance with Article 9(4) of this Regulation. Any action or omission that may,  One-time fine of BHD 1,000 to BHD 5,000 per directly or indirectly, delay, hinder or occurrence. impede the Authority´s ability to exercise its enforcement powers in accordance with Article 15 (2) or Article 25 (2) of this Regulation. Failure to provide information in  One-time fine of BHD 1,000 to BHD 5,000 per accordance with Article 25(1) of this occurrence. Regulation. Failure to submit the  One-time fine of BHD 320 to BHD 1,600 per outage/maintenance reports required occurrence. in accordance with Article 35, Article 36 or Article 39(1). Failure to submit a compliance plan in  A one-time fine of no less than BHD 1,000 and accordance with Article 52 of this no more than BHD 5,000 per occurrence; Regulation; or  A daily fine of BHD 250 for each working day of delay in submitting the compliance plan. Page 48 of 49 Quality of Service Regulation Failures to submit a revised compliance plan compliant with the observations of the Authority. Failure to meet Targets for Parameters  A fine of BHD 200 to BHD 1,000 per unit of set by the Authority. deviation from the Target in the last Reporting Period. Page 49 of 49 National Numbering Plan Approved by Regulation 18 of 2015 of the Telecommunications Regulatory Authority Purpose: To provide a framework for the allocation of numbers in the national telecommunications system to competing service providers. National Numbering Plan Table of Contents 1 Introduction ....................................................................................................... 3 2 Definitions ......................................................................................................... 4 3 The National Numbering Plan .......................................................................... 7 3.1 Numbers ....................................................................................................... 7 3.2 Short Codes ................................................................................................ 10 4 The National Numbering Plan Principles ........................................................ 11 4.1 Introduction ................................................................................................. 11 4.2 Principle 1. Rights and responsibilities ........................................................ 11 4.3 Principle 2. Applying for numbers ................................................................ 12 4.4 Principle 3. Reserving numbers ................................................................. 13 4.5 Principle 4. Considering applications .......................................................... 14 4.6 Principle 5. Conditions placed on allocations .............................................. 16 4.7 Principle 6. Re-allocating and withdrawing numbers ................................... 18 4.8 Principle 7. Notification of number allocation and activation of numbers ..... 19 4.9 Principle 8. National Numbering Plan records ............................................. 20 4.10 Publication of changes ................................................................................ 20 4.11 Status indicators .......................................................................................... 20 4.12 Principle 9. The review procedure ............................................................... 21 4.13 Principle 10. Numbering fees ...................................................................... 21 5 Schedules ....................................................................................................... 23 6 Principles for other codes ............................................................................... 34 Appendix 1. Licensed Operator’s Numbering Report Template ............................ 35 Appendix 2. Numbering Application Information (via NMS) .................................. 36 Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 2 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 1 Introduction Legislative Decree No. 48 of 2002 promulgated the Telecommunications Law of the Kingdom of Bahrain (“Telecommunications Law”). This Law established the Telecommunications Regulatory Authority (“TRA”) which has responsibility for the regulation of the telecommunications sector in the Kingdom of Bahrain. Section 3 (c) 12 of the Telecommunications Law assigns to TRA the duty of preparing and maintaining the National Numbering Plan (“Plan”) and allocating numbers to Licensed Operators in accordance with that Plan. This document details the Plan for the national telecommunications infrastructure, so that competing operators can configure their networks with confidence. The Plan is applicable to all appropriately Licensed Operators using or wishing to make use of the national resource of numbers, including the use of numbers for messaging (such as SMS). The Plan and its processes and structures are mandatory on all such operators. It should be noted that numbers/short codes have a dual role and can be used in parallel for call orientated services (such as voice) and for messaging services. For standard mobile services, these dual uses are routed and interconnected between networks in a similar fashion and the distinction in use is not important. However, for short code use such as for premium rate services, this distinction is important. For example, voice calls to a premium rate short code are treated as an off-net service and are all routed through to the same network for termination, while SMSs sent to the same premium rate short code are treated as an on-net service and are terminated on the same network from which they originate. Therefore, separate allocations are needed for these short codes to cover their dual use. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 3 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 2 Definitions Any word, phrase or expression used in this Plan shall, unless the context requires otherwise or it is expressly defined herein, have the same meaning as in the Telecommunications Law of the Kingdom of Bahrain. “Access Number” means a Short Code, used to access services of another operator or certain other services of the same operator. “Allocated” means a status of a number or a Number Block that has been assigned to an operator for a particular purpose. If a number has been ported to another operator, the operator to which a number has been ported assumes all the responsibilities and rights under this Plan of the operator to which a number has been allocated. “Call” means communication conveying voice and/or data, and includes where appropriate messaging services (such as SMS). “Closed Numbering Scheme” means a numbering system in which all national numbers are used of the same length irrespective of which national geographic

---

area they are dialled from. “Country code” (“CC”) means the combination of one, two or three digits that identifies a specific country or countries in an integrated numbering plan or a specific geographic area. The CC for the Kingdom of Bahrain is 973. “Designated” means the use of a number series or range of numbers specified for a particular purpose. Designated numbers shall be used only for a purpose specified in the Plan. “Fixed Services” means Telecommunications services other than Mobile Services. Designation of numbers for Fixed Services allows usage of such numbers for any services (including Mobile Services) provided that the wholesale rate for termination of voice calls, if applicable, to users of such services does not exceed by more than 20 per cent the wholesale rate for termination of voice calls to users of Fixed Services (such as PSTN) of the biggest (in terms of number of subscribers) provider of such services in the Kingdom of Bahrain. Designation of a Number Range to Fixed Services does not allow direct use of such numbers for provision of Premium Rate Services or Special Services. “Free” is a status of a number or a Number Block that is available for allocation. “GSM” means the Global System for Mobile communications. “International Prefix” means a digit or combination of digits added before the called number to indicate that the call is an international one. In the Kingdom of Bahrain, the International Prefix is 00. “ITU Telecommunications Standardisation Sector” (“ITU-T”) is a permanent organ of the International Telecommunications Union (“ITU”), the United Nation's specialised agency in the field of telecommunications. The ITU-T is responsible for studying technical, operating and tariff questions and issuing Recommendations on them with a view to standardising telecommunications on a world-wide basis. “Licensee’s Numbering Plan” means a plan that a Licensed Operator adopts for such numbers as are allocated to it from the Plan. Such a plan describes the Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 4 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan method adopted, or to be adopted, for allocating and reallocating a number to any network termination point, subscriber, telecommunications apparatus or service element. “LTE” means Long Term Evolution and supports both frequency division duplexing (FDD) and time-division duplexing (TDD). “Mobile Services” means Telecommunications services typically provided to a mobile terminal (i.e. a terminal which can be used while the user is on the move, without being restricted to an area served by one base station). Designation of numbers for mobile services shall not preclude using such numbers for other services provided that the wholesale rate for termination of voice calls and the wholesale rate for termination of SMS messages, if applicable, to users of such services does not exceed by more than 20 per cent the wholesale rate for termination of such services to users of Mobile Services (such as GSM/UMTS/LTE (FDD)) of the same Licensed Operator or, if such Licensed Operator does not provide Mobile Services, to users of the biggest (in terms of number of subscribers) provider of such services in the Kingdom of Bahrain. Designation of a number range to Mobile Services does not allow direct use of such numbers for the provision of Premium Rate Services or Special Services. “National Destination Code” (“NDC”) means a digit or a combination of digits (not including any prefix) identifying a numbering area within a country (or group of countries included in one integrated numbering plan or a specific geographic area) and/or network/service. NDC is a nationally optional code field, within the international public telecommunications numbering plan as set out in the ITU-T Recommendation E.164, which, combined with the SN, constitutes the NSN. In the Kingdom of Bahrain, NDC is not used. “National Rate” means an indication that the price for the call is equivalent to the rate for a fixed national call set by the relevant originating operator. “National Significant Number” (“NSN”) is the portion of a number that follows the CC. The NSN usually consists of the NDC followed by the SN. In the Kingdom of Bahrain the NSN is identical with the SN. “NMS” means the Numbering Management System that is used by TRA to manage numbering processes and numbering interactions with operators. “Number” means a string of decimal digits that uniquely identifies a subscriber or a point where a service is provided. Any identifier, use of which may conflict with use of any number, shall be used in accordance with the Plan and any other regulations of TRA. “Number Block” means a sequence of contiguous numbers with the same leading digits used as the basis for allocating numbers to operators. In this Plan a Number Block consists of 1,000 or 10,000 numbers as identified in the Plan for a specific Number Range, except in cases where the Plan explicitly states that numbers are assigned individually (in such cases a Number Block is equal to 1 number). “Numbering Plan List” (“Number List”) means the list of numbers published by TRA on its website and updated on a regular basis in order to provide information on the current status of parts of the Plan, e.g. Allocated, Free, Protected or Reserved. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 5 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan “Number Range” means a set of contiguous numbers of a specified or unspecified size. “Number Series” means a set of numbers, having the same leading digit or digits. “Ported Number” means a number that has been allocated to a particular operator, but has subsequently been ported to another operator according to the laws, rules and regulations governing Number Portability. “Premium Rate Services” (“PRS”) means services that are used via Telecommunications services and are paid for through the telephone bill of a calling subscriber, and the rate of which is typically higher than the rate applied to calls to subscribers of Mobile Services and Fixed Services. Revenues from Premium Rate Services are typically shared between an operator providing such services and a called subscriber

---

(i.e. the subscriber to whom the respective number is assigned). “Principle” means a rule or requirement that governs the use, management and allocation of the national resource of numbers from the Plan. “Protected” is the status of a number or a Number Block that is withheld from allocation and use. “PSTN” means a Public Switched Telephone Network. “Reserved” is the status of a number or a Number Block that has been reserved for future allocation to an operator. “Schedules” are those sections of this document that detail the designations of numbers and other conditions of use specific to the Plan. “Short Code” means a short number (i.e. a number not longer than 5 digits). “SMS” means Short Message Service. SMS services can be provided independently of a mobile service. “Special Services” means telephone services charged at special rates (with respect to callers) - from free up to, and including, National Rate. Charges for these calls can be paid by the called party, shared between the caller and the called party, or paid wholly by the caller. “Subscriber Number” (“SN”) means a number identifying a subscriber in a network or numbering area. “UMTS” means the Universal Mobile Telecommunications System. “Universal Number” means a number which can be used for any purpose except for Special Services and Premium Rate Services. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 6 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 3 The National Numbering Plan 3.1 Numbers 3.1.1 The Plan makes use of a Closed Numbering Scheme based on 8-digit NSN length (except for Short Codes, which are explicitly identified as such). Figure 1 shows the broad structure of the Plan and Figure 2 a more detailed view. Leading Main Purpose (the Purpose for parts which are not identified Digit as Protected in this table is detailed in the Schedules of the Plan below) 0 Access Numbers, Off-Net and On-Net Short Codes 1 Numbers for Fixed Services, Emergency and Safety Services and Off-Net Short Codes 2 Protected 3 Mobile Service Numbers 4 Protected 5 Protected 6 Universal Numbers 7 Universal Numbers 8 Special Services Numbers 9 Premium Rate Services Numbers and Emergency and Safety Services Short Codes Figure 1. Numbering Plan Structure Leading Subrange Purpose Digit 0 00 International access 01 Off-Net 5-digit Short Codes On-Net 5-digit messaging (SMS) Short Codes 02 Carrier Pre-Selection 03-05 Protected 06 On-Net 5-digit Short Codes On-Net 5-digit messaging (SMS) Short Codes 07 Off-Net 5-digit Short Codes Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 7 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan On-Net 5-digit messaging (SMS) Short Codes 08-09 Protected 1 10 Off-Net 3-digit Short Codes On-Net 3-digit messaging (SMS) Short Codes 11 112 - Emergency and Safety 3-digit Short Code Remainder – Protected 12 Off-Net 3-digit Short Codes On-Net 3-digit messaging (SMS) Short Codes 13 Fixed Service Numbers 14-15 140, 141 & 151: Off-Net 3-digit Short Codes On-Net 3-digit messaging (SMS) Short Codes Remainder - Protected 16-17 Fixed Service Numbers 18-19 199 - Emergency and Safety 3-digit Short Code 181, 188, 191 & 196: Off-Net 3-digit Short Codes On-Net 3-digit messaging (SMS) Short Codes Remainder - Protected 2 Protected 3 Mobile Service Numbers (30 and 385 are protected) 4 Protected 5 Protected 6 Universal Service Numbers (60 is protected) 7 Universal Service Numbers (70 is protected) 8 80 No charge to caller (8-digits) 81 No charge to caller: Off-Net 5-digit Short Codes On-Net 5-digit messaging (SMS) Short Codes 82-83 Protected 84 Cost shared between caller and called party (8- Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 8 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan digits) 85 Cost shared between caller and called: Off-Net 5-digit Short Codes On-Net 5-digit messaging (SMS) Short Codes 86 Protected 87 Cost born by caller (8-digits) 88 Cost born by caller: Off-Net 5-digit Short Codes On-Net 5-digit messaging (SMS) Short Codes 89 Protected 9 90 Low band (8-digits) 91 Low band: Off-Net 5-digit Short Codes On-Net 5-digit messaging (SMS) Short Codes 92-93 Protected 94 Medium band: Off-Net 5-digit Short Codes On-Net 5-digit messaging (SMS) Short Codes 95 Medium band (8-digits) 96 Protected 97 High band (8-digits) 98 High band: Off-Net 5-digit Short Codes On-Net 5-digit messaging (SMS) Short Codes 99 Emergency and Safety 3-digit Short Codes (991, 993, 995-997) Figure 2. Numbering Plan Detail Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 9 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 3.2 Short Codes 3.2.1 Short Codes are subsets of the number scheme and consist of variations to the full 8-digit number to allow short dialling sequences. Where designated, Short Codes may be used for messaging services such as SMS. Short Codes are designated as one of the following categories: 3.2.1.1 Access Numbers used to access services of other operators (using specific Access Numbers allocated to these operators) or certain other services of the same operator. 3.2.1.2 Emergency and Safety Services Short Codes are designated for use as emergency and safety related service Short Codes. The Short Code is allocated against a service (not associated with any Licensed Operator). Callers must be able to call such a code at any time from any network without charge. Operators are able to obtain information necessary for proper routing of the calls to these numbers from the Ministry of Interior. 3.2.1.3 Off-Net Short Codes are designated for use as Short Codes, accessible from any network. Licensed Operators are required to hold the relevant Off-Net Short Code numbering allocation in order to terminate services on Off-net Short Codes. All Licensed Operators shall ensure accessibility of these Short Codes from their networks. 3.2.1.4 On-Net Short Codes are designated for use as Short Codes for the purpose of accessing services that terminate on the same network. Licensed Operators are required to hold the relevant On-Net Short Code numbering allocation in order to use On-Net Short Codes. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 10 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 4 The National Numbering Plan Principles 4.1 Introduction 4.1.1

---

The Plan is governed by a number of Principles that are outlined in this section. These Principles apply universally to all aspects of the Plan and generally describe the administrative mechanisms whereby the Plan can be executed. In addition to the Principles, a set of Schedules attached to this document defines the Plan in relation to specific numbers. 4.1.2 The Principles govern the specifications and the application of the Plan and the Licensees' Numbering Plans. An operator which has allocated numbers shall have its own Numbering Plan, which complies with these Principles. Each Licensed Operator with allocated numbers is required to submit its Numbering Plan to TRA, and to report to TRA on a regular basis (quarterly) the status of its usage of numbers. 4.1.3 TRA will publish information on the National Numbering Plan and the current usage of numbers on its website at www.tra.org.bh. 4.2 Principle 1. Rights and responsibilities 4.2.1 TRA’s guiding principles: 4.2.1.1 TRA is responsible for developing and managing the Plan and issuing the Principles. Numbers are a national resource and the following guidelines will be taken into account by TRA when allocating, reserving and managing numbers: 4.2.1.1.1 TRA will manage the Plan in such a way as to ensure that there are sufficient numbers available to meet all reasonable demands that subscribers and Licensed Operators might have. This includes ensuring that Licensed Operators use allocated numbers efficiently. 4.2.1.1.2 The Plan will, where applicable, be compatible with relevant international agreements, standards and recommendations. 4.2.1.1.3 The Plan will, wherever possible, seek to ensure that numbers of different types give a broad indication of service type and/or tariff so that users can be aware of the service type they are using and the likely charge for it. 4.2.1.1.4 TRA will ensure that costs or inconvenience to subscribers, users and Licensed Operators are objectively justified, and kept to the minimum consistent with meeting demands for numbers and sound management of the Plan. 4.2.1.1.5 TRA will allocate or reserve numbers in a fair and equitable manner, normally to the first operator that requests the respective numbers (i.e. on a 'first-come-first-served' basis). TRA will only allocate or reserve Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 11 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan numbering capacity to operators who meet the eligibility criteria set out in Principle 2 (Section 4.3). 4.2.1.1.6 TRA will take into account the need to anticipate growth in demand for telecommunications services as well as development of innovative services. In particular, the utilisation of previous numbering allocations will be taken into account when considering new requests for numbers. 4.2.2 Operators' responsibilities 4.2.2.1 Operators who have received allocations of numbers shall publish their own Numbering Plan, detailing the use of allocated numbers in accordance with the Principles, and shall submit their Numbering Plan to TRA annually by 31 January. 4.2.2.2 Operators who have received allocations of numbers shall update the TRA through the NMS regarding changes in number status and customer information within 24 hours of having updated the information in their own systems. Details of the information to be provided is specified in the NMS Manual as published by the TRA. 4.3 Principle 2. Applying for numbers 4.3.1 Criteria for the eligibility of applicants for number allocations and reservations 4.3.1.1 Only holders of individual licences are eligible to apply for allocations and reservations of numbering capacity. 4.3.1.2 To be eligible for an allocation of numbering capacity, the applicant shall have met (or be reasonably expected to meet within the next 6 months) an 80% utilisation of existing allocations for the same service type for number ranges that are allocated in blocks, and 100% for the same service type for numbers that are allocated individually. 4.3.1.3 Utilisation shall be calculated according to the following formula (where numbers are considered to be in quarantine for the period specified in paragraph 4.6.1.1.7): Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 12 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 4.3.2 Information to be supplied by an applicant for a number allocation and/or reservation 4.3.2.1 When applying for an allocation or reservation of numbering capacity, the applicant shall provide the following information to TRA through the NMS: 4.3.2.1.1 Name and contact details of the applicant. 4.3.2.1.2 Details of their current utilisation of existing allocations for the same service type and their expected numbering demand for the same service type over the next 6 months. 4.3.2.1.3 Any other information that the applicant considers necessary or appropriate to justify the application. 4.3.2.2 In addition, applicants shall provide to TRA any other information, judged by TRA to be relevant to the application. This may include a brief description of the applicant's technical and operational system configuration. 4.3.3 Timing of applications 4.3.3.1 Applications for numbering allocations should not, in general, be made more than six months prior to the planned in-service date. 4.4 Principle 3. Reserving numbers 4.4.1 Making reservations 4.4.1.1 In addition to allocating numbering capacity, TRA may, at its discretion, agree to reserve it. Reservations may be appropriate under the following circumstances: 4.4.1.1.1 to extend a previously allocated range; 4.4.1.1.2 where an applicant does not wish to be identified; 4.4.1.1.3 where the reason for the application should not be divulged prior to an application for the allocation. 4.4.1.2 A reservation may be made against a specific request submitted by any person eligible to receive allocations (for example, for the expansion or growth of existing services or for the introduction of new services). 4.4.1.3 An application for a reservation shall be made to TRA in accordance with Principle 2. Applications for reservations will be made public in the same way as allocations, unless the applicant requests otherwise and TRA agrees that the request for confidentiality is reasonable. 4.4.2 Limitations Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 13 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 4.4.2.1 Wherever possible, TRA will endeavour to convert a reservation into an allocation upon request. However, it should be noted that a reservation does

---

not automatically entitle an applicant to activate the capacity. Nor, where numbering capacity is reserved, is there any guarantee that a corresponding allocation will subsequently be made. 4.4.2.2 Reservations will be time-limited and the limit for reservations will normally be three months. 4.4.2.3 Reservations may be renewable on request to TRA, at TRA’s discretion. Reservations must be converted into allocations before numbers can be activated. 4.4.3 Cancellation 4.4.3.1 Once a reservation has been made, that numbering capacity will be unavailable for allocation, except for the purpose and to the operator for which the reservation was made. However, a reservation will automatically be cancelled if: 4.4.3.1.1 the time limit has expired; 4.4.3.1.2 the applicant withdraws the reservation; or 4.4.3.1.3 TRA and the applicant agree a substitute reservation or allocation. 4.4.4 Competing requests 4.4.4.1 Where available number ranges are limited, and several operators have requested the same Number Block, TRA may reserve the block for more than one operator, but will allocate it to the first operator who submits to TRA a request for final allocation of the numbers, together with clear and reasonable plans for making use of the respective numbers. In these circumstances, TRA will inform each of the competing operators that their reservation is subject to competition. 4.5 Principle 4. Considering applications 4.5.1 When making number allocations or reservations within the Plan, TRA will take into account: 4.5.1.1 the guiding principles set out in Principle 1; 4.5.1.2 the provisions of the relevant licence of the operator; 4.5.1.3 the views of the applicant and other interested parties (through consultation, where appropriate); 4.5.1.4 whether the applicant has met (or be reasonably expected to meet within the next 6 months) an 80% utilisation of existing allocations for the same Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 14 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan service type for number ranges that are allocated in blocks, and 100% for the same service type for numbers that are allocated individually; 4.5.1.5 any other matters that TRA deems relevant (e.g. any requirement to open a new range or make changes to the Plan in order to allocate the required numbers); 4.5.1.6 new number ranges or changes to the Plan; and 4.5.1.7 the financial status of the Licensee with the TRA and whether any overdue fee is to be settled. 4.5.2 Before opening any protected ranges, TRA will specify a date for initial receipt of applications for those ranges and, prior to that date, no applications will be accepted. 4.5.3 TRA will notify the ITU Standardization Sector (ITU-T) of changes to the Plan in order to ensure that correct notification is given to foreign operators, administrations and other interested parties. Where TRA considers it necessary, it will also notify other overseas administrations directly. 4.5.4 Number portability 4.5.4.1 TRA will take into account how the applicant intends to provide portability for relevant numbers when considering applications. Applicants are expected to comply with TRA’s Regulation on Number Portability and current Number Portability Specifications. 4.5.5 Timescale for handling applications for numbering capacity 4.5.5.1 TRA will use all reasonable endeavours to make an allocation or reservation in accordance with the Principles, in response to applications for numbering capacity, within a period of 28 calendar days following receipt of an application that contains all of the information required by Principle 2. The 28 calendar day period may be exceeded where: 4.5.5.1.1 additional information is required from the applicant; 4.5.5.1.2 a period of consultation is necessary, as initiated by TRA; 4.5.5.1.3 there are significant issues relating to the application that cannot be reasonably handled within that period; 4.5.5.1.4 TRA considers that an alternative period of time is justified. 4.5.5.2 Where TRA considers that an exception to the normal period is required, then it will inform the applicant in writing or through the NMS of its reasons and of the revised period. 4.5.6 Refusal of applications for numbering capacity Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 15 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 4.5.6.1 TRA reserves the right to refuse applications for allocations of numbers to any operator that is not in compliance with the Plan, its Principles and/or Schedules. This includes operators not being in arrears with the numbering fees as set out in Principle 10. 4.5.6.2 TRA may at its discretion refuse an application for an allocation or reservation of numbering capacity. Alternatively, TRA may grant the application not in full, or may attach specific conditions to the allocation which are consistent with the Principles and/or Schedules and relate to the use and management of the numbering capacity allocated. Such specific conditions will be set out in the record in the NMS. 4.5.6.3 In the event of a refusal, whether in part or in full, or where specific conditions are attached, TRA will inform the applicant through the NMS of its reasons. 4.5.6.4 TRA may, following consultation with the applicant, make an alternative allocation that has the potential to satisfy the applicant's requirements without conflicting with the criteria that caused the original application to be refused. 4.5.6.5 Where TRA refuses an application, either in part or in full, or attaches specific conditions to the allocation, the applicant may write to the General Director of TRA disputing the reasons given by TRA for its decision or giving further information for consideration regarding the application. The General Director of TRA will then consider the request and respond to the applicant within 28 calendar days, except where a different period of time is justified. 4.5.7 Allocation of numbers in response to an application 4.5.7.1 Once TRA has made a decision to allocate a range of numbers to an operator for a specific purpose, it will create an allocation record in the NMS. The operator may not make any use of the requested allocation of numbers until it has received notification through the NMS that the allocation record has been created. 4.6 Principle 5. Conditions placed on allocations 4.6.1 General conditions 4.6.1.1 In addition to any specific conditions that

---

may apply (see Principle 4, Section 4.5), the following general conditions relating to the use and management of numbering capacity apply to all allocations made by TRA: 4.6.1.1.1 the allocation shall be used for the purpose specified in the application (e.g. including any classification by type or tariff as set out in the Plan); 4.6.1.1.2 the Licensee originally allocated numbers shall be responsible for them. This includes ensuring that the appropriate information regarding the use of these numbers is reported to TRA. This does not prevent that Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 16 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan recipient from sub-allocating numbers to other licensed operators, provided that the sub-allocation is still for the use specified in the original application and in accordance with the Principles; 4.6.1.1.3 the holder of the allocation shall maintain a record of the numbers in use and the related customer information and update the TRA through the NMS within 24 hours of any changes; 4.6.1.1.4 the holder of the allocation shall maintain a record of Ported Numbers; 4.6.1.1.5 an operator shall not use numbers from the Plan other than those allocated by TRA and for which the operator has valid allocation record in the NMS (see Principle 4); 4.6.1.1.6 Licensed Operators shall use numbers allocated in compliance with number format and length as specified in this Plan. This includes the use of numbers for messaging services such as SMS. Shortening of numbers is not allowed; 4.6.1.1.7 Licensed Operators shall place a number in quarantine for a period of time when a number that has been in use is cancelled by the customer, or is recovered or replaced by the Licensed Operator, and during this period the number shall not be re-assigned to any customer other than the previous customer. For mobile services (including mobile services using Universal Service numbers), this period shall be three months, while for other services the period shall be six months; 4.6.1.1.8 Licensed Operators with allocated numbers, including Licensed Operators with sub-allocations, shall not prevent or delay connection to those numbers, whether on their network or the network of other Licensed Operators. 4.6.2 Conditional allocations 4.6.2.1 TRA may allocate numbers to an operator on the condition that they will be used exclusively for traffic to and from a specified third party. In addition, the numbers may be allocated on the condition that they shall be capable of being transferred to that third party if, in due course, that third party becomes eligible to receive allocations of codes in its own right by satisfying the eligibility criteria in Principle 2. 4.6.3 Changes to allocations 4.6.3.1 Those who have been allocated numbering capacity are required to apply to TRA to make any changes: 4.6.3.1.1 to the allocation of the numbers; 4.6.3.1.2 to the purpose or use of the numbering allocation; or 4.6.3.1.3 which relate to conditions of use placed on the allocation. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 17 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 4.6.3.2 Changes related to Number Portability are covered through the Number Portability Regulation and processes. 4.6.4 The audit process 4.6.4.1 Each holder of an allocation shall submit to TRA its quarterly numbering report. The Licensed Operator’s quarterly numbering report shall refer to information at the calendar quarter end and shall be submitted to TRA within two weeks of the end of that quarter. 4.6.4.2 The following information shall be provided in the Licensed Operator’s quarterly numbering report (through the NMS) for each allocation: 4.6.4.2.1 the current use of the allocation; 4.6.4.2.2 numbers assigned to subscribers (in-service); 4.6.4.2.3 details of numbers set aside for planned growth, customer orders or other usage, with explanations; 4.6.4.2.4 Number Blocks allocated to any person for purposes other than end use; and 4.6.4.2.5 the proportion of numbers ported, at the request of subscribers, to another operator, including those ported before allocation to a specific subscriber. 4.6.4.3 Each Licensed Operator’s annual numbering report shall also provide: 4.6.4.3.1 a one year and a three-year estimate of demand within significant ranges (TRA may specify these in a more detailed manner); 4.6.4.3.2 any other information requested by TRA. 4.6.4.4 This information shall be supplied in a format specified by TRA (see Appendix 1) and reported through the NMS. 4.7 Principle 6. Re-allocating and withdrawing numbers 4.7.1 Reallocation 4.7.1.1 If a substantial proportion of numbers from an allocation has been transferred (e.g. sub-allocated or ported) to another operator, TRA may, with the agreement of the operators concerned, re-allocate the Number Block to the operator who has most users in the block. TRA will re-allocate Number Blocks only when it has received the written consent of both the existing and the intended new operator. In these circumstances the original Allocation Certificate will be withdrawn and a new one issued to the new holder of the allocation. 4.7.2 Withdrawal Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 18 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 4.7.2.1 TRA may withdraw capacity that it has allocated, or part of such capacity, if its continued use or allocation is not in compliance with: 4.7.2.1.1 the Plan, including the Principles and/or Schedules; 4.7.2.1.2 any specific conditions of the allocation; or 4.7.2.1.3 it is no longer required. 4.7.2.2 Licensed Operators may request TRA to withdraw a numbering range that has been allocated to that operator. Licensed Operators may only request a numbering range allocation to be withdrawn in the same size numbering block as which numbers of that type are allocated and only if the Licensed Operator currently has no active nor quarantined numbers in the number block they request to be withdrawn. 4.7.2.3 Where a Licensed Operator holds an allocation for a numbering range for which they currently have no active nor quarantined numbers in the numbering range, but there are numbers that are ported out of this range and held by one or more other Licensed Operators, instead of withdrawing this numbering range, the TRA will work with the operators

---

to instead reallocate this range according to Clause 4.7.1.1. 4.7.2.4 Withdrawal of an in-service numbering range, which has been allocated by TRA, can be made only after TRA has consulted with interested parties for a period of not less than 28 calendar days. It will be subject to a period of notice of not less than three months following that consultation. 4.7.2.5 If an allocation or part of an allocation is not brought into service within six months, it may be withdrawn after consultation with interested parties. 4.8 Principle 7. Notification of number allocation and activation of numbers 4.8.1.1 TRA will via publication on its website (and, if TRA at its own discretion considers necessary, via other appropriate means) inform other Licensed Operators in the Kingdom of Bahrain, and, if necessary, other relevant authorities, including ITU-T, of the new number allocation. Other Licensed Operators, interconnected with the operator which has been allocated new numbers, shall ensure activation of these numbers in their networks and, if applicable, transit of the traffic to these numbers through their networks as soon as possible. If the activation takes more than one month from the date of publication of the relevant information on TRA’s website or from the date of receiving a direct request to activate numbers (whichever is the earliest), the activating operator shall before the expiration of that period inform TRA accordingly and provide justification for a specific activation period. 4.8.1.2 Those who have been allocated numbering capacity are required to advise TRA, on an ongoing basis, of the names and contact details of persons in their organisations to which Allocation Certificates should be sent, who Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 19 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan should have access to the NMS and who should be contacted for other numbering issues. 4.8.1.3 TRA will maintain a list of such contacts and will make it available on request to all operators listed on it, and others who, in TRA's opinion, have need of that information. 4.9 Principle 8. National Numbering Plan records 4.9.1.1 TRA will maintain comprehensive records of the status of all numbers referred to in the Plan. The Number List will be kept by TRA and made available on TRA's website. TRA will update the Number List on its website within 5 working days of changes being made. 4.9.1.2 Where available and not commercially sensitive, details of the operators’ plans for reserved numbering will be included in the Number List on TRA's website. However, those requiring further details of reservations are advised to contact the person for whom the Number Block has been reserved. 4.10 Publication of changes 4.10.1.1 In addition to updating the Number List, within 5 working days of a relevant action being taken TRA will publish confirmations of allocations, reservations or withdrawals, setting out the numbers or Number Range(s) being allocated, reserved or withdrawn, the person to whom the allocation or reservation has been made or from whom it has been withdrawn, and the action date. 4.11 Status indicators 4.11.1 Those parts of the Plan that are not designated have not been set aside for a use specified in the Schedules, and are therefore not available for allocation, reservation and use. This includes numbers used for on-net services and numbers used for messaging services such as SMS. 4.11.2 Numbers that have been designated will, unless this is with reference to an Emergency and Safety Services or On-Net Short Code, have one of the following, more specific, status indicators within the Number List: 4.11.2.1 Allocated - indicates numbers that have been allocated to an operator whose name will be listed alongside. While the majority of numbers shown as allocated may also be in service, these records will not contain information about in-service dates. In addition, allocations will not appear with full details on the Number List when an applicant maintains a requirement to protect commercially sensitive information prior to the opening of service, subject to TRA’s agreement with such a requirement. 4.11.2.2 Free - indicates that these numbers are available for allocation or reservation. Applicants should note that a Number Block shown as Free could have already been requested by another operator between the time Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 20 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan of the last update of the Number List and the time of applying for the Number Block. TRA may decide that specific numbers of Number Ranges are not normally available for allocation or reservation while other numbers are still available for allocation for the same purpose. Such status of the number or Number Range will be indicated in the Number List. 4.11.2.3 Protected - indicates that numbers are protected until the Plan is changed or, where a date is shown, until that date. Numbers are protected, e.g., for future planning purposes or to avoid temporary or permanent dialling problems. 4.11.2.4 Reserved - indicates a provisional allocation, subject to confirmation by the applicant and/or TRA. The applicant's name will normally appear alongside the reservation unless TRA has agreed to maintain commercial confidentiality. 4.12 Principle 9. The review procedure 4.12.1 Reviews of the Plan 4.12.1.1 TRA may from time to time review the Plan upon its own initiative, or upon a request in writing by any Licensed Operator, subscriber or other interested party. 4.12.1.2 The normal consultation period for changes to the Plan will be three months. However, in exceptional circumstances, a shorter consultation period may be appropriate. 4.12.2 Structure of the Principles and Schedules 4.12.2.1 These Principles set out the general rules concerning the procedures for applications, reservations, withdrawals and other operations of the Plan from both TRA’s and applicants' points of view. Specific rules relating to numbers within the Plan are defined in the Schedules below. 4.13 Principle 10. Numbering fees 4.13.1 TRA will charge fees to Licensed Operators for managing and maintaining the resource of numbers. 4.13.2 The fees to be applied may be reviewed from time to

---

time following consultation. 4.13.3 The number ranges that incur fees are as follows: 4.13.3.1 3-digit Off-Net Short Codes as designated in Section 5.44; 4.13.3.2 8-digit Fixed Number Series 13, 16 and 17; 4.13.3.3 8-digit Mobile Number Series 3; Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 21 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 4.13.3.4 8-digit Universal Number Series 6 and 7; 4.13.3.5 8-digit Special Service Number Series 80, 84 and 87; 4.13.3.6 5-digit Special Service Off-Net Short Codes with leading digits 81, 85 and 88; 4.13.3.7 8-digit Premium Rate Number Series 90, 95 and 97; 4.13.3.8 5-digit Premium Rate Off-Net Short Codes with leading digits 91, 94 and 98; 4.13.3.9 5-digit Off-Net Short Codes with leading digits 01; 4.13.3.10 5-digit Off-Net Short Codes with leading digits 07; and 4.13.4 Number applications (including applications for reservation and allocation of numbers) will incur an administration fee in accordance with TRA’s Schedule of Fees. 4.13.5 Licensed Operators will have to pay for numbers allocated and reserved an annual fee (normally payable on a quarterly basis) in accordance with TRA’s Schedule of Fees. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 22 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 5 Schedules 5.1 The following sections contain the Schedules of the Plan. These Schedules contain specific rules relating to the use of number ranges within the Kingdom of Bahrain. Schedule 1 Structure of the Schedules Schedule 1.1 The National Significant Number (NSN) 5.2 The National Significant Number (NSN) is eight digits long (except for Short Codes), notated by the sequence ABCDEFGH. Leading Main Purpose Digit 0 Access Numbers, Off-Net and On-Net Short Codes 1 Numbers for Fixed Services, Emergency and Safety Services and Off-Net Short Codes 2 Protected 3 Mobile Service Numbers 4 Protected 5 Protected 6 Universal Numbers 7 Universal Numbers 8 Special Services Numbers 9 Premium Rate Numbers and Emergency and Safety Services Short Codes Table 1. High level allocation of numbers to purposes within the Plan Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 23 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan Schedule 1.2 Allocation order 5.3 Numbers will normally be allocated from the lowest available Number Block upwards – exceptions to this rule will be made only at TRA’s discretion subject to sufficient justification provided by the Licensed Operator. Schedule 2 Standards and standard presentation Schedule 2.1 Standards 5.4 So far as it is practicable, TRA aims to ensure that the Plan conforms to the relevant international standards. Schedule 2.2 International service numbering 5.5 ITU-T Recommendations describe the role of the ITU-T in managing the international public telecommunications numbering plan and the introduction of specific global (not related to a specific country) services. The management of allocation of numbers for such services is the responsibility of the ITU-T. Schedule 2.3 Country Code 5.6 The Country Code allocated by the ITU-T to the Kingdom of Bahrain is 973. This code follows the international dialling prefix on calls made from outside the Kingdom of Bahrain, and should be followed by the National Significant Number (NSN) of the destination within the Kingdom Bahrain. Schedule 2.4 Maximum number of digits 5.7 Particular attention is drawn to ITU-T Recommendation E.164, which states that the maximum number of digits that a national system is expected to handle on an outgoing international call is fifteen (15) (excluding the international dialling prefix). This requirement is implemented in Bahrain by prescribing specific length to numbers in this Plan. Schedule 2.5 Alphanumeric arrangements 5.8 The Plan will use the decimal character set 0-9 for all number allocations. Letters and other non-decimal characters will not form a part of the Plan to the extent that usage of them does not interfere with the usage of numbers allocated under this Plan. Schedule 2.6 International Prefix (AB = 00) 5.9 The International Prefix 00 is used for international dialling from within the Kingdom of Bahrain. The digits of the Country Code and the NSN will directly follow this prefix. Where an operator supports the use of handsets with the ‘+’ character, this shall be interpreted as the International Prefix when used at the beginning of a dialling sequence. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 24 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan Schedule 2.7 Consistency of presentation 5.10 Numbers should retain a consistent format for number presentation and there must be no intention to deceive or confuse. The recommended formats for presentation of eight-digit NSNs under the Plan are as follows: 5.10.1 National format ABCD EFGH 5.10.2 International format (incoming) +973 ABCD EFGH Schedule 3 Access Numbers 5.11 The Numbers Series with leading digit 0 (except for 00) are designated for use as Access Numbers or Short Codes. 5.12 The Number Series 02CDE is designated for national Carrier Pre-Selection (“CPS”) Access Numbers, where the CDE digits identify a Licensed Operator or a specific service of a Licensed Operator, which needs to be distinguished from other similar services and be available for pre-selection. No operator shall have a right to use such numbers for call-by-call selection of such an operator (including for the override of CPS) or any other use where a caller has to enter these digits by himself/herself. 5.13 Access Numbers are allocated individually. AB Designation Number Length 00 International Access 2 01 Off-Net Short Code 5 On-Net messaging (SMS) Short Code 02 Carrier Pre-Selection 5 03 Protected 04 Protected 05 Protected 06 On-Net Short Code 5 On-Net messaging (SMS) Short Code 07 Off-Net Short Code 5 On-Net messaging (SMS) Short Code Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 25 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 08 Protected 09 Protected Table 2 Designation of the 0 Number Series Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 26 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan Schedule 4 Fixed Numbers 5.14 The 13, 16 and 17 Number Series are designated for Fixed Services as 8- digit numbers. 5.15 Allocation of numbers for Fixed Services will be made in

---

Number Blocks of 1,000. Schedule 5 Mobile Numbers 5.16 The 3 Number Series is designated for Mobile Services as 8-digit numbers. 5.17 The 30 Number Series is protected1. 5.18 The 385 Number Series is protected. 5.19 Allocation of numbers for Mobile Services will be made in Number Blocks of 10,000. Schedule 6 Universal Numbers 5.20 The 6 and 7 Number Series are designated as 8-digit Universal Numbers. The Licensee’s Numbering Plan shall include the specific purpose of the Universal Numbers (separate Number Ranges can have different purposes) allocated to a specific Licensed Operator. 5.21 The 60 and 70 Number Series are protected2. 5.22 Allocation of Universal Numbers will be made in Number Blocks of 1,000. Schedule 7 Special Services Numbers (8 Series) 5.23 The 8 Number Series is designated exclusively for Special Services (some of the Number Series in this range are protected as indicated in Table 3). The cost of the call to services in the 8 Number Series range according to the designation in Table 3 shall be: 5.23.1 paid wholly by the called party; 5.23.2 shared between the caller and the called party; or 5.23.3 paid wholly by the caller. 5.24 The charge to retail customers to call to a Special Services Number shall not exceed the national rate. 1 Following the recommendations of the Final Report on the Review of National Numbering Schemes on their Openness to Competition, prepared by the European Telecommunications Office on behalf of the European Committee for Telecommunications Regulatory Affairs (European Conference of Postal and Telecommunications Administrations), 15 October 1997. 2 Ibid. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 27 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 5.25 The Number Series with leading digits 81, 85 and 88 are shortened to 5-digit Special Service numbers (Off-Net Short Codes). These numbers are designated as detailed in Table 3. 5.26 The Number Series with leading digits 81, 85 and 88 are also designated as 5-digit On-Net messaging (SMS) Short Codes. Operators must hold an On- Net messaging (SMS) Short Code allocation for each number they intend to use for that purpose. Even where an operator has been allocated the 5-digit Off-Net Short Code for use, they still require a separate On-Net messaging (SMS) Short Code allocation. 5.27 Allocation of numbers in the 8 series will be in Number Blocks of 1,000, except for the Short Codes, which will be allocated individually. 5.28 Special Service numbers are designated as follows: Number Service Series 80 No charge to caller (8-digit number) 81 Off-Net Short Codes (5 digits) – No charge to caller On-Net messaging (SMS) Short Codes (5 digits) – No charge to message/SMS originator 82 Protected 83 Protected 84 Cost shared between the caller and the called party (8-digit number) 85 Off-Net Short Codes (5 digits) - Cost shared between the caller and the called party On-Net messaging (SMS) Short Codes (5 digits) – Cost shared between message/SMS originator and receiver 86 Protected 87 Cost born by the caller (8-digit number) 88 Off-Net Short Codes (5 digits) - Cost borne by the caller On-Net messaging (SMS) Short Codes (5 digits) – Cost borne by message/SMS originator 89 Protected Table 3 Allocation of Special Service Numbers in the 8 Series Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 28 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan Schedule 8 Premium Rate Services Numbers (9 Series) Schedule 8.1 General 5.29 The 9 Number Series has been designated for Premium Rate Services, except for the 99 Number Series designated for Emergency and Safety Services Short Codes as stated below. Some of the Number Series in this range are protected as indicated in Table 4. 5.30 The second (B) digit of the numbers in the Premium Rate Services Range indicates a charge band. 5.31 The Number Series with leading digits 91, 94 and 98 are short 5-digit Premium Service numbers (Off-Net Short Codes). These numbers are designated as detailed in Table 4. 5.32 The Number Series with leading digits 91, 94 and 98 are also designated as 5-digit On-Net messaging (SMS) Short Codes. Operators must hold an On- Net messaging (SMS) Short Code allocation for each number they intend to use for that purpose. Even where an operator has been allocated the 5-digit Off-Net Short Code for use, they still require a separate On-Net messaging (SMS) Short Code allocation. 5.33 Allocation of numbers in the 9 Number Series (Premium Rate Services Numbers) will be in Number Blocks of 1,000, except for the Short Codes, which will be allocated individually. 5.34 The charge bands identified in Table 4 below are designated as High, Medium and Low and are designed to give consumers an indication of potential costs of calling these numbers or sending a message/SMS to these numbers. To facilitate more stringent consumer protection, if required, these bands may be subject to a separate regulation. Callers shall be informed about the cost of the call by voice message and shall be given reasonable opportunity to terminate the call before the charging starts. Operators are required to provide means for consumers to be able to determine the tariffs for premium rate messaging (SMS) Short Codes, such as through the rates being listed on the operator’s website. 5.35 The maximum levy for calls in the High Band will be unrestricted. The maximum levy for calls in the Medium Band will be not more than 1 BD per minute open ended. The maximum levy for calls in the Low Band will be 0.5 BD per minute, with a total call charge of no more than 3 BD. 5.36 The maximum levy for messages/SMSs in the High Band will be unrestricted. The maximum levy for messages/SMSs in the Medium Band is 1 BD per message/SMS. The maximum levy for messages/SMSs in the Low Band is 0.5 BD per message/SMS. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 29 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan Number Charge Band Status Series 90 Low Band Designated - 8-digit number 91

---

Low Band Designated – Off-Net Short Codes (5 digits) Designated – On-Net messaging (SMS) Short Codes (5 digits) 92 N/A Protected 93 N/A Protected 94 Medium Band Designated – Off-Net Short Codes (5 digits) Designated – On-Net messaging (SMS) Short Codes (5 digits) 95 Medium Band Designated - 8-digit number 96 N/A Protected 97 High Band Designated - 8-digit number 98 High Band Designated – Off-Net Short Codes (5 digits) Designated – On-Net messaging (SMS) Short Codes (5 digits) 99 N/A Emergency and Safety Services Short Codes (see below) Table 4 Classification of Premium Rate Services numbering Schedule 8.2 Premium Rate Services 5.37 Operators are required to publish allocations and sub-allocations in the interests of consumer protection. 5.38 Operators shall publish a list of the tariffs being applied to their allocated numbers including for messaging (SMS) services. Schedule 9 Short Codes Schedule 9.1 General 5.39 Short Codes are categorised by the type of service for which they are used. There are four types of Short Codes: Access Numbers, Off-Net, On-Net and Emergency and Safety. These types are defined in clause 3.2 of the Plan. Access Numbers are regulated in Schedule 3. Schedule 9 regulates other types of Short Codes. 5.40 The Off-Net and On-Net Short Codes designated in Schedule 9.3 and Schedule 9.4 may only be used for services provided directly by the Licensed Operator. Calls and messages to these the 06 and 07 Number Series are made at no charge to the originating customer. Operators are required to Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 30 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan publish a list of the tariffs being applied to their allocated Off-Net and On-Net Short Codes designated in Schedule 9.3 and Schedule 9.4. 5.41 For the avoidance of doubt, numbers not designated in the Schedules below are protected and these numbers cannot be used as Access Numbers. Schedule 9.2 Emergency and Safety Services Short Codes 5.42 Emergency and Safety Services Short Codes are three (3) digits in length and are designated as shown in Table 5: Short Description Code Common international emergency code 112 Traffic Accident Police 199 Casualty Bureau 990 Protected 991 Criminal Investigation (CID) 992 Protected 993 Coast Guard (CGD) 994 Protected 995 Protected 996 Protected 997 Child Helpline 998 National Emergency Call Centre 999 Table 5 Emergency and Safety Services Short Codes Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 31 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan Schedule 9.3 Off-Net Short Codes 5.43 Designated Short Codes in the Number Series 8 and 9 are Off-Net Short Codes as per Schedule 7 and Schedule 8. Furthermore, the 01 and 07 Number Series are designated for 5-digit Off-Net Short Codes. These Short Codes are allocated individually. 5.44 The following 3-digit Short Codes are designated as Off-Net and are allocated individually: 100-109, 120-129, 140, 141, 151, 181, 188, 191 and 196. Schedule 9.4 On-Net Short Codes 5.45 The 06 Number Series is designated for 5-digit On-Net Short Codes. These Short Codes are allocated individually. 5.46 The 3-digit Off-Net Short Codes as specified in paragraph 5.44 are also designated as 3-digit On-Net messaging (SMS) Short Codes. The 01, 06 and 07 Number Series are also designated as 5-digit On-Net messaging (SMS) Short Codes. These Short Codes are all allocated individually. 5.47 Operators must hold an On-Net messaging (SMS) Short Code allocation for each number they intend to use for that purpose. Even where an operator has been allocated the corresponding 3-digit Off-Net, 5-digit Off-Net or 5-digit On-Net Short Code for use, they still require a separate On-Net messaging (SMS) Short Code allocation. Schedule 10 Dialling arrangements 5.48 Full 8-digit numbers shall always be used for Fixed Services, Mobile Services, Premium Rate Services and Universal Numbers (except for Short Codes falling in the respective categories). Such numbers can be used as an NSN only or in the international format (Schedule 2.6). No prefixes can be used together with these numbers except where the Plan expressly allows them. 5.49 Emergency and Safety Services and B Short Codes shall be dialled without any prefixes (including Access Numbers) from the networks of all Licensed Operators. On-Net Short Codes shall be dialled without any prefixes within the network of a specific operator using this number. 5.50 National numbers, dialled after an Access Number, shall be dialled in either the international format (dialling in international format does not apply to the On-Net Short Codes) according to the dialling sequence defined in Schedule 2.6 or in the form of NSN only. No digits can be inserted either before an Access Number (when it is used in the public telecommunications network) or between an Access Number and the number dialled after it. Schedule 11 Use of numbers by subscribers Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 32 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 5.51 Subscribers that have a number assigned to them shall have the right to use the number for making use of other services both of the operator that has a number allocated to it, or of other operators, provided such services comply with the requirements for use of specific numbers. 5.52 Upon request of the relevant subscriber and subject to the Number Portability processes, subscribers may port their number (including Off-Net Short Codes) to any other Licensed Operator. Calls and messaging services such as SMS will be routed directly to the subscriber through the new operator’s network, bypassing the network of the operator to which the number is allocated. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 33 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan 6 Principles for other codes 6.1 TRA recognises that there is a need to manage other aspects of numbering in addition to those covered above. TRA has already undertaken the task of administering these resources and they are now included as part of the Plan under the responsibility of TRA. These include: 6.1.1 Data Network Identification Codes (ITU-T Recommendation X.121); 6.1.2 Legacy system codes (e.g.

---

Telex); 6.1.3 Mobile Network Codes (ITU-T Recommendation E.212); 6.1.4 National Signalling Point Codes; 6.1.5 International Signalling Point Codes (ITU-T Recommendation Q.708); 6.1.6 Issuer Identification Number (ITU-T Recommendation E.118); 6.1.7 Other similar codes as required. 6.2 Applications, reservations and withdrawals for these codes are administered in the same way as other numbers, as detailed in the Principles, taking into account adjustments as necessary, in particular in order to comply with the relevant ITU-T Recommendations. Applicants for these codes and their uses shall in addition comply with the relevant ITU-T Recommendations. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 34 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan Appendix 1. Licensed Operator’s Numbering Report Template The reporting template shall be a Microsoft Excel spreadsheet, with a sheet allocated to each service. Each service will then be reported with the following headings shown with example data: Service: e.g. Fixed, Mobile, Premium Rate, Special Services, etc. Range: e.g. 13600000 – 13609999 Type: e.g. Fixed Wireless Total Available Numbers: e.g. 10,000 Total Working Numbers: e.g. 6,200 Total Spare Numbers: e.g. 3,800 %Utilised End [Year X = Reported year]: e.g. 72.2% %Annual Growth: e.g. 10.5% %Utilised End [X+1]: e.g. 79.6% %Utilised End [X+2]: e.g. 87.3% %Utilised End [X+3]: e.g. 94.7% Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 35 of 36 Date: 04 February 2016 Issue: 2.0 National Numbering Plan Appendix 2. Numbering Application Information (via NMS) Numbering applications shall be submitted through the NMS and contain the following information (as per the NMS specification): Applicant’s Details Should include the name of an authorised person, together with address and contact details for further correspondence. Type of Request Reservation/De-Reservation/Allocation/De-Allocation/Other One of the options should be selected or information provided in the field “Other”. Reference Numbers Applications submitted to TRA should include an applicant's reference number by which the application can be tracked. TRA will assign the application a TRA reference number during the processing of the application. Applicant’s Licence Reference The identity of the licence under which the application is being made. Range requested Applicants should enter here their first choice of Number Range. To allow for the possibility of coincident applications, second and (if required) third choice Number Ranges may also be included to cover the possibility that the first choice range has been allocated already. As a general principle one application should cover one Number Range. In identifying the ranges applicants shall take into account the requirements of Schedule 1.2 of the Plan. Proposed use of requested numbers A brief description of the use to which the additional numbers will be put and why the request has been made. Special conditions / remarks Applicants may identify any special conditions applied to the requested allocation or include additional remarks. If an applicant requests an allocation which does not conform to the requirements of Schedule 1.2 of the Plan, the reasons should be explained here. Ref: TOD/0216/002 Telecommunications Regulatory Authority Page 36 of 36 Date: 04 February 2016 Issue: 2.0 Consumer Protection (Telecommunications Service) Regulation Consumer Protection (Telecommunications Services) Regulation 4 December 2017 Ref: LAD/1117/251 1 Consumer Protection (Telecommunications Service) Regulation CHAPTER 1 ARTICLE 1 DEFINITIONS Unless the context otherwise requires, any word, phrase or expression used in this Regulation shall have the meaning given to it in Article (1) of the Legislative Decree No. (48) of 2002 Promulgating the Telecommunications Law of the Kingdom of Bahrain, and the following terms and expressions shall have the following meaning: Term Definition Advance Notice The notice period of at least one (1) month before any proposed action to amend or rescind a Service Contract. Period Advertiser A Licensed Operator or a Third Party who Advertises an Applicable Product or Service through any Advertising Means. Advertisement or Content, which is directly or indirectly controlled by an Advertising Advertiser, expressed in any language, and is communicated through different Advertising Means with the intent to influence a Consumer’s commercial choice, opinion and behaviour. Advertising Means Any material used for Advertising, which includes: a) Television, radio, newspaper and magazine advertisements; b) brochures and leaflets; c) direct mail and electronic mail; d) any point of sale material; e) packaging material; 2 Consumer Protection (Telecommunications Service) Regulation f) price tags; g) billboards; h) posters; i) cinema advertisements; j) promotional videos; k) website materials and banners; l) media channels and press releases; m) social media; n) electronic news groups; o) still messages and inserts; p) videos and animated films; q) interactive voice response (IVR); r) Short Messaging Services (SMS); and s) information kiosks. Applicable Product Includes: or Service a) Public Telecommunications Services; and/or b) telecommunications equipment offered for sale by a Licensed Operator. Authority The Telecommunications Regulatory Authority. Contract Term The term of the Service Contract, whether or not termination 3 Consumer Protection (Telecommunications Service) Regulation fees apply in that term. Comparative Advertising in which one Advertiser draws a comparison Advertisement or between an Applicable Product or Service and that of another Comparative Licensed Operator. Advertising Consumer A Subscriber, or a Person who receives, uses, acquires, or consumes an Applicable Product or Service. Direct Contact Advertising by means of direct contact with Consumers. Advertisement Fair Usage Policy A document, which forms part of the Service Contract, stipulating constraints and practices that a Consumer must agree to for access to a service. Joint Advertisement Advertising where more than one Advertiser are jointly or Joint Advertising Advertising an Applicable Product or Service, two or more Applicable Products or Services, or an Applicable Product or Service with any other product or service. Law The Legislative Decree No. (48) of 2002 Promulgating the Telecommunications Law of the Kingdom of Bahrain. Misleading An Advertisement which contains information, statements, or Advertisement visual presentation which directly or by implication is likely to mislead or deceive the Consumer about an Applicable Product or Service or about the Advertiser. Minimum Service The minimum contracted period agreed to by a Licensed Period Operator and a Subscriber, after which no fees are payable for the termination of the Service Contract by the Subscriber. 4 Consumer Protection (Telecommunications Service)

---

Regulation Licensed Operator A Person who is licensed to operate a Telecommunications Network or to provide a Telecommunications service under Article 25 of the Law. Third Party/ies Any person or entity that is used by a Licensed Operator to Advertise, offer or sell their Applicable Product or Service such as resellers, distributors, dealers, agents or other retail outlets. Service Contract The contract between a Licensed Operator and a Subscriber, confirming the legal terms that govern how and when a Licensed Operator will provide an Applicable Product or Service. Subscriber Any Person that is party to a Service Contract with a Licensed Operator for the provision of an Applicable Product or Service. CHAPTER 2 SCOPE AND OBJECTIVES OF THIS REGULATION ARTICLE 2 SCOPE OF REGULATION This Regulation applies to all Licensed Operators who Advertise or provide an Applicable Product or Service to Consumers, and to Third Parties. ARTICLE 3 LIABILITY OF LICENSED OPERATORS Licensed Operators who offer/sell their Applicable Product or Service through a Third Party shall be liable for any breach of the provisions of this Regulation committed by that Third Party. 5 Consumer Protection (Telecommunications Service) Regulation ARTICLE 4 OBJECTIVES OF REGULATION 1. The objectives of this Regulation are to: a) empower Consumers to make informed decisions; and b) establish the rights of Consumers and the corresponding obligations of Licensed Operators. CHAPTER 3 ADVERTISING ACTIVITY ARTICLE 5 ACTIVITIES, PRODUCTS AND SERVICES SUBJECT TO THIS CHAPTER 1. This Chapter shall apply to any Advertiser’s direct or indirect advertising, marketing, promotional activity, branding activity, or any other activity that relates to any Applicable Product or Service irrespective of the Advertising Means. ARTICLE 6 OBLIGATIONS OF ADVERTISERS 1. Advertisers shall ensure that: a) Advertisements are fair, truthful and accurate, and shall not, directly or by implication, mislead or confuse any Consumer; b) Advertisements are factually correct and culturally sensitive, and that this is done so with a sense of responsibility towards Consumers and the community; c) they clearly disclose to Consumers all terms and conditions as well as the necessary information before the point of sale; 6 Consumer Protection (Telecommunications Service) Regulation d) if the price of the Applicable Product or Service is dependent on the purchase of another product and/or service, the extent of any commitment by a Consumer shall be communicated in advance and made clear to the Consumer; e) where a full description of the Applicable Product or Service or the terms and conditions cannot be accommodated in the Advertisement, state that it is “subject to terms and conditions”, or words which have the same effect; f) not exaggerate price claims such as “up to” and “from” as to the availability of benefits likely to be obtained by the Consumer; g) when the terms “warranty” or “guarantee” are used in an Advertisement, ensure that a statement is made on the complete details of the warranty or guarantee, and is available for Consumers to read prior to the sale of an Applicable Product or Service; h) they avoid causing offence on the grounds of, but not limited to, race, religion, gender, political indecency, physical or mental instability in Advertisements; i) Advertisements do not contain anything that is likely to cause serious or widespread offence; j) they do not condone or provoke violence or anti-social behaviour in Advertisements; and k) Advertisements are not framed as to abuse the trust of the Consumer, or exploit a Consumer’s lack of knowledge and experience; 2. Advertisers shall substantiate a claim or representation made in Advertisement when requested to do so in writing by the Authority. ARTICLE 7 MISLEADING ADVERTISING Advertisers shall not engage in Misleading Advertisement, in particular with regard to: 7 Consumer Protection (Telecommunications Service) Regulation a) the existence or nature of the Applicable Product or Service; b) the price or the way in which it is calculated; c) the existence of a specific price advantage, if available; d) the main features of the Applicable Product or Service, such as its availability, benefits, risks, composition, execution accessories, after-sale customer service, complaint handling process, method and date of manufacture, delivery, quantity, fitness for purpose, usage, specifications, geographical or commercial origin; e) the extent of the Advertiser’s commitments, the motives for the commercial practice and the nature of the sales process, any statement or information in relation to direct or indirect sponsorship; or f) the need for a service, part, replacement or repair. ARTICLE 8 COMPARATIVE ADVERTISING Without prejudice to the obligations set out in Article 6 of this Regulation, a Comparative Advertisement shall be permitted only when the following conditions are met by the Advertiser: a) the Advertisement is not a Misleading Advertisement; b) the Advertiser distinguishes its offerings by highlighting real benefits, innovations, and genuine distinguishing factors; c) the Advertisement does not unfairly criticize, discredit, or disparage a competitor or its products and/or services in the Advertisement; and d) The Advertiser does not issue Advertisements that unfairly denigrate a competitor’s quality of service, so as to reduce public confidence in the products and/or services offered by that other competitor. 8 Consumer Protection (Telecommunications Service) Regulation ARTICLE 9 JOINT ADVERTISING Without prejudice to the obligations set out in Article 6 of this Regulation, a Joint Advertisement shall be permitted only when the following conditions are met: a) whether as bundled products or services or not, the Advertisers shall ensure that it is clear from the Joint Advertisement who is legally responsible to the Consumer for providing the Applicable Product or Service; b) that the Joint Advertisement clearly identifies to the Consumer who shall be responsible for the Applicable Product or Service; c) where the full details cannot be accommodated in the Joint Advertisement, the Advertisers shall include a statement such as “provided by more than one Advertiser”, or words which have the same clear effect; d) the details of the Advertisers responsible shall be disclosed by the Advertisers to the Consumer before entering into any contract(s); and e) the Advertisers shall clearly state the contact details and all relevant information of the Advertisers responsible

---

in the contract(s) relating to the Joint Advertisement. ARTICLE 10 CLAIMS CONCERNING SAVINGS 1. An Advertiser shall not claim in any Advertisement that an Applicable Product or Service is on special offer, available free of charge, or available on any other preferential terms and conditions unless it is true and based on facts which can be substantiated. 9 Consumer Protection (Telecommunications Service) Regulation 2. If the Advertisement refers to a special offer, the Advertiser shall clearly indicate on the Advertisement the date on which the offer commences and ends, and whether it is subject to availability of the Applicable Product or Service. 3. If a Consumer must satisfy any conditions prior to qualifying for any discounts, it shall be made clear in the Advertisement. If, because of the nature of the Advertising Means used, that this information is not included in the Advertisement, the Advertiser shall ensure that: a) the Advertisement shall include a statement such as “subject to conditions” or words which have the same clear effect; and b) the Consumer has been made aware of the conditions before they enter into any contracts as a result of the Advertisement. ARTICLE 11 EXPRESSIONS AND STATEMENTS IN ADVERTISEMENTS Advertisers shall comply with the following in relation to such expressions and statements included in Advertisements: a) free: i. the expression “free” shall mean free and without any direct or indirect costs to the Consumer in obtaining the Applicable Product or Service; ii. Advertisements shall not describe an Applicable Product or Service as “free” if: 1. the Consumer has to pay packing, packaging, administration or handling costs for the Applicable Product or Service; 2. the cost of response including the price of a product or service which a Consumer must buy to take advantage of the Applicable Product or Service, has been increased, except 10 Consumer Protection (Telecommunications Service) Regulation where the increase results from factors that are unrelated to the cost of the promotion; or 3. the quality of the Applicable Product or Service being offered has been reduced; iii. Advertisements shall make clear the extent of the commitment the Consumer must make to take advantage of a "free" offer; and iv. in the case of a bundled Applicable Product or Service, where a claim is made that if one is purchased another will be provided “free of charge”, the Advertisement shall clearly state what component of the Advertisement is free, and whether it is limited for a period of time. b) unlimited: i. the expression “unlimited” shall mean that an Applicable Product or Service is provided without any limitation, save for inherent and asserted technical limitations found in any network; 1. “Unlimited” claims where an Applicable Product or Service is subject to a Fair Usage Policy are likely to mislead unless the Advertisement complies with Article 23 of the Regulation and meets the following requirements: the existence of the Fair Usage Policy is stated in the advertisement; 2. the Fair Usage Policy is fair and reasonable; 3. Consumers shall incur no additional charges or suspension of the Applicable Product or Service as a consequence of exceeding any usage threshold associated with the Fair Usage Policy; and 11 Consumer Protection (Telecommunications Service) Regulation ii. the following practices, or similar, when included as part of a Fair Usage Policy, shall preclude an Applicable Product or Service being advertised as “unlimited”: 1. charging for usage in excess of a limit, either automatically or reserving the right to do so; 2. capping of usage through whatever means, such as barring access to the Applicable Product or Service once a limit is reached, or similar; 3. termination or suspension of a service; or 4. forcing a Consumer to change a package to one with a higher cost or stated limitation on usage. c) speed claims: i. Applicable Products or Services shall not be described in any Advertisement as being “high speed and/or very high speed” if the available capacity/bandwidth does not correspond to the appropriate service; or ii. claims regarding download speeds shall be based on the actual experience of Consumers. d) for life: i. the expression “for life” shall be properly qualified when used in an Advertisement in so far that it is clear on whether it means the natural life of the Consumer, the duration of a Service Contract, or for the life of the Applicable Product or Service. e) claims concerning the offering of access to the internet: 12 Consumer Protection (Telecommunications Service) Regulation i. Advertisers shall only make claims concerning the offering of access to the internet if Consumers are able to access lawful content and applications of their choice. ARTICLE 12 EXCLUSIONS AND DISCLAIMERS The Advertiser shall ensure that: a) footnotes, disclaimers, words, or symbols qualifying or excluding products or services made in an Advertisement shall be readily visible, audibly apparent and legible; b) footnotes, disclaimers, words, or symbols qualifying or excluding products or services made in Advertisement shall not contradict, materially qualify, or otherwise alter the basic claims made or implied in the Advertisement; c) references to detailed terms and conditions in an Advertisement shall not have the effect of contradicting, materially qualifying or otherwise altering the basics of any claim made or implied in the Advertisement; d) exclusions, disclaimers, or limitations that apply to an Applicable Product or Service shall be clearly stated in the same Advertisement; e) if the details of the exclusion or disclaimer cannot be included in the Advertisement, a reference shall be included in the Advertisement such as “subject to exclusions” or words which have the same clear effect; and f) details on any exclusion or disclaimer shall be communicated to the Consumer prior to them entering into any contract for the Applicable Product or Service. ARTICLE 13 QUOTING RESEARCH AND STATISTICS 13 Consumer Protection (Telecommunications Service) Regulation 1. Advertisers shall quote sources when using statistics or results from research studies within the Advertisement. 2. The Advertiser shall produce the study methodology and results, if requested by the Authority or a Consumer. 3. Advertisements

---

shall not distort the true meaning of any statements made by professionals or research studies. 4. Advertisers shall ensure that the statistics, quotes, or results from a research study are not misleading, inaccurate or biased. ARTICLE 14 ADVERTISEMENTS RELATING TO EQUIPMENT Where an Advertiser is Advertising an Applicable Product or Service, it shall ensure that the following requirements are met: a) if the Applicable Product or Service uses a telecommunications equipment, that it is in compliance with Chapter 7 of the Law; and b) if the right of redress in the event of a fault or defect during the relevant warranty period does not rest with the Advertiser, this shall be clearly stated and specified in the Service Contract. ARTICLE 15 DIRECT CONTACT ADVERTISEMENT 1. When using Direct Contact Advertisement, Advertisers shall ensure that the number of calls, emails, or SMS being sent to a Consumer for Advertising purposes is non-intrusive. 14 Consumer Protection (Telecommunications Service) Regulation 2. Advertisers shall comply with the provisions the Bulk SMS Regulation promulgated by Resolution No. 3 of 2015 in their direct contact with Consumers through any Advertisement by SMS. CHAPTER 4 SERVICE CONTRACTS ARTICLE 16 GENERAL PROVISIONS OF A CONTRACT 1. Licensed Operators shall provide Subscriber with a physical contract. 2. Licensed Operators shall ensure that the Subscriber’s signature is included in the Service Contract. 3. All standard terms of the Service Contracts shall be published by Licensed Operators on their website. 4. Licensed Operators shall ensure that standard terms of the Service Contracts are easily accessible from the same webpage where the service, offer, or package is being publicised. 5. Licensed Operators shall ensure that no Service Contract exceeds a fixed duration of twenty-four (24) months. 6. Licensed Operators shall make the standard terms of the Service Contracts available at their retail outlets such that they are readily available in hard copy format and free of charge, should prospective Subscribers request them. ARTICLE 17 STANDARD CONTRACTUAL TERMS 15 Consumer Protection (Telecommunications Service) Regulation 1. Licensed Operators shall provide new Subscribers with a written Service Contract by which it shall clearly and unambiguously express the full terms and conditions including, but not limited to, any restrictions, limitations, scale of tariffs and Fair Usage Policies relating to the supply of the service. 2. Licensed Operators shall specify the following minimum requirements in Service Contracts (or any appendix thereto) in a clear, understandable and easily accessible form, in English or Arabic: a) a description of the service to be provided; b) the details of prices, tariffs, and any other applicable charges for the use of the service, including: i. any recurring charges; ii. call tariffs; and iii. one-off charges; c) the obligations of the Licensed Operator and the Subscriber; d) the relevant billing timeframes, cycles and payment methods; e) a description of the Contract Term, the Minimum Service Period (if any), and the Advance Notice Period; f) reference to the existence of a Fair Usage Policy (if any), and a signpost as to how a Subscriber can access a copy; g) a description of any limitations or restrictions on the use of the service, including in particular: iv. any limits of the volume of usage; v. fair usage policies; and 16 Consumer Protection (Telecommunications Service) Regulation vi. details of any fees that would become payable if any such limits are exceeded; h) a description of the circumstances in which the Subscriber may be disconnected by the Licensed Operator, including in accordance to applicable legal instruments issued by the Authority; i) a description of the reconnection process of a disconnected service, including any associated fees; j) any charges that apply upon termination of the Service Contract (within or outside the Minimum Service Period); k) reference to the Subscriber complaint and dispute resolution procedures, as well as the Licensed Operator’s Code of Practice as approved by the Authority; and l) the Licensed Operator’s contact details. 3. A Licensed Operator shall: a) give a Subscriber an Advance Notice Period before any contractual changes that have the effect of: i. increasing the burden of the Subscriber. under the Service Contract; or ii. reducing the benefit of the Service Contract or service to the Subscriber; and b) allow the Subscriber to withdraw from the Service Contract without any early termination charges upon thirty (30) days from date of receipt of such notice. 17 Consumer Protection (Telecommunications Service) Regulation 4. The Licensed Operator shall ensure that the information pertaining to the charges applicable for terminating the Service Contract before the end of its term are written in: a) bold and in a font size which is at least twenty (20) percent larger than the other clauses in the Service Contract; or b) bold and inserted as the final clause before the Subscriber’s signature. 5. A copy of the signed Service Contract shall be provided to the Subscriber at the point of sale and at the Subscriber’s request at any time. ARTICLE 18 UNFAIR TERMS 1. Licensed Operators shall ensure that their Service Contracts do not include: a) terms to the effect that, at the end of a Subscriber’s Contract Term, the Service Contract would be automatically renewed for a further Contract Term without the Licensed Operator first obtaining the Subscriber’s express consent; or b) terms which impose a charge on a Subscriber for termination of a Service Contract within the Minimum Service Period if that charge is disproportionate in relation to any outstanding payments for the remainder of the Contract Term. 2. Licensed Operators shall refrain from including terms in a Service Contract which have the object or effect of: a) excluding or limiting the legal rights of a Subscriber vis-à-vis the Licensed Operator in the event of total or partial non-performance or inadequate performance by the Licensed Operator of any contractual obligations; 18 Consumer Protection (Telecommunications Service) Regulation b) requiring a Subscriber to pay a disproportionately high sum in compensation in the event that the Subscriber fails to fulfil his contractual obligations; c) enabling the Licensed Operator to alter the

---

terms of or terminate the Service Contract on a discretionary basis; d) enabling the Licensed Operator to alter unilaterally without a valid reason any characteristics of the product and/or service to be provided; e) providing for the price of a product and/or service to be determined at the time of delivery or provision; f) enabling the Licensed Operator to increase prices, fees, tariffs or charges without giving the Subscriber the corresponding right to terminate the Service Contract; g) obliging the Subscriber to fulfil his obligations where the Licensed Operator does not perform his; h) giving the Licensed Operator the exclusive right to determine whether the Applicable Product or Service being offered is in conformity with the Service Contract; i) giving the Licensed Operators the exclusive right to interpret the Service Contract; j) giving the Licensed Operators the possibility of transferring his rights and/or obligations under the Service Contract without the Subscriber’s consent; k) excluding, hindering, or limiting the Subscriber’s right to take legal action, or exercise any other legal or equitable remedy permitted by law; and 19 Consumer Protection (Telecommunications Service) Regulation l) enabling Licensed Operators to engage in undue blocking, throttling and discrimination between content and applications delivered by third parties and accessed by Subscribers. ARTICLE 19 DURATION OF A SERVICE CONTRACT 1. Licensed Operators shall ensure that all Service Contracts include a specific term on the duration of the contract and shall, at a minimum: a) Be separate from any other clause and prominently displayed; b) Specify the duration of the Service Contract; c) Specify the Advance Notice Period. d) Specify the means by which such Advance Notice Period is to be communicated to either party; and e) Specify the events that would give either party a right to suspend a service and/or terminate the Service Contract; 2. Licensed Operators shall not charge or subscribe a Subscriber to a service where the Subscriber has not expressly signed for or expressly opted to pay for. 3. At the end of its duration, Licensed Operators shall not renew an existing Service Contract without the express consent of a Subscriber. 4. The provision of Article 19(2) shall not apply in circumstances where: a) the service is unquestionably without prejudice to the Subscriber; or 20 Consumer Protection (Telecommunications Service) Regulation b) the service is unquestionably to the advantage of the Subscriber. 5. Where services are subject to upgrade or migration options, Subscribers shall be provided with clear information regarding the upgrade or migration terms, including but not limited to any changes in service performance or changes in the tariffs for the service. 6. Licensed Operators shall not upgrade or migrate a Consumer without the expressed permission of the Subscriber, unless such upgrade/migrate is: a) unquestionably without prejudice to the Subscriber; or b) unquestionably to the advantage of the Subscriber at no additional cost. 7. Licensed Operators shall ensure that Subscribers are adequately informed about the actions that will be taken in the event of non-payment, specifying the courses of action available to them to avoid service suspension and/or termination of service. 8. Licensed Operators shall ensure that Subscribers sign a termination form upon termination of a contract or/and a service, as well as provide them with a copy of the same. ARTICLE 20 SERVICE QUALITY LEVELS 1. Licensed Operators shall clearly set the levels of the quality which the Licensed Operator undertakes to uphold with its Subscribers in the Service Contract. 2. Licensed Operators shall ensure that Service Contracts include: 21 Consumer Protection (Telecommunications Service) Regulation a) the minimum access speeds in case of internet service in the Service Contract, ensuring that such speeds do not significantly differ from any advertised speeds; b) The maximum time for initial connection and disconnection; c) the type of maintenance services offered; and d) the maximum repair time required to restore services, free of charge, following any maintenance services to the infrastructure and/or equipment owned by the Licensed Operator, and/or faults resulting from failures to the Licensed Operator’s equipment and/or infrastructure. ARTICLE 21 CONDITIONS LIMITING ACCESS TO AND/OR THE USE OF SERVICES 1. Licensed Operators shall ensure that any limitations or conditions which have the result of impacting or potentially impacting the service being provided shall be included in the Service Contract. Licensed Operators shall ensure that the following are included in Service Contracts: a) Information on the coverage of service, where the Service Contract makes reference to the existence of such information and where a Subscriber may obtain this information free of charge; b) Any instances, where tests are required, to assess whether the service could be provided at a certain location; and c) Any restrictions imposed by the Licensed Operator which have the effect of limiting the Subscriber’s ability to access other services and/or features. 2. Licensed Operators shall: a) Maintain adequate proof of a Subscriber’s request to subscribe/unsubscribe to an add-on/offer; 22 Consumer Protection (Telecommunications Service) Regulation b) Maintain adequate proof of a Subscriber’s acceptance of any new terms and conditions; and c) provide such evidence to the Authority as necessary, if requested. CHAPTER 5 ARTICLE 22 ACCESS TO ONLINE CONTENT AND APPLICATIONS 1. Consumers shall have the right to access and distribute lawful information and content as well as use and provide applications and services, irrespective of their location or the location, origin or destination of the information, content, application or service via the internet access service. 2. Licensed Operators shall not block, throttle, degrade, restrict or unduly discriminate against lawful information, content, applications or services. 3. The provision of Article 22(2) shall not prevent Licensed Operators from implementing reasonable traffic management measures. Such measures shall be transparent, non-discriminatory and proportionate, and shall not be based on commercial considerations but on technical quality of service requirements. 4. Licensed Operators shall not engage in traffic management measures that go beyond those set out in Article 22(3), and in particular shall not block, slow down, alter, restrict, interfere with, degrade or discriminate between specific content, applications or services, or specific categories thereof, except as

---

necessary, and only for as long as necessary, in order to: a) preserve the integrity and security of its network and of services provided via that network; and b) prevent impending network congestion and mitigate the effects of exceptional or temporary network congestion, provided that equivalent categories of traffic are treated equally. 5. Licensed Operators shall ensure that any contract which includes internet access services specifies the following at a minimum: 23 Consumer Protection (Telecommunications Service) Regulation a) information regarding minimum quality of service levels offered as well as other parameters related to the quality offered to Subscribers; b) information on how traffic management measures applied by that Licensed Operator may impact on the quality of service; and c) a clear and comprehensible explanation as to how any volume limitation, speed and other information on conditions limiting access to and/or use of services and applications. CHAPTER 6 FAIR USAGE POLICY ARTICLE 23 FAIR USAGE POLICY 1. Licensed Operators shall implement and adhere to a Fair Usage Policy for dealing with Subscriber usage above any set thresholds. 2. Licensed Operators shall ensure that their Fair Usage Policy include, as a minimum: a. Information to Consumers about their legal obligations and liabilities in making use of the services provided by the Licensed Operator; b. A description of practices which are considered abusive and therefore prohibited; and c. The limits of liability of the Licensed Operator in the provision of such information as may be contained in the Fair Usage Policy. 3. Where the Advertised Applicable Product or Service is subject to a Fair Usage Policy, the Advertiser shall clearly make reference to this in the terms and conditions. 24 Consumer Protection (Telecommunications Service) Regulation 4. Where the details of the Fair Usage Policy cannot be included in the Advertisement, this shall be made clear to the Consumer prior to them entering into any Service Contract for the Applicable Product or Service. CHAPTER 7 SUBSCRIBERS WITH SPECIAL NEEDS ARTICLE 24 1. A Licensed Operator shall make available, free of charge and in formats such as large print or Braille, upon their request: a) Any Service Contract with a Subscriber; b) Any bill rendered in respect of an Applicable Product or Service; and c) Any other communication between the Licensed Operator and the Subscriber. 2. A Licensed Operator shall ensure that, free of charge, a Subscriber is able to nominate an individual who may engage with the Licensed Operator on behalf of the Subscriber, including but not limited to: a) receiving the Subscriber’s bill; b) paying the Subscriber’s bill; c) making enquiries about the Subscriber’s account; and d) terminating the Service Contract. 3. A Licensed Operator shall not hold the nominated individual referred to in Article 24(2) legally liable for a breach in the terms and conditions of the Service Contract. 25 Consumer Protection (Telecommunications Service) Regulation 4. For the avoidance of doubt, the nominated individual referred to in Article 24(2) shall not be required to enter into a contract with the Licensed Operator whilst engaging with the Licensed Operator on behalf of a Subscriber with special needs CHAPTER 8 BILLING ARTICLE 25 BILLING 1. Licensed Operators shall provide detailed itemised bills in electronic format free of charge upon request by a Subscriber. 2. Licensed Operators shall enable Subscribers to access and retrieve copies of their electronic detailed itemised bills on their online systems for a minimum period of twelve (12) months, free of charge. 3. If any Licensed Operator does not provide Subscribers with detailed itemised bills electronically, Subscribers shall be entitled to request a detailed itemised bill in hard copy format, free of charge. 4. Licensed Operators shall clearly inform Subscribers having access to electronic detailed itemised bills: a) about the timeframe of twelve (12) months during which they can access their bills electronically, free of charge; b) of any steps that the Subscriber needs to follow in order to save, email, and/or print copies of such bills; and c) of any applicable charges should a copy of a bill be requested following the lapse of the twelve (12) month timeframe. 26 Consumer Protection (Telecommunications Service) Regulation 5. Licensed Operators shall provide senior Subscribers over the age of 60 with a detailed itemised bill in hard or electronic format, depending on the Subscriber’s preference, free of charge, if so requested. 6. Licensed Operators shall retain billing records in accordance with Bahraini document retention laws, but in any event no less than a period of twelve (12) months in standard cases. 7. Should a dispute regarding billing commence within twelve (12) months, Licensed Operators shall retain the records until settlement of the dispute. CHAPTER 9 CONFIDENTIALITY ARTICLE 26 1. Licensed Operators shall preserve the confidentiality of the proprietary information of their Subscribers. 2. Licensed Operators shall prohibit improper access to and/or of the confidential information of their Subscribers and refrain from disclosing such information without the Subscriber’s prior written consent, unless otherwise required by law. 3. Licensed Operators shall equip themselves in such a manner as to reasonably ensure the confidentiality of their Subscribers’ information and communications. CHAPTER 10 ENFORCEMENT ARTICLE 27 APPROVAL BY THE AUTHORITY 27 Consumer Protection (Telecommunications Service) Regulation 1. All Licensed Operators shall ensure that their Service Contracts reflect the requirements set out herein and are submitted to the Authority for its approval no later than six (6) months after the publication of the Regulation. 2. Licensed Operators shall submit any new terms of Service Contracts to the Authority for its approval. 3. The Authority may require that a Licensed Operator amend its Service Contracts in such a manner as the Authority may prescribe, either as a result of complaints received or by the Authority’s own initiative. ARTICLE 28 ENFORCEMENT 1. Without prejudice to any other laws, a breach of any provision of this Regulation by a Licensed Operator shall be deemed to constitute a material breach of its licence(s) and the provisions of the Law. 28 
 
 What Does “Universal Acceptance” Mean? Some software does not recognize or correctly process all domain names and all email addresses. Domain names can include strings in the top-level position that are longer than the older familiar ones, and domain names and email addresses can now use characters drawn from a much larger Unicode-based repertoire than traditional ASCII1. Universal Acceptance (UA) is the state in which all valid domain names and email addresses are accepted, validated, stored, processed, and displayed correctly and consistently. The Universal Acceptance Steering Group (UASG) is a community-led initiative working on creating awareness and identifying and resolving problems associated with the universal acceptance of all domain names and email addresses. Its goal is to help ensure a consistent and positive experience for Internet users globally. It is supported by ICANN (the Internet Corporation for Assigned Names and Numbers) and has participants from more than 200 organisations around the world, including Aﬁlias, Apple, CNNIC, GoDaddy, Google, Microsoft, and Verisign. For more information on the UASG and recent developments, visit: www.uasg.tech. Software and online services support Universal Acceptance when they oﬀer the capabilities listed above for all domains and email names. 1 ASCII is the character encoding historically used on the Internet, deﬁned in the Internet standard RFC 20 . Unicode is deﬁned by the Unicode Consortium . This Quick Guide describes the UASG Recommendations for achieving Universal Acceptance in the ﬁve contexts—Accept, Validate, Store, Process, and Display—in which systems encounter domain names and email addresses. It is intended for executives and managers responsible for Information Technology or Software Product Engineering activities. It presents the UASG Recommendations at a high level without some of the detail that would be important to a software architect or engineer. For those details consult UASG 007, “ Normalization, Case Folding, and String Preparation 28 Case Folding and Mapping 30 Glossary and Other Resources 31 Glossary 31 RFCs and Key Standards 34 Key Standards 37 Online Resources 38  About This Document The Internet’s technologies, including its naming components, continually evolve and change. In recent years, new top-level domains (TLDs), some with traditional ASCII characters and some with non-ASCII characters (Internationalized Domain Names), have been approved by the Internet Corporation for Assigned Names and Numbers (ICANN). Examples include .nyc, .संगठन, .eco, and .католик. However, many applications and services have not been updated to manage this expanded range of TLDs. In addition, Internet email standards now allow non-ASCII characters in email addresses, so until software is upgraded, it will not properly handle these domains and addresses. This affects the user experience in multiple ways: ▪ ▪ Valid email addresses are not recognized or accepted. Domain names are mistakenly treated as search terms in the address bar of the browser. Until software recognizes and processes all domain names and email addresses – a state known as Universal Acceptance (UA) – it will not be possible to provide a consistent and positive experience for all Internet users. This document provides a broad introduction to Universal Acceptance and the efforts being made to assist in the development of Universal Acceptance-ready software. Target Audience This document is intended to introduce Universal Acceptance to a technical audience (developers, managers, and operators) that may be familiar with some aspects of Internet technology but not necessarily the details of how new IDNs, domain names, and email addresses affect the way in which they should be accepted, validated, stored, processed, and displayed. It represents a starting point for people with diverse technical backgrounds to begin their exploration of Universal Acceptance.  Background Concepts Domain Names A domain name is a human-friendly identifier for computers and networks on the Internet. It is customarily represented as a sequence of text labels separated by “dots” (the period or full-stop punctuation mark); for example, www.example.tld. Each label represents a level in the Domain Name System (DNS) hierarchy. At the highest level or “root” of the hierarchy are top-level domain (TLD) labels such as com, jp, and বাাংলা, which appear at the end of a domain name. Because they appear at the end, TLDs are sometimes called “suffixes.” Proceeding down the DNS hierarchy from the root, the next label identifies a subdomain of the TLD, commonly called a second-level domain; the label after that identifies a subdomain of the second-level domain, commonly called a third-level domain; and so on, with each of the labels separated from its neighbor by a dot. For example, a domain name with three levels might look like this: Country Code Top-level Domains (ccTLDs) Some TLDs are delegated to specific countries or territories. These are called country code top-level domains (ccTLDs). In the past, all ccTLDs were two letters matching the ISO 3166 two-letter code assigned to the country or territory by the International Organization for Standardization. Since 2010, there have also been internationalized ccTLDs that represent the name of a country or territory in that country or territory’s own script. Generic Top-level Domains (gTLDs) Most TLDs that are not ccTLDs are called generic top-level domains (gTLDs), which are either open to anyone or restricted to the members of a defined community. These include the familiar .com, .net, and .org as well as more recent additions. Through the New gTLD Program – an initiative coordinated by ICANN – the Domain Name System (DNS) has expanded exponentially through the introduction of new generic top-level domains. These new gTLDs can represent brands, communities of interest, geographic areas (cities, regions), and more.  Domain Name Internationalization Domain names were originally limited to a subset of ASCII characters (letters a-z, digits 0-9, and the hyphen “-“). Since the earliest .com registration, symbolics.com in 1985, the number and characteristics of domain names have expanded to reflect the needs of the everincreasing global use of the Internet as a communal resource. Today, the majority of Internet users are non-English speakers; however, the dominant language used on the Internet is English. To help with the internationalization of the Internet, in 2003 the Internet Engineering Task Force (IETF) started releasing standards providing technical guidelines for the deployment of Internationalized Domain Names (IDNs) through a translation mechanism to support non-ASCII representations of domain names in any Unicode-supported script (e.g., 普遍接受-测试.世界, ua-test.‫كاثوليك‬,etc.). The ICANN Board of Directors approved the process to introduce new IDN ccTLDs in October 2009, with the first IDN ccTLDs added to the root zone in May 2010. In June 2011, the Board approved and authorized the launch of the New gTLD Program, which included new ASCII as well as IDN TLDs. The first batch of TLDs from this program was added to the root zone in 2013. The Need for Universal Acceptance (UA) A decade after the IETF released its IDN-related guidelines, and through the ICANN New gTLD Program, more than 1,000 new TLDs are now active. However, some software and applications remain outdated and are unable to handle these new TLDs. This causes problems for Internet users, including those who use non-ASCII characters and scripts. Universal Acceptance ensures that all valid domain names and email addresses are accepted, validated, stored, processed, and displayed correctly and consistently by all Internet-enabled applications, devices, and systems. For example, every valid web address resolves to the expected resource on the correct website and every valid email address results in mail delivery to the expected recipient. The Universal Acceptance Steering Group (UASG) is an Internet community initiative, supported by ICANN, that is tasked with undertaking activities that will effectively promote Universal Acceptance and help ensure a consistent and positive experience for Internet users globally. U-labels and A-labels Domain names that use non-ASCII characters are called Internationalized Domain Names (IDNs). The internationalized portion of a domain name can be in any label—not just the TLD. Since the DNS itself previously only used ASCII, it was necessary to create an additional encoding to allow non-ASCII Unicode code points to be represented as ASCII strings. The algorithm that implements this Unicode-to-ASCII encoding is called Punycode; the output strings are called A-Labels. A-Labels can be distinguished from an ordinary ASCII label because they always start with the following four characters: xn--  These characters are called the ACE prefix.1 The Punycode transformation is reversible: it can transform from Unicode to an A-Label and from an A-label back to a string of Unicode characters (known as a U-Label). The only standard use of the Punycode algorithm is for expressing internationalized domains. While one could hypothetically encode other UTF-8 strings using Punycode, that would be non-standard and would not interoperate with other systems. Examples of (imaginary) IDNs U-label version A-label version example.みんな example.xn--q9jyb4c 大坂.info xn--uesx7b.info みんな.大坂 xn--q9jyb4c.xn--uesx7b Email Address Internationalization (EAI) Email addresses contain two parts: ▪ ▪ A local part (before the “@” character). A domain part (after the “@” character). Because both left-to-right (LTR) and right-to-left (RTL) scripts can be used in email addresses and domain names, “before” and “after” should be understood with respect to the directionality of the script. Examples of (imaginary) EAI Addresses user@example.みんな Uses IDN TLD user@大坂.info Uses IDN second-level domain 用戶@example.lawyer Uses Unicode local part and new gTLD ASCII Compatible Encoding (ACE) prefix which distinguishes Punycode-encoded labels from other ASCII labels. 1  Example of Right-to-Left text in an EAI Address LTR RTL In an internationalized email address, the domain part can contain any domain name, including those with new TLDs, and can contain Unicode U-labels. The local part is not a domain name and can in principle contain nearly any Unicode character, although in practice mail systems will limit the characters used in their mailbox names. The term Email Address Internationalization (EAI) is often used to describe the use of internationalized addresses in email. Dynamic Link Generation (Linkification) Modern software such as popular word processing or spreadsheet applications sometimes allows a user to create a hyperlink simply by typing in a string that looks like a web address, email address, or network path. For example, typing “www.icann.org” into an email message may automatically result in a clickable link to  if the app recognizes “www.” as a special prefix or “.org” as a special suffix. When it is used, linkification should work consistently for all well-formed web addresses, email addresses, or network paths, and not just some. Accurate linkification is difficult and depends on the context of the text (for example, in some languages “www” doesn’t indicate a web address), so it is not further addressed here. The Dynamic Nature of the Root Zone Registry The DNS is a large distributed database divided into sections called zones. The section that contains all TLDs is called the root zone because it is conceptually at the root of the tree of DNS names. All DNS zones, including the root zone, are updated as required. As new TLDs are added or old TLDs are retired, their names are added to or removed from the root zone. This means that any fixed list of TLDs, such as a list stored in an application or in a file, will eventually and inevitably become out of date. To reliably validate the TLD in a domain name, software can check it online with a DNS query, or if it uses a file, refresh the file on a regular basis. These are both described in more detail later.  Universal Acceptance in Action Five Criteria of Universal Acceptance Universal Acceptance is the state in which all valid domain names and email addresses are accepted, validated, stored, processed, and displayed correctly and consistently by all Internet-enabled applications, devices and systems. The five criteria of Universal Acceptance are described below. 1. Accept2 Accepting occurs whenever an email address or a domain name is received as a string of characters from a user interface, from a file, or from an API used by a software application or online service. Applications and services allow domain names and email addresses to be: ▪ Entered via user interfaces, or ▪ Received from other applications and services via APIs. 2. Validate3 Validation may occur in many places whenever an email address or a domain name is either received or emitted as a string of characters by an application or online service. Validation is intended to ensure that the entered information is either valid or at least definitely not invalid. Validation ensures the information has the correct syntax and may make other checks. For domain names and email addresses, many programmers have traditionally relied on ad hoc validation methods such as checking that a TLD is within length limits, or that the characters are from the ASCII character set. However, these methods are based on assumptions that are no longer applicable because the Internet is changing: ▪ ▪ ▪ Domain names and email addresses can now include nonASCII Unicode characters. The list of TLDs is changing. Any label in a domain name, including the TLD label, can be up to 63 characters long.4 It remains possible to validate TLDs using other techniques, as described later. Accepting is treated as distinct from Validating in this document. In practice, the actions may overlap. 3 Accepting and Processing are treated as distinct from Validating in this document. In practice, the actions may overlap. 4 The 63-character length limit applies to the label itself if it is an ASCII label, or to the A-label form of the label if it is an IDN. 2  3. Store Storage occurs when an email address or a domain name is stored as a string of characters in a database or file used by a software application or online service and later retrieved by the same or other software applications. Applications and services might require long-term and/or transient storage of domain names and email addresses. Regardless of the lifetime of the data, it must be stored in: ▪ ▪ Formats defined by an Internet-standard Request for Comments (RFC), or (less desirably) Alternative formats that can be translated to and from RFCdefined formats. Although Unicode in DNS names and email addresses are stored as UTF-8, other formats may be encountered in legacy code. See the Good Practices section below. 4. Process5 Processing occurs when an email address or a domain name is used by an application or service to perform an activity such as searching or sorting a list, or is transformed into an alternative format (such as turning U-labels into A-labels). Additional validation may occur during processing. The ways in which email addresses and domain names may be processed is limited only by the imagination of application developers, but it is important not to make assumptions (e.g., that email addressed to pākehā@tetaurawhiri.govt.nz is intended for a person in New Zealand) that depend on policies outside of the DNS. 5. Display The Display action occurs when an email address or a domain name is rendered within a user interface. Displaying domain names and email addresses is usually, but not always, straightforward when the scripts used in the name or address are supported in the underlying operating system and when the strings are stored in Unicode.6 If these conditions are not met, application-specific transformations may be required. Further, even if the underlying operating system does support the strings, display can be complicated if, for example, RTL and LTR scripts are mixed, or the overall directionality of text is unclear. Processing is treated as distinct from Validating in this document. In practice, the actions may overlap. 5 It is important to recognize that display is not straightforward, even when these conditions are met for some complex scripts. 6  User Scenarios The examples and definitions above may give the impression that Universal Acceptance is only about computer systems and online services. The reality, however, is that it’s also about the people using those systems and services. Below are some examples of activities that require Universal Acceptance: Registering a new TLD An organization adopts a “brand” TLD to offer its customers a differentiated customer experience by providing email addresses in the format: customername @example.brand. Universal Acceptance means: ▪ Web sites and applications accept these “@example.brand” email addresses as they would with older TLDs such as .com, .net, .org. Accessing a gTLD A user accesses a website whose domain name contains a new TLD by typing an address into a browser or clicking a link in a document. Universal Acceptance means: ▪ Even though the TLD is new, the user’s browser displays the web address in its native form and accesses the site as the user expects. The browser does not display domain names as A-labels to the user unless it benefits the user in some way. Using an email address containing a new gTLD as an online identity A user acquires an email address with the domain portion using a new gTLD and uses this email address as their identity for accessing their bank and airline loyalty accounts. Universal Acceptance means: ▪ Even though the domain used in the email address is new, the bank or airline site accepts the address the same way in which it accepts an address in an older TLD such as .biz or .eu. Accessing an IDN A user accesses an IDN URL by typing the URL into a browser or clicking a link in a document. Universal Acceptance means: ▪ Even if the domain name contains characters different than the language settings on the user’s computer, any browser the user wishes to use will display the web address as expected and access the site successfully.  Using an internationalized email address for email A user has acquired a new email address which includes non-ASCII characters in the domain name (e.g., īnfo@普 遍接受-测试.世界). Universal Acceptance means: ▪ The user can send to and receive from any email address, using any email client. Using an internationalized email address as an online identity A user acquires a non-ASCII email address and uses this email address as their identity for accessing their bank and airline loyalty accounts. Universal Acceptance means: ▪ The bank or airline site accepts the new identity exactly as if it were any other email identity. Dynamically creating a hyperlink in an application A user types a web address into a document or email message. Universal Acceptance means: ▪ The rules used by the application to automatically generate a hyperlink are the same if the address is non-ASCII or contains a new TLD. Developing an application A developer writes an app that accesses web resources. Universal Acceptance means: ▪ The tools used by the developers include libraries that enable Universal Acceptance by supporting new TLDs and IDNs. Nonconformance to Universal Practices The following are considered to be poor practice: ✖ Displaying A-labels to the user without a corresponding user benefit, such as to show the mapping between a U-label and a A-label. ✖ Requiring a user to enter A-labels when signing up for a new email address or requiring a user to enter A-labels when signing up for a new hosted domain. ✖ Validating the syntax of domain name or email address using out of date criteria or non-authoritative online domain name resources. ✖ Using an outdated list of TLDs even though new TLDs are regularly being added and deleted. ✖ Exposing internal use of A-labels to users. For example, converting domains in EAI addresses to A-labels when replying to an EAI user.  ✖ Treating some domain names as search terms rather than as domain names because the application does not recognize them as such. ✖ Setting spam blockers to automatically block entire (new) TLDs without evidence of abuse. Technical Requirements for UA Readiness For an application or website to be UA-ready, it must meet a variety of requirements. High-Level Requirements An application or service that supports Universal Acceptance (UA): 1. Supports all domain names regardless of length or character set. See RFC 5892. 2. Allows all of the character sets that are valid for domain names and email addresses. Accept Unicode code points as well as ASCII. 3. Can correctly render all code points in Unicode strings. See RFC 3490. Note that Unicode regularly adds new code points, so this is a moving target. 4. Can correctly render right-to-left (RTL) strings such as those in Arabic and Hebrew. For information about RTL scripts, see RFC 5893. 5. Can communicate data between applications and services in UTF-8 and, where needed, other encodings that can be converted to and from UTF-8. For information about UTF-8, see RFC 3629. 6. Offers public and private APIs that support UTF-8. Private APIs apply only to inter-service calls by the same vendor. 7. Treats EAI addresses correctly. In particular, doesn’t convert IDNs in addresses to A-labels. 8. Can send email to and receive email from recipients regardless of domain name or character set. See RFC 6530.  9. Stores user data in formats that support Unicode and is convertible to and from UTF-8. Such conversions would be visible only to the operator of the product or service. 10. Supports all top-level domain names in the authoritative ICANN TLD list regardless of length or character set. See the authoritative list at  Developer Considerations Since many existing software systems contain hardcoded assumptions about domains and email addresses, code changes may be required to recognize IDNs, new TLDs, and EAI mail addresses. This section discusses how developers can incorporate code changes that will enable Universal Acceptance. Designing Software for Compatibility and Flexibility The Robustness Principle, as articulated by Jon Postel in RFC 793, is a general design guideline for software development: “Be conservative in what you do; be liberal in what you accept from others.” That is, be conservative in what you send: in any area in which a specification might be ambiguous or unclear, avoid anything that could surprise others. On the other hand, when receiving, accept anything that is plausibly valid. This does not mean changing code to work around clear mistakes in other implementations since that leads to an undocumented and “undebuggable” mess. Good Practices for Developing and Updating Software to Achieve UA-Readiness Accept ✔ Display names as Unicode whenever possible. Users should be allowed, but not required, to enter domain names as A-labels rather than U-labels. However, U-labels should be shown by default, with Alabels shown to the user only when it provides a benefit. ! Don’t generate EAI addresses with A-labels but do be able to handle them if presented by someone else’s software. ✔ Any user interface element requiring a user to type a domain name or email address must accept long names. ASCII domain names can have up to 63 characters in each label and can be in total up to 253 bytes. UTF-8 labels can be much longer than ASCII labels and the total length can be up to 670 bytes.  Remember that the UTF-8 code for most Unicode code points takes more than one byte. ▪ See RFC 1035. Validate ✔ Validate only as appropriate. Validate only if it is required for the operation of the application or service. This is the most reliable way to ensure that all valid domain names are accepted into your systems. ✔ Recognize that syntactically correct inputs may represent domain names or email addresses that are currently in use on the Internet. That may or may not be valid depending on the application. ! When you validate, consider the following: ▪ Verify the TLD portion of a domain name against an authoritative table. IANA publishes the list of top-level domains at:    See also:  ▪ Query the domain name against the DNS.  The GETDNS API  is a highly portable way to query the DNS.  Most operating systems also have a native DNS query API. ▪ Require repeated entry of an email address to detect typing errors. ▪ Validate the characters in labels by checking that each label follows the Internationalizing Domain Names in Applications (IDNA 2008) rules.  See RFC 5892 ▪ Limit validation of labels itself to a small number of whole-label rules defined in the RFCs.  See RFC 5894 ▪ Ensure that the product or feature handles numbers correctly.  For example: Arabic-Indic digit characters should be treated as numbers in numeric input fields, as well as ASCII digits.  Note that Arabic-Indic digits are valid in U-labels but are not considered equivalent to ASCII digits in that context.  Store ✔ Applications and services should support the most current Unicode standards. ✔ Information should be stored in the UTF-8 format whenever possible. Some systems may require legacy support for UTF-16 as well, but generally UTF-8 is preferred. UTF-7 is obsolete, and UTF-32 is too bulky for file storage. The strings should be normalized when appropriate (some normalization can in some context result in loss of information). ! Consider all end-to-end scenarios before converting between A-Labels and ULabels when storing. In new applications, it is better to maintain only U-Labels in a file or database, because it simplifies searching, sorting, and presentation. However, conversion may have implications when interoperating with older, non-Unicode-enabled applications and services. ✔ Tag email addresses and domain names as such in storage for easier access. Filing email addresses and domain names in the “author” field of a document or “contact info” in a log file have led to the loss of the original address. ✔ Regardless of the way addresses and domain names are stored, you must be able to match strings in multiple formats. For example, a search for example.みんなshould also find example.xn-q9jyb4c. Process ✔ Ensure all web server and MIME mail responses have UTF-8 specified in the content type. ✔ Specify UTF-8 in the web server http header. ▪ It is important to ensure that the encoding is specified on every response. ! Consider context before converting A-Labels to U-Labels and vice versa during processing. It is desirable to maintain only U-Labels in a file or database as it simplifies searching and sorting. However, conversion may have implications when interoperating with older, non-Unicode-enabled applications and services.  ✔ Ensure that the product or feature handles sort order, searches, and collation according to locale and language specifications, and that it addresses multilanguage searching and sorting. ✖ Don’t use percent encoding for labels in domain names: ▪ example.みんな is correct ▪ example.%E3%81%BF%E3%82%93%E3%81%AA is not correct. ✔ Since the Unicode standard is continually expanding, code points not defined when the application or service was created should be checked to ensure they don’t produce erroneous or confusing output. Missing fonts in the underlying operating system may result in non-displayable characters (frequently a small box is used to represent these), but this situation should not result in a crash or error message. ✔ Use supported Unicode-enabled APIs. ✔ Use the latest Internationalized Domain Names in Applications (IDNA 2008) Protocol and Tables documents for IDNs: ▪ RFC 5891 ▪ RFC 5892 ✔ Process text in UTF-8 format wherever possible. ✔ Coordinate upgrades of applications and the services they depend on. If the server is Unicode and client is non-Unicode, or vice versa, the data will need to be converted in every transaction, which is error prone and can be slow. ✔ When doing character transformation, text strings may grow or shrink substantially. Each UTF-8 code point may be from 1 to 4 bytes, and in some cases a single character in another encoding may correspond to several UTF-8 code points or vice versa. Display ✔ Display all Unicode code points that are supported by the underlying operating system. Modern operating systems all have Unicode support, but their rendering engines are not always correct for all scripts and languages. Provide character rendering in applications only when correct rendering is not available from the target operating system(s). ✔ When developing an app or a service consider the languages supported and make sure operating systems and applications cover those languages.  ✔ Convert A-labels to U-labels before display. For example, the end user should see “example.みんな” rather than “example.xn--q9jyb4c”. (This conversion is an example of UA-ready processing). ✔ Display domain names as U-labels by default. Display A-labels to the user only when it provides a benefit. ! Be aware that mixed-script domain names are possible. ▪ Some Unicode characters may look the same to the human eye, but different to computers; for example, Latin O, Cyrillic O, and Greek omicron O. ▪ Mixed-script strings are common in closely related scripts (e.g., Japanese Kanji, Katakana, Hiragana, and Romaji.) Otherwise mixed scripts may be intended for malicious purposes, such as phishing. Use Unicode Technical Standard #39, Unicode Security Mechanisms,7 to check that the scripts in a Unicode sequence follow good practice. ▪ If the user interface calls the strings to the user’s attention, be sure that it does so in a way that is not prejudicial to users of non-Latin scripts. Learn more about Unicode Security Considerations at:  ✔ Be aware of unassigned and disallowed characters for domain names. ▪ See RFC 5892 Unicode 7 ✔ Use supported Unicode-enabled APIs. ✖ Use standard, well-debugged APIs for: ▪ String format conversions. ▪ Determining which script comprises a string. ▪ Determining if a string contains a mix of scripts. ▪ Unicode normalization/decomposition. See   ✖ Don’t use UTF-7 and limit the use of UTF-32. ▪ UTF-7 is obsolete. ▪ UTF-32 uses four bytes for each code point. Since each code point takes the same amount of space and can be directly indexed in arrays, it’s convenient to use within program code, but may be too bulky for storage in files and databases. ✖ Don’t use UTF-16 except where it is explicitly required (as in certain Windows APIs, and Javascript applications). In UTF-16, 16 bits can only represent characters from 0x0 to 0xFFFF. Values above this range (0x10000 to 0x10FFFF) use pairs of pseudo-characters known as surrogates. If handling of surrogate pairs is not thoroughly tested, it may lead to tricky bugs and potential security holes. ✔ Use UTF-8 in cookies so they can be read correctly by applications. ✔ Use IDNA 2008 Protocol and Tables documents: ▪ RFC 5891 ▪ RFC 5892 ✖ Do not use IDNA 2003 which has been superseded by IDNA 2008. ! Maintain IDNA and Unicode tables that are consistent with regard to versions. For example, unless the application actually executes the classification rules in the Tables document to interpret code points as entered (RFC 5892), its IDNA tables must be derived from the version of Unicode that is supported on the system. The tables do not need to reflect the latest version of Unicode, but they must be consistent. ✔ Validate labels using IDNA 2008 whole-label rules. ▪ In some contexts, further validation may be appropriate; for example, if the application knows what scripts are allowed in the domain names it uses. General ✔ Use authoritative resources to validate domain names. Do not make outdated ad hoc assumptions, such as “all TLDs are 6 characters or shorter.” ✔ Ensure that the product or feature handles numbers correctly. For example, ASCII numerals and Asian ideographic number representations should all be treated as numbers in numeric contexts.  ! Look for mail addresses that may be EAI addresses in unexpected places: ▪ Artist/author/photographer/copyright metadata. ▪ Font metadata. ▪ DNS contact records. ▪ Binary version information. ▪ Support information. ▪ OEM contact information. ▪ Registration, feedback, and other forms. ! Restrict the code points allowed when generating new domain names and email addresses: All products that use email addresses must accept internationalized email addresses, allowing most UTF-8 printing characters in the local part. However, an app or service need not allow all of these characters when a user creates a new IDN or EAI address. Preventing certain IDNs or email addresses from being created in the first place can mitigate some likely security and accessibility concerns. (NOTE: Good practice would still require software to accept such strings if presented.) ! Be aware that Universal Acceptance cannot always be measured through automated test cases alone. For example, testing how an app or protocol handles network resource may not always be possible and sometimes it is best to verify the compliance through functional spec and design review. ! Don’t assume that because a component does not directly call name-resolution APIs or directly use email addresses, it does not affect it. Understand how domain names are obtained by the component—it is not always through user interaction. The following are some examples on how the component can get a domain name: ▪ Group policy. ▪ LDAP query. ▪ Configuration files. ▪ Windows Registry. ▪ Transferred to or from another component or feature. ✔ Perform code reviews to avoid buffer overflow attacks. ▪ In Unicode, strings may expand or shrink when case folded or normalized. ▪ When doing character conversion, text may grow or shrink substantially. Other challenges  Mechanism to detect and convert character sets Some older email applications used local character encodings and did not have a way to detect and convert text to and from UTF-8 as needed. This was especially true for the email headers (TO, CC, BCC, Subject). Managing multiple email addresses as a single user identity When a user has multiple email addresses it may be tricky to manage these addresses as a single user identity. Email programs can direct traffic addressed to such aliases to the same mailbox, but applications may still treat the addresses as different identities. Authoritative Sources for Domain Names: DNS Root Zone and IANA Lists There are two sources for the authoritative list of TLDs. The first source is the DNS root zone itself. It is Domain Name Security Extensions (DNSSEC)-signed, so its contents can be authenticated by a DNSSEC-aware name server, although its contents are fairly hard to parse as a text file. Another source is the text file of TLDs that IANA publishes (one TLD per line in alphabetical order). These files are on https web servers, so it is good practice to check that the site’s Transport Layer Security (TLS) certificate is valid when downloading to be sure you’re getting the right file. You can obtain the list of TLDs from either of the following links: ▪ ▪  (root zone file)  (text TLD file) Email with IDNs and Why It Is Not the Same as EAI Email Address Internationalization (EAI) mail prefers UTF-8 domain names; ASCII coded ALabels are discouraged. Some mail systems have made partial provisions for email addresses that include IDNs rather than provide full EAI support. Because IDNs can be represented as ASCII A-labels, some existing software allows the IDNs in an email address to be represented in ASCII or Unicode. For example, some software will treat these two IDN addresses equivalently for all purposes (sending, receiving, and searching): user@example.みんな = user@example.xn--q9jyb4c However, some software will not treat these addresses as equivalent even though both are valid, because it does not convert an A-label ( “xn--q9jyb4c”) into its U-label equivalent (“み んな”) before comparing. This can result in an unpredictable user experience. The user experience may become especially confusing if some software converts U-labels into Alabels for “compatibility.” As the messages are replied-to or forwarded, the addresses that are visibly different to a user, or which fail to search and sort as expected, may increase. As in the example below, some software may attempt to convert the local part of the email address using Punycode, the algorithm that is used to convert A-labels into U-labels (and vice versa). This sort of conversion is invalid and will create invalid, undeliverable addresses.  Never try to convert the local part of an email address into a different form ✔ 用戶@example.みんな ✖ xn--youq53b@example.xn--q9jyb4c Robust UA-ready software and services should be able to handle and treat all these formats correctly and should be able to handle both UTF-8 local parts and UTF-8 U-labels in addresses, while also accepting A-labels in addresses for backward compatibility. Linkification and Its Challenges Modern software sometimes allows a user to automatically create a hyperlink simply by typing in a string that looks like a web address, email name, or network path. For example, typing “www.icann.org” into an email message may automatically result in a clickable link to  if the application recognizes “www.” as an initial label or “.org” as a TLD. Linkification is the action whereby an application accepts a string and dynamically determines whether it should create a hyperlink to an Internet Location (http:// or  or an email address (mailto:). Linkification, if it happens, should work consistently for all wellformed web addresses, email names, and network paths. Linkification uses algorithms and rules created by software developers to determine whether or not a string should be interpreted as a link. Related to this is how people can identify a string as a domain name. While browsers, email clients, and word processors are obvious places, there are many more applications that make these decisions. Good Practice Recommendations 1. Attempt to linkify based on explicit protocol prefixes (e.g. “ ftp://”, “mailto:”) but only complete the action if the rest of the string is well-formed. Example String Expected Behavior/ Result example.com No linkification because protocol is absent and not inferred.  Create hyperlink because protocol is explicit. http:example.com No linkification because of bad syntax (missing //).  No linkification because “a” is not a TLD.  No linkification because of bad syntax (consecutive dots).  Create hyperlink because protocol is explicit. 2. Attempt to linkify based on implicit protocol prefixes (e.g. “www” infers “  Example String Expected Behavior/ Result www.example.com Create hyperlink because protocol is implied8 label@example.com Create mailto: label@example.com because protocol is implied. 3. The HTML surrounding URLs that contain bidirectional text may include codes that affect the direction in which text is displayed. The linkified version should keep the same display direction. 4. If TLDs are used as a “special token” to determine linkability, then all TLDs must be included. A list of TLDs should be updated on a frequent basis. Unicode—Background and Code Point Attributes The Unicode standard has been evolving since it was first published as Unicode 1.0 in 1991. Each version since has added more characters and code points to handle more languages and scripts. The current version is 12.1. In Unicode, every code point has a set of properties, such as Uppercase_Letter, Decimal_Number, or Nonspacing_Mark. Many characters have a script property such as Latin, Han (Chinese), or Arabic, while others, such as punctuation, do not. As described below, IDNA uses code point attributes to determine which characters are allowed in IDNs. UAX#44, Unicode Character Database, describes the database of code point attributes. UTF8, UTF16, and Other Encoding Methods A Unicode code point can have a numeric value ranging from zero to 0x10FFFF. Since a single byte can hold only values from 0 to 0xFF, some sort of multi-byte encoding is needed to store Unicode code points. The original version of Unicode had fewer than 64K (0xFFFF) code points, so each code point could fit in a 16 bit integer. This led to a two-byte encoding known as UCS or UCS-2. When Unicode expanded past 64K code points, UCS was extended into UTF-169, which uses pairs of otherwise invalid 16-bit code points known as surrogates to represent values greater than 64K. While this works, it has led to debugging problems since surrogates add complexity to any code that counts the number of code points in a string, or that sorts strings into code point order. An additional problem is that some computers such as those made by IBM store the high byte of a 16-bit value first (“big-endian”), and some such as those made by Intel store the low byte first (“little-endian”). As a result, UTF-16 has two storage variants: Note: the actual website might be https-only and require https:// instead of  If this is the case, then the hyperlink may not resolve. 8 See section 3.10 of the Unicode standard for technical details of UTF-8, UTF-16, and UTF-32, at  9  UTF-16BE and UTF-16LE. There are techniques to detect and fix endian problems but they can lead to bugs. At this point, UTF-16 is primarily used in existing applications with Microsoft Windows APIs, and the Java and Javascript languages. An alternative encoding is UTF-8, which encodes each code point as a variable length string of one to four bytes. UTF-8 has several advantages over UTF-16, including that the ASCII subset of Unicode is encoded as a single byte so any ASCII string is automatically a UTF-8 string. UTF-8 is usually more compact than its UTF-16 equivalent, and is easier to sort because UTF-8 strings sorted in byte order are automatically in code point order. IDNA and EAI all require UTF-8 coding. UTF-32 is a simple format that stores each code point in a 32-bit integer. It is convenient for internal processing in programs since the code points in an array of UTF-32 can be indexed directly, but it is rarely used in storage because of its bulk. IDNA – A Brief History and Current State Internationalized Domain Names in Applications (IDNA) was first defined by the IETF in 2003 as what is now known as IDNA200310. It included an algorithm to map Unicode code points into a standard form in domain name labels known as Nameprep, and an algorithm to encode Unicode code point labels in ASCII known as Punycode. Nameprep includes transformations such as mapping upper to lower case. After some experience with IDNA, the IETF developed and published a revised spec known as IDNA2008 in 201011. IDNA2008 created the terms U-label and A-label and removed the Nameprep step, advising that applications should do a mapping appropriate for the locale and application environment. IDNA2008 was updated for Unicode 6.0 by RFC 6452 in 2011 and continues to be reviewed by the IETF. In practice, too many implementations are still using IDNA2003. A few libraries do use tables (like the ones included in IDNA2003) created for IDNA2008. No locale mappings exist for IDNA2008 except the standard case folding and normalization rules included in the Unicode Standard. One exception is that there are a few mappings from UTS#46, Unicode IDNA Compatibility Processing. This specifies whether a few common characters that are mapped in IDNA2003 but allowed as characters in IDNA2008 should be accepted or mapped. It is important for applications to treat these characters according to IDNA2008 and not IDNA2003, and that if UTS#46 is in use, it is used in a way that is compatible with IDNA2008. Use Cases for Testing Software that is intended to handle IDNs and EAI mail addresses should be tested with a wide range of domain names and addresses. See UASG 004, Use Cases for UA Readiness Evaluation, for a set of test cases. 10 11 The definition is in RFCs 3490, 3491, and 3492. The definition is in RFCs 5890, 5891, 5892, 5893, 5894, and 5895.  Upgrading Software for EAI EAI conformance requires upgrades to mail servers, submission and delivery software, mail user agents and web mail, and any application that handles email addresses and sends mail. For a detailed overview of EAI, its issues, and how to implement it, see UASG 012, Email Address Internationalization (EAI): A Technical Overview. Advanced Topics Complex Scripts The details of complex scripts may be of limited interest to those who are not developers creating their own string parsing or display libraries. Nevertheless, a summary is included here to ensure that all readers have sufficient awareness to recognize code bugs related to these scripts when encountered in user experiences. For formatted HTML text in web pages and email, the HTML standards have elaborate features for handling and displaying complex and bidirectional text, which developers should understand and use to render text. See the WHATWG HTML standard section on rendering12, and the corresponding section of the W3C HTML standard13. Right-to-Left Languages and Unicode Conformance Some scripts, such as Latin and Devanagari, display characters from left to right when text is presented in horizontal lines. Other scripts, such as Arabic or Hebrew, display characters from right to left. The text can also be bidirectional when a right-to-left script uses digits that are written from left to right or when it uses embedded words from English or other languages that are written using left-to-right scripts. Challenges and ambiguities can occur when the horizontal direction of the text is not uniform. To solve this issue, there is an algorithm to determine the directionality for bidirectional Unicode text. There is a set of rules that should be applied by the application to produce the correct order at the time of display which are described by the Unicode Bidirectional Algorithm. We generally refer to this as the “Bidi algorithm”. The Bidi Algorithm The Bidi algorithm describes how software should process text that contains both left-to-right (LTR) and right-to-left (RTL) sequences of characters. The base direction14 assigned to the Available at  Available at  14 In HTML the base direction is either inherited from the default direction of the document, which is left-to-right, or explicitly set by the nearest parent element that uses the “dir” direction attribute. 12 13  phrase will determine the order in which text is displayed. This can be either left-to-right or right-to-left and defines the order in which sequences of characters are displayed. In this document, the base direction is left to right so all sequences of characters are displayed with the first sequence to the left of the second sequence. To know if a sequence is left-to-right or right-to-left, each character in Unicode has an associated directional property. Most letters are strongly typed (strong characters) as LTR (left-to-right) or RTL (right-to-left) depending on the script of which they are a part. A sequence of strongly typed RTL characters will be displayed from right to left. This is independent of the surrounding base direction. For example: (LTR) example - ‫( مثال‬RTL). Text with different directionality can be mixed in line. In such cases, the Bidi algorithm produces a separate directional run out of each sequence of contiguous characters with the same directionality. Spaces and most punctuation are not strongly typed as either LTR or RTL in Unicode because they may be used in either type of script. They are therefore classified as neutral or weak characters. Weak characters are those which are generally used in one direction, but in some contexts may be used in the other. Examples of this type of character include: ▪ ▪ ▪ ▪ European digits. Eastern Arabic-Indic digits. Arithmetic and currency symbols. Punctuation symbols that are common to many scripts, such as the colon, comma, full-stop, and the no-break space. The directionality of neutral characters is indeterminate without context. Some examples include: ▪ Tabs. ▪ Paragraph separators. ▪ Most other whitespace characters. When a neutral character is between two strongly typed characters that have the same directional type, it will also assume that directionality. For example, a neutral character between two RTL characters will be treated as an RTL character itself, and will have the effect of extending the directional run: ▪ ‫مثال‬.‫نطاق‬ Even if there are several neutral characters between the two strongly typed characters, they will all be treated in the same way. When a space or punctuation falls between two strongly typed characters that have different directionality, the neutral character(s) will be treated as if it has the same directionality as the prevailing base direction. For example: ▪ example. ‫مثال‬  Remember that this document has left to right as its base sequence so example is the second level domain and ‫ مثال‬the TLD. Unless a directional override is present, numbers are always encoded and entered highorder digit first, and the numerals rendered LTR. The weak directionality applies only to the placement of the number in its entirety. The full details of the Bidi algorithm are described in Unicode Technical Report #9. The Bidi Rule for Domain Names A Bidi domain name is one that contains at least one RTL label. The Bidi rule for domain names, specified in RFC 589315, limits the code points in names so that there are no two names that are different sequences of code points but display the same due to bidirectional display rules. Joiners Some languages use alphabetic scripts in which single phonemes are written using two characters called a digraph. In other words, a digraph is a group of two successive letters that represent a single sound (or phoneme). Examples of digraphs in English ch (as in church) ph (as in phony) th (then) th (think) sh (shoe) gh (rough) Some digraphs are fully joined as ligatures. In writing and typography, a ligature occurs where two or more graphemes or letters are joined as a single glyph. An example is the ampersand character (&), which evolved from the adjoined Latin letters e and t (“et” means “and”). In typeset English, fi and ffi often are displayed as ligatures. If ligatures and digraphs have the same interpretation in all languages that use a given script, Unicode normalization generally resolves the differences and makes them match. When they have different interpretations, matching must use alternative methods (likely chosen at the registry level) or users must be educated to understand that matching will not occur. An example of different interpretation can be found in Section 4.3 of RFC 5894 16. The Unicode Consortium lists two main strategies to determine the joining behavior of a particular character after applying the Bidi algorithm to deal with zero width joiner characters known as ZWJ and ZWNJ. (To learn more about these joiners see  Right-to-Left Scripts for Internationalized Domain Names for Applications (IDNA), RFC 5893,  16 Internationalized Domain Names for Applications (IDNA): Background, Explanation, and Rationale, RFC 5894,  15  ▪ ▪ When shaping, an implementation can refer back to the original backing store to see if there were adjacent ZWNJ or ZWJ characters. Alternatively, the implementation can replace ZWJ and ZWNJ by an out-of-band character property associated with those adjacent characters, so that the information does not interfere with the Bidi algorithm and the information is preserved across rearrangement of those characters. Once the Bidi algorithm has been applied, that out-of-band information can then be used for proper shaping. Domain name registries and any other entity that allows the creation of domain names (e.g. applications that create third- and lower-level labels) must follow the Bidi Rule for Domain Names to ensure that names will display consistently and to prevent confusing names that can be used for homograph attacks. To learn more about joiners, see Section 4.3 of RFC 5894. Homoglyphs and Similar Characters Homoglyphs are characters that, due to similarities in size and shape, appear identical or confusingly similar. They frequently occur when mixing Latin, Cyrillic, and Greek scripts. For example, Latin “o” (code U+006f), Cyrillic small letter “о” (code U+043e), and Greek small letter omicron “ο” (code U+03bf.) In some cases, there are homoglyphs in a single script, such as the small Croatian letter “ǉ” (code U+01c9) and the two letters “lj” (code U+006c U+006a). See the table at  for more examples. To prevent domain names with homoglyphs, registries should use Label Generation Rules (LGRs) that limit the code points in a label to a set from a single script or compatible scripts. Each registry should have LGRs for each script in which it accepts registrations17. To learn more about Unicode security mechanisms for confusable detection, see: ▪  To learn more about confusingly similar characters and good practice, see: ▪ ▪ M3AAWG Unicode Abuse Overview and Tutorial  M3AAWG Best Practices for Unicode Abuse Prevention  Normalization, Case Folding, and String Preparation Unicode Normalization helps to determine whether any two Unicode strings are equivalent to each other and provides standard forms to use to process and store strings. Some characters can be represented in Unicode by several code sequences. This is called Unicode equivalence. Unicode provides two types of equivalences: IANA has a collection of registry LGRs in its Repository of IDN Practices at  17  ▪ ▪ Canonical Compatibility Sequences representing the same visual character are called canonically equivalent. These sequences have the same appearance and meaning when printed or displayed. For example: U+006E (Latin lowercase “n”) followed by U+0303 (the combining tilde “◌̃”) =ñ U+00F1 (lowercase letter “ñ” of the Spanish alphabet) =ñ Unicode defines NFC (Normalization Form C) as Canonical Decomposition, followed by Canonical Composition. This reduces text to a minimal number of code points while not changing its appearance. It should be noted that in this example, three characters above are valid to be used according to IDNA2008. Compatibility equivalents are sequences which can appear different, but in some contexts the same meaning. It is a weaker type of equivalence between characters or sequences of characters. For example: U+FB00 (the typographic ligature “ﬀ”) = ff U+0066 U+0066 (two Latin “f” letters) = ff In the example above, the code point U+FB00 is defined to be compatible, but not canonically equivalent to the sequence U+0066 U+0066. Sequences that are canonically equivalent are also compatible, but the opposite is not always true. It should be noted that the code point U+FB00 is not valid according to IDNA2008. Unicode defines NFKC (Normalization Form KC) a Compatibility Decomposition, followed by Canonical Composition. This reduces text to a standard set code points and may change its appearance. For example, NKFC turns the ligature “ﬀ” into the two letters “f f” and the ante meridian symbol ㏂ (U+33C2) into the four characters “a.m.” (U+0061 U+002E U+006D U+002E.) To avoid interoperability problems arising from the use of canonically equivalent, yet different, character sequences, the W3C recommends using NFC for all text. To see a list of all characters that may change in any of the Normalization Forms, see:  Some other points to note: ▪ ▪ ▪ The characters in IDN labels must be in NFC form. When two applications share Unicode data, but normalize them differently, errors and data loss can occur. The Unicode consortium asserts that Normalization Forms must remain stable over time. In other words, a string must remain normalized under all future versions of Unicode for backward compatibility.  ▪ As pointed out earlier, be conservative when looking at what code points to allow in a domain name. Tips for software developers ✖ Don’t attempt to normalize by converting to uppercase or ignoring non-spacing characters, because this makes sorting, data copying import and export, and data retrieval by client applications difficult and may result in data loss or corruption. ✖ Never allow code points in domain names which are not allowed according to IDNA2008. To learn more about Unicode normalization, see: ▪  ▪  Case Folding and Mapping Case folding and mapping is the process of turning all of the characters in a string into the same case, usually lower case. Mapping upper case [A-Z] to lower case [a-z] works for ASCII-only text documents, but is far more complex in languages that use additional characters. Case mapping can be context-dependent, with the mapped character depending on the context in which it occurs, e.g., various forms of the Greek sigma. It can also be locale-dependent, with the mapped character depending on the locale in which the text is interpreted, e.g., Turkish dotted and undotted upper and lower case I. Case folding is localeindependent, for strings that will be interpreted by software, while case mapping is localedependent and is intended for text to be read by people. Finally, mapping to upper case and mapping to lower case are not inverse functions. For IDNs, IDNA2008 allows applications to use any appropriate case mapping because the mapping takes place before the validation of code points. In practice, locale-specific identifier mappings do not exist and everyone uses the mappings from Unicode’s UTS#4618. Tips for software developers 18 ✔ Consider the desired goal before attempting case mapping: is it a generic map for labels, a string in a known language, or something else? ✔ Perform Unicode Normalization before case folding. UTS#46, Unicode IDNA Compatibility Processing,   Glossary and Other Resources Glossary A-label The ASCII-compatible encoded (ACE) representation of a label in an Internationalized Domain Name, used internally within the DNS protocol. A-labels always begin with the ACE prefix “xn--”. An A-label can be converted to a U-label and back without loss of information. ACE prefix ASCII Compatible Encoding Prefix “xn--”. ASCII American Standard Code for Information Interchange. ASCII includes unaccented Latin characters and the EuropeanArabic digits. ASCII is a subset of Unicode: every ASCII character is also a Unicode character. API An Application Programming Interface (API) is a set of routines, protocols, and tools for building software and applications. An API may be for a web based system, operating system, or database system, and it provides facilities to develop applications for that system using a given programming language. Codespace Range that defines the lower and upper bounds for an encoding. Code point A code point is a numerical value in a code space. Code points are used to distinguish a numerical value from its encoding as a sequence of bits, and to distinguish an abstract character from a particular graphical representation of it (glyph). DNS Root Zone The root zone is the central directory for the DNS, which is a key component in looking things up in DNS; for example, translating host names into IP addresses. EAI Email Address Internationalization allows UTF-8 characters in an email address—the domain name, the local part, or both.  IANA ICANN Internet Assigned Numbers Authority. Its functions include: ▪ Management of the DNS Root, the .int and .arpa domains, and an IDN practices resource. ▪ Coordination of the global pool of IP and AS numbers, primarily providing them to Regional Internet Registries (RIRs). ▪ Internet Protocols’ numbering systems are managed in conjunction with standards bodies. ICANN's mission is to help ensure a stable, secure, and unified global Internet. To reach another person on the Internet, you need to type an address – a name or a number – into your computer or other device. That address must be unique so computers know where to find each other. ICANN helps coordinate and support these unique identifiers across the world. ICANN was formed in 1998 as a not-for-profit publicbenefit corporation with a community of participants from all over the world. IDN Internationalized Domain Name. IDNs are domain names that include UTF-8 characters beyond the twenty-six letters of the basic Latin alphabet “a-z”, the numbers 0-9, and the hyphen “-“. IDNA Internationalized Domain Names in Applications. IDN ccTLD Country code top-level domain that includes characters beyond the twenty-six letters of the basic Latin alphabet “a-z”. Examples: ▪ .рф (Russia) ▪ ‫صر‬. (Egypt) ▪ ‫السعودية‬. (Saudi Arabia) IETF The Internet Engineering Task Force (IETF) is a large open international community of network designers, operators, vendors, and researchers concerned with the evolution of the Internet architecture and the smooth operation of the Internet. It is open to any interested individual. The IETF develops Internet Standards, in particular, the standards related to the Internet Protocol Suite (TCP/IP) and the protocols used for the web like HTTP and TLS. Language The method of human communication, either spoken or written, consisting of the use of words in a structured and conventional way. Punycode An algorithm that represents UTF-8 in the limited character subset of ASCII supported by the Domain Name System (DNS). Punycode is used in A- labels in the Internationalized Domain Names in Applications (IDNA) framework.  Registrar An organization where domain names are registered by users. The registrar keeps records of the contact information and submits the technical information to a central directory known as the “registry”. Registry The authoritative, master database of all domain names registered in each top-level domain (TLD). RFC A Request for Comments (RFC) is a formal document from the Internet Engineering Task Force (IETF) that is the result of committee drafting and subsequent review by interested parties. Some (but not all) RFCs document approved Internet standards. Script The collection of letters or characters used in writing, representing the sounds of a language. Second-level domain name In the Domain Name System (DNS) hierarchy, a second-level domain (SLD or 2LD) is a domain that is directly below a toplevel domain (TLD). For example, in example.com, example is the second-level domain of the .com TLD. U-label A U-label is an IDNA-valid string of Unicode characters including at least one non-ASCII character. It can be converted to an A-label and back without loss of information. UA-ready software or UA-readiness Software that has the ability to accept, store, process, validate, and display all top-level domains, IDNs, and email addresses equally. Unicode A universal character encoding standard. It defines the way individual characters are represented in text files, web pages, and other types of documents. Unicode was designed to support characters from all languages around the world. It can support roughly 1,000,000 characters. See:  UTF Unicode Transformation Format. It is a way of representing Unicode code points as a stream of bytes. UTF-8 is the preferred UTF for handling IDN and EAI. UTF-8 converts Unicode to 8-bit bytes. M3AAWG The Messaging, Malware and Mobile Anti-Abuse Working Group (M3AAWG) is where the industry comes together to work against botnets, malware, spam, viruses, DoS attacks, and other online exploitation. See:  W3C The World Wide Web Consortium (W3C) is an international community where member organizations, a full-time staff, and the public work together to develop web standards like HTML. See:   WHATWG The Web Hypertext Application Technology Working Group (WHATWG) is a community of people interested in evolving the web through standards and tests. The WHATWG was founded by individuals of Apple, the Mozilla Foundation, and Opera Software in 2004, after a W3C workshop. See  ZWJ Zero-Width Joiner is non-printing character used in the computerized typesetting of some scripts, including Arabic and all of the Indic scripts. When placed between two characters that would otherwise not be connected, a ZWJ causes them to be printed in their connected form. ZWNJ Zero-Width Non-Joiner is a non-printing character used in the computerization of writing systems that make use of ligatures. For some languages and scripts, many of the letters of the alphabet naturally connect with the following letter when written in a word, forming a ligature. In order to correctly display certain prefixes, suffixes, and compound words, however, the ZWNJ is used to override this natural behavior of joining letters and prevent them from joining the following letter (but without adding a space between the two). For a complete ICANN glossary, go to:  RFCs and Key Standards IDN RFCs RFC 3492 Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA) RFC 3492 describes Punycode as: "a simple and efficient transfer encoding syntax designed for use with Internationalized Domain Names in Applications (IDNA)" Punycode transforms uniquely and reversibly a Unicode string into an ASCII string. This RFC defines a general algorithm called Bootstring. This algorithm allows a string of basic code points to uniquely represent any string of code points drawn from a larger set.   RFC 5890 Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework This RFC describes the usage context and protocol for a revision of Internationalized Domain Names for Applications (IDNA).  RFC 5891 Internationalized Domain Names in Applications (IDNA) Protocol This RFC specifies the protocol mechanism, called Internationalized Domain Names in Applications (IDNA), for registering and looking up IDNs in a way that does not require changes to the DNS itself.  RFC 5892 The Unicode Points and Internationalized Domain Names for Applications (IDNA) The RFC 5892 specifies rules for deciding whether a code point, considered in isolation or in context, is a candidate for inclusion in an Internationalized Domain Name (IDN).  RFC 5893 Right-to-left scripts for Internationalized Domain Names for Applications (IDNA) This RFC provides a new Bidi rule for Internationalized Domain Names for Applications (IDNA) labels, for the use of right-to-left scripts in Internationalized Domain Names.  RFC 5894 Internationalized Domain Names for Applications (IDNA): Background, Explanation and Rationale This informational document provides an overview of a revised system to deal with newer versions of Unicode and provides explanatory material for its components.  RFC 5895 Mapping Characters for Internationalized Domain Names in Applications (IDNA) 2008 This RFC describes the actions that can be taken by an implementation between receiving user input and passing permitted code points to the new IDNA protocol (2008). It describes an operation that is to be applied to user input in order to prepare that user input for use in an “on the network” protocol. It also includes a general implementation procedure for mapping.   EAI RFCs RFC 6530 Overview and Framework for Internationalized Email This standard introduces a series of specifications that define mechanisms and protocol extensions needed to fully support internationalized email addresses. This document describes how the various elements of email internationalization fit together and the relationships among the primary specifications associated with message transport, header formats, and handling.  RFC 6531 SMTP Extension for Internationalized Email The document defines a Simple Mail Transfer Protocol extension so servers can advertise the ability to accept and process internationalized email addresses and internationalized email headers.  RFC 6532 Internationalized Email Headers This document specifies an enhancement to the Internet Message Format and to MIME that allows use of Unicode in mail addresses and most header field content. This document specifies an enhancement to the Internet Message Format (RFC 5322) and to MIME that permits the direct use of UTF-8, rather than only ASCII in header field values, including mail addresses. A new media type, message/global, is defined for messages that use this extended format. This specification also lifts the MIME restriction on having non-identity content-transferencodings on any subtype of the message top-level type so that message/global parts can be safely transmitted across existing mail infrastructure.  RFC 6533 Internationalized Delivery Status and Disposition Notifications This specification adds a new address type for international email addresses so an original recipient address with non-ASCII characters can be correctly preserved even after downgrading. This also provides updated content return media types for delivery status notifications and message disposition notifications to support use of the new address type.   RFC 8398 Internationalized Email Addresses in X.509 Certificates This document defines a new name form for inclusion in the otherName field of an X.509 Subject Alternative Name and Issuer Alternative Name extension that allows a certificate subject to be associated with an internationalized email address.  RFC 8399 Internationalization Updates to RFC 5290 The updates to RFC 5280 described in this document provide alignment with the 2008 specification for Internationalized Domain Names (IDNs) and add support for internationalized email addresses in X.509 certificates.  Key Standards ISO 10646 (Unicode) To provide a common technical basis for the processing of electronic information in various languages, the International Organization for Standardization (ISO) has developed an international coding standard called ISO 10646. The ISO 10646 provides a unified standard for the coding of characters in all major languages in the world, including traditional and simplified Chinese characters. This large character set is called the Universal Character Set (UCS). The same set of characters is defined by the Unicode standard, which further defines additional character properties and other application details of great interest to implementers. Unicode is a character coding system designed by the Unicode Consortium to support the interchange, processing and display of the written texts of all major languages in the world. ISO 10646 and Unicode define several encoding forms of their common repertoire: UTF-8, UCS-2, UTF-16, UCS-4 and UTF-32.  ail_ics.htm?csnumber=63182 GB18030 (China) GB 18030-2000 is a Chinese government standard that specifies an extended code page for use in the Chinese market in addition to UTF-8. The internal processing code for the character repertoire can and should be Unicode; however, the standard stipulates that software providers must guarantee a successful round-trip between GB18030 and the internal processing code. All products currently sold or to be sold in China must plan the code page migration to support GB18030  without exception. GB18030 is a “mandatory standard” and the Chinese government regulates the certification process to reinforce GB18030 deployment.  Online Resources APIs Windows Application Programming Interfaces (APIs)  28v=vs.85%29.aspx SharePoint APIs  Public Suffix List  ICANN Authoritative TLD list  Android APIs  MAC IOS APIs  .Net Framework  Unicode security Unicode security considerations  Unicode security mechanisms  Unicode character groupings Unicode code planes  pp. 44-54 Overview of GB18030  Authoritative mapping table between BG18030-2000 and Unicode  Unicode normalization   Unicode exploits Section 3.1, “UTF-8 Exploits” in Unicode Technical Report #36  M3AAWG Best Practices for Unicode Abuse Prevention  M3AAWG Unicode Abuse Overview and Tutorial  See also:  Miscellaneous URIs  The Domain Name System: A Non-Technical Explanation—Why Universal Resolvability Is Important  ICANN glossary  Need more information? The Universal Acceptance Steering Group (UASG) and community are available to provide advice to software developers and implementers. 👍 Contact us to share your ideas and suggestions on the topic at info@uasg.tech. 👍 Join the Universal Acceptance discussion list at  👍 To learn more about the effort, visit   POP3 support for EAI 19 IMAP support for EAI 19 EAI message headers 20 Headers with addresses 20 Header fields that users see 20 Header fields with contents for machines 20 Received headers 21 MIME headers 22 Handling and reporting delivery failure 22 Backward compatibility 24 EAI and legacy recipients 24 Whether to downgrade 21 Where mail can be downgraded 25 General downgrade techniques 25 Headers and bodies 25 Downgrading headers with addresses 25 Downgrading other headers that users see 26 Downgrading headers that users do not see 26 Downgrading in POP and IMAP 27 Downgrade notes 28 Out-of-office, read receipts, and other autoresponders Mail authentication and spam filters 28 28 SPF authentication 28 DKIM authentication 29 DMARC authentication 30 Spam filtering 30 Appendix A: Handling message header fields 30 Appendix B: Summary of steps necessary to move to EAI 35 Changes to MTAs 35 Changes to MSAs 35 Changes to MUAs 35 IMAP Servers 35 POP Servers 36 UASG012: Email Address Internationalization (EAI): A Technical Overview  Appendix C: How does SMTP work? Adding UTF-8 features to the SMTP example Appendix D: Relevant RFCs 36 37 37 Important mail RFCs 38 For SMTP: 38 For mail message formats: 38 For POP and IMAP: 38 For IDNs: 38 For EAI mail: 39 For PRECIS and string mapping: 39 For SASL (logging in and authenticating for POP, IMAP, and submission): 39 For URLs and URIs: 39 For message authentication: 39 For input and display of RTL and mixed direction text: 40 Appendix E: Other sources of advice 40 Glossary UASG012: Email Address Internationalization (EAI): A Technical Overview  This introduction to Email Address Internationalization (EAI) is intended for technically capable email application developers and systems administrators who want to add EAI support to mail software. For a high-level view of EAI, see UASG014: Quick Guide to EAI. For background information on mail and related technologies, see Other Sources of Advice at the end of this document. Why do we need EAI? When modern Internet mail was defined in the 1980s, the net’s working language was English and all mail was written using the ASCII character set, which only has unaccented upper and lower case Roman characters. But nearly every other written language requires characters outside the ASCII set. On the modern Internet, mail users live in every country in the world and write in a vast array of languages, and email has been slowly evolving to handle all of them. Unicode can represent all those characters. EAI allows Unicode characters, specifically Unicode characters encoded as UTF-8,1 in email addresses. Standards and interoperation The Internet works because the software on the computers connected to it is designed to interoperate. The software is written so that, for example, any computer can send mail to any other computer running mail software. The software all implements standards that describe how to do all of the things the Internet does, from the lowest level packet switching to the codes for formatted HTML text pages and file attachments. For software to interoperate, everyone has to implement the standards in the same way. In this document, we emphasize how to do that, and how to avoid incompatibilities that could prevent interoperating. In particular, even though there are often changes that might seem “better,” if they don’t match the standards, they won’t interoperate with other systems, which is of course not better at all. Parts of the mail ecosystem The path that an email message takes from the sender to the recipient can be rather complex. To make it easier to understand, the IETF mail community has adopted a mail architecture that uses standard names for the various parts of the mail system and the connections among them. The architecture is described in detail in RFC 5598, Internet Mail Architecture. Here we briefly look at the common parts of the architecture and how they fit together as a message travels from author to recipient. 1 UTF-8 is a standard way of storing Unicode code points (characters and modifiers) in 8-bit bytes. For historic reasons, some software uses the name UTF8 without the hyphen. UASG012: Email Address Internationalization (EAI): A Technical Overview  The Mail Software Ecosystem The Internet mail architecture has agreed-on names for the software that handles mail, mostly referred to by three- or four-letter abbreviations. Mail User Agent (MUA) Human mail users read and send mail with a Mail User Agent (MUA), the only program in the mail ecosystem with which users directly interact. Popular MUAs include Outlook, Apple Mail, and the mail programs that people use on smartphones. The user composes the message, perhaps using formatting tools, optionally attaches other media, and then sends the message off using the SUBMIT protocol. For incoming mail, the MUA retrieves mail from mail server(s) using POP or IMAP and displays it to the user. In both cases, the format of the message that the user sees usually differs from the form in which it is submitted or received. Some parts of the message are reformatted, e.g., the Date: header information is often shown in the user’s local format and time zone. Message contents are often decoded and displayed, e.g., a JPEG attachment will be displayed as an image. MUAs usually let the user use address books, where the user can store email address(es) and other information about frequent correspondents. In some cases, the address book is stored on the user’s computer, while other address books can be shared and accessed over the network. Address book entries can be quite complex, with multiple email addresses and other contact information for each correspondent. Webmail Webmail creates a mail client using a combination of the user’s web browser and web servers that the browser connects to. In some versions, the web server uses standard mail protocols to send mail to and retrieve mail from separate mail servers. In others, the web UASG012: Email Address Internationalization (EAI): A Technical Overview  server performs the functions of the MUA or other parts of the mail system. In either case, the webmail provides features similar to those that a separate MUA would perform. Mail Submission Agent (MSA) Once users have created an email message, they tell the MUA to submit it for delivery. The MUA connects to the Mail Submission Agent (MSA). Then the MUA authenticates the message with a password (or implicitly authenticates it with an IP address), and sends the envelope and the message. As the MSA receives the message, it checks for and fixes minor errors in the message format such as a missing Date: or Message-ID: header. Depending on local policy it may force the From: header to match the authenticated user. Many MSAs also add cryptographic authentication signatures at this stage. (See the discussion of DKIM below.) Once the message is prepared, the MSA sends it to the Mail Transmission Agent (MTA). Depending on the design of the mail system, the MSA and MTA may be separate programs, or merely different functions in the same program. The protocol between the MUA and MSA is similar to SMTP (Simple Mail Transport Protocol), which is used between MTAs, but has some significant differences. It’s sometimes called SUBMIT to distinguish it from SMTP. Mail Transmission Agent (MTA) A Mail Transmission Agent (MTA) is what is most often meant by the phrase “mail server.” It receives a completed message from an MSA, and then, for each recipient of the message, determines how and where to deliver the message. In general, for each recipient address, the MTA first finds the domain in the address to see if it’s one that the MTA handles locally. If not, it does a DNS lookup for MX (mail exchanger) records to find the host computers that do handle it, makes an SMTP connection to one of those computers, and sends the message. In the simplest mail systems, the host listed in the MX handles mail delivery itself, while in more complex systems a message may be passed several times from one computer to the next. The SMTP transaction is a sequence of commands from the sending system and responses from the recipient system. The first command and response sets up the connection and lists the SMTP extensions that the recipient system supports, such as the SMTPUTF8 extension that enables EAI mail. Subsequent commands send the envelope information (the return address and recipient addresses) and then send the message itself. For more details on SMTP, see Appendix C: How does SMTP Work?. Mail Delivery Agent (MDA) Once a message has made its way through the recipient’s MTA, it is sent to the recipient’s Mail Delivery Agent (MDA) for delivery. In the simplest case, the MDA simply stores the message into a file for later pickup, but in most cases, there is some delivery-time processing. The IETF has defined a language called SIEVE that enables mail users to write scripts that specify delivery-time processing procedures like sorting mail into separate mailboxes or redirecting mail to other addresses. There are many other delivery programs, such as the UASG012: Email Address Internationalization (EAI): A Technical Overview  widely used procmail. Most Unix and Linux systems allow users to specify arbitrary programs to handle incoming mail. Webmail systems provide various sorts of delivery-time processing. Most enable users to sort mail based on text found in the message (e.g., if the subject includes “pickle-list”, it is saved to the pickle-list folder) while others group mail into categories such as Updates or Forums. Mail storage Originally, an email mailbox was analogous to a physical mailbox, a place to store incoming mail messages temporarily until they were picked up and processed. As computer storage has gotten faster and cheaper, mailboxes have grown to the point where it is now common to store many years of mail. Mail systems generally have multiple folders for each mailbox, with each folder named hierarchically, as disk files are. Messages can be flagged as “unread,” “read,” “important,” or “answered.” Mail programs generally provide ways to organize mail, and to search through messages in various ways, looking for keywords or addresses, or limiting the search by date range. Mail systems use many underlying storage schemes. In the simplest, all of the mail in a mailbox is stored in a single file. Others store each message in a separate file. Mail may also be stored in a database, perhaps with header and body information handled differently. Regardless of the storage scheme, MUAs see the mail as a list of messages in each folder. POP/IMAP mail pickup On early mail systems, users stored their email and ran their mail programs on the same computer, and the mail program read the mail directly from local files. These days, users invariably read their mail on a different computer, using POP and IMAP to retrieve it. POP (Post Office Protocol), the older and simpler protocol, lets the MUA retrieve mail from the mail server and then optionally delete it from the server. The MUA then manages the mail on the user’s own computer. IMAP (Internet Message Access Protocol) lets the user’s mail program manage mailboxes on the server, copying mail to and from the server as desired. Since the mail generally stays on the server, IMAP makes it possible to have mail programs on different computers, such as laptops and phones, show the same view of the mail. Since the mail program doesn’t have to download all the mail, vast amounts of mail can be stored while running mail programs on small computers such as tablets and phones. Another important difference between POP and IMAP is that POP can only see the main inbox for a mail account, while IMAP can manage all of an account’s folders. The expectation was that POP users would copy all the mail to their own computer and manage it there. POP and IMAP both require that a user authenticate before picking up mail, with a username and password. In most cases the POP/IMAP user name is the user’s email address. Mail message formats The basic Internet message format was initially defined by RFC 724 in 1977 and has changed very little over the subsequent 40 years as the specification has been updated UASG012: Email Address Internationalization (EAI): A Technical Overview  several times, most recently by RFC 5822. That format has proven to be flexible enough to support the changing needs of mail users over the years. Each legacy message, i.e., a pre-EAI message, is a sequence of lines of ASCII text ending with the ASCII Carriage Return and Line Feed (CR and LF) characters. The first part of the message, usually called the header, is a series of structured header fields followed by a blank line and ending with an unstructured message body. Each header field starts with a header name such as From: or Subject: and a colon, followed by the contents of the header. Some header field contents are free-format, such as the Subject: header, while others are entirely fixed-format, such as the Date: and Message-ID: headers, while others are a combination of fixed- and free-format, such as the To:, From: and Cc: headers, which combine fixed-format addresses with free-format comment text. Messages are invariably accompanied by metadata, information related to the message but not part of it. The envelope, described in the next section, is an important part of the metadata. Other parts of the metadata may include the date a message was received, whether the recipient has read it, and whether the recipient has marked it as important or as junk. Messages and Envelopes Email messages in transit, from submission to delivery, are accompanied by an envelope. The envelope contains the return address, to which errors should be reported (often called the “bounce address”), the recipient addresses, to which the message should be delivered, and sometimes other information about the delivery process. The envelope information is sent along with—but separately from—the message. When a message is transmitted via SMTP (described in more detail below), one SMTP command sends the return address, additional SMTP commands send each recipient address, then another SMTP command sends the message. UASG012: Email Address Internationalization (EAI): A Technical Overview  When a message starts out, the return address in the envelope usually matches the From: address in the message, and the recipient addresses in the envelope match the To:, Cc:, and Bcc: addresses. But there is no requirement that the envelope addresses match the ones in the message, and there are many common situations where they don’t. For example, if a message is sent to two addresses, Alice and Bob, which are on different mail systems, the copy sent to Alice will only have recipient address Alice, and the copy sent to Bob will only have recipient address Bob. When mail is sent to mail discussion lists, the To: line address is usually the address of the list, but the list software will re-mail the message to all of the list’s subscribers, which means that all of those subscribers will be in the message’s envelope recipients. In addition to addresses, the envelope can include other parameters, such as the size of the message or the identity of the sender of a newly submitted message. As we will see below, in EAI mail, the envelope indicates whether a message is an EAI message or a legacy message. Mail addresses Each legacy email address is of the form local-part@domainname. The local-part is arbitrary ASCII text, and the domain name is a DNS hostname. A legacy hostname is a sequence of labels separated by dots. Each label starts and ends with an ASCII letter or digit and consist of only ASCII letters, digits and hyphens, known as the LDH rule. In principle, legacy local-parts can contain any printable ASCII characters, including spaces and punctuation. In practice names with exotic punctuation are hard to to type and often don’t work well when entered into web forms. In mail headers, addresses are usually enclosed in angle brackets to distinguish them from comment text, e.g.: To: Jim Smith <james@example.com>, Mary Jones <mzjones@example.net> An obsolete but still valid syntax puts the comments in parentheses, e.g. To: james@example.com (Jim Smith), mzjones@example.net (Mary Jones) Internationalized Domain Names Just as Internet users want to use their own scripts in the body of their emails, they also want to use their own scripts in the domain names. Although the Domain Name System (DNS) internally uses eight-bit bytes and could, in principle, have used literal UTF-8 names, a vast amount of DNS support software can only handle ASCII. In addition, Unicode often allows several different ways to produce the same character, e.g., writing an accented “é” UASG012: Email Address Internationalization (EAI): A Technical Overview  either with two code points, a plain “e” and a separate accent character “´", or with a single, precomposed code point for the accented letter. DNS lookups only do exact matches, so if a name were stored in one form but looked up in another, the lookup would fail. The DNS community has addressed this problem with a design known as Internationalized Domain Names in Applications (IDNA.) It uses several techniques to make UTF-8 names work reasonably well. EAI uses the most recent version of IDNA, IDNA2008. Normalization The first is normalization, using a consistent representation of characters that can be represented in UTF-8 in multiple ways, e.g., a single “é” code point or an “e” and an accent “´". The Unicode consortium has defined several normalization forms. IDNs use Normalization Form C (NFC), where C stands for Composed. Roughly speaking, it uses precomposed characters that include accents and other modifiers rather than separate letter and modifier code points. Inclusion The second technique is inclusion, the principle that specific characters are deliberately included in the allowed set, rather than starting with everything and trying to delete the problematic ones. The IDNA specifications identify the code points that are allowed in domain names, which are generally intended to include letters and digits used in a wide variety of languages, as well as—in some cases—additional characters needed to combine or format them. They deliberately exclude all the other Unicode code points such as punctuation and emoji. A UTF-8 string that complies with all of the IDNA rules is called a ULabel. ACE Encoding The third technique is ASCII Compatible Encoding (ACE). Since a lot of existing software (not just mail software) only handles ASCII, IDNA created an alternate ASCII encoding called an A-Label. Every valid U-Label corresponds to a unique A-Label and vice versa. The A-Label is stored in the DNS, while the U-Label is typically entered by users and displayed to them. An A-Label is in the form xn--text, where xn-- is a prefix indicating that a label is an ALabel, and the text is an ASCII-encoded version of the U-Label, using a scheme known as punycode. IDNA is widely supported in web browsers, which will turn UTF-8 names in their address bars into A-labels before looking them up. Scripts and LGR The fourth technique is comprised of scripts and Label Generation Rules (LGR.) A script is a collection of characters used to write a language. The relationship between scripts and languages can be complex—some scripts such as Cyrillic are used for several languages, while some languages such as Japanese are written in multiple scripts. Label Generation Rules define the set of Unicode characters valid for a particular language. The main point of LGRs is to avoid mixed script names that are confusing for users (e.g., mixtures of Latin and Cyrillic), and to identify variant characters that look different but have the same meaning. UASG012: Email Address Internationalization (EAI): A Technical Overview  LGRs are not formally a part of IDNA2008, but IETF standards recommend using them. Most top-level domain registries have LGRs for each of the languages in which they accept registrations. IANA keeps a repository of them at  UTS#39, Unicode Security Mechanisms, offers advice on restricting mixing of scripts. Its Highly Restrictive restriction level is a conservative and widely used rule for identifiers. The part of an email address after the @ is a domain name, so A-labels are valid there. But the part of the email address before the @, the local-part, is not a domain name, and for a variety of reasons, a UTF-8 local-part cannot be encoded as punycode or an A-label.2 To have proper internationalized mail, we need an extension to the mail system to handle UTF8 in the local-part part of the address, as well as in the other nooks and crannies that MIME doesn’t handle. MIME mail MIME (Multipurpose Internet Mail Extensions), the first major extension to mail, appeared in 1992. Before MIME, the body of a mail message was just a block of unstructured ASCII text. MIME provided a way to treat the mail body as a group of structured blocks of data, some of which might be text, while others might be pictures, documents, or any other sort of data that could be stored in a file. MIME provides standard ways to encode any kind of data. When pictures or other files are attached to a mail message, it’s done with MIME. MIME overlays a structure of message parts on the block of unstructured text. A message can be one part or several, the parts can be related in different ways, and each part can have a type. Typical types are text/plain and text/html for plain or HTML-formatted text, or application/pdf for an attached PDF file. A message with more than one part can be multipart/alternative, different versions of the same thing (typically unformatted and formatted text), or multipart/related, typically text and attachments. Every MIME text part can specify a character set such as UTF-8, which allows UTF-8 message bodies even in legacy mail. MIME also added a feature called 8BITMIME, which allows the transfer of messages that include 8-bit characters in message bodies so long as the body is still lines of text with CR and LF at the end. This allows the use of UTF-8 text since all ASCII characters, including CR and LF, are also UTF-8 characters. In principle, mail server support of 8BITMIME is optional, but in practice, all current mail servers support it. Messages can also use quoted-printable or base64 encoding to represent any data including UTF-8 in legacy messages. MIME also provides a way to specify encoded character sets in the unformatted parts of message headers such as the Subject: line, using the same character sets and encodings that are allowed in text bodies. These are called encoded-words. 2 Since mail programs accept and display local parts as-is, users would see the meaningless punycode or A-label rather than the intended UTF-8 address. Even worse, users would have to enter the characters in the punycode or A-label when typing an address. UASG012: Email Address Internationalization (EAI): A Technical Overview  For example, this subject line is an encoded-word in UTF-8. This example includes a UTF-8 character hex C2 B0, which is a raised small letter "o". Subject: =?utf-8?Q?Your_reservation_N=C2=B0_F39-04XS?= Subject: Your reservation No F39-04XS MIME encoded-words can be used in most mail headers visible to users, including the Subject: and the comment parts of address headers such as To: and From:, but it can’t be used in email addresses in legacy mail, which still have to be ASCII. It’s worth emphasizing this last point: other than addresses, almost everything in a mail message can already use UTF-8 via MIME. A first look at EAI mail The technical differences between legacy and EAI mail are quite small. The most important difference is that email addresses (the local-part and/or domain name) can contain UTF-8 as well as ASCII. The local-part part of an address can contain any printable UTF-8 characters. The characters in a domain name are limited to those allowed by IDNA2008. Another difference is that most parts of a message can be UTF-8 rather than ASCII. The contents of header fields such as To:, From:, and Subject: can be UTF-8, although the field names are still restricted to ASCII. The contents of a message can be UTF-8 without needing any special encoding. There are a few other differences, but these are the most important ones. Since there is no way for a legacy mail system to handle UTF-8 addresses in a message envelope, or UTF-8 addresses in mail headers, EAI had to modify both SMTP and message formats to handle the new address forms. Transmitting EAI mail EAI creates a conceptually parallel mail stream for EAI mail. When one computer transmits an EAI message to another, such as when an MUA submits a message to an MSA, or an MTA transmits a message to another MTA, it needs to be sure that the receiving system can deal with it. (We say conceptually parallel because any EAI mail server can support legacy mail.) The standard MUA→MTA submission and MTA→MTA SMTP have defined an extension feature called SMTPUTF8. If a mail server supports SMTPUTF8 it can handle EAI mail; if not, it can’t. When the sending computer first connects, the receiving computer sends it a list of supported extensions (see EHLO in Appendix C below) and the sending computer checks to see if SMTPUTF8 is in the list. UASG012: Email Address Internationalization (EAI): A Technical Overview  This picture shows the two conceptually separate mail streams, EAI and legacy SMTP. The solid diagonal line indicates that any EAI mail server is also a legacy mail server; that is, any legacy sender can send to a legacy address on an EAI server. The dotted diagonal line indicates that in some cases (not many), EAI mail can be turned back into legacy mail. Recognizing EAI messages Since there are likely to be parallel EAI and legacy mail streams for a long time to come, it will sometimes be necessary to distinguish between EAI and legacy messages. There are two ways to do this. One is to look at the message you need to identify as EAI. If there are UTF-8 characters in any of the envelope addresses, or UTF-8 characters in any of the headers in the message, it’s an EAI message.3 In addition, the end of the header is marked by an empty line, coded as the four characters CR LF CR LF. This identification process could potentially be slow if a message’s headers were large, or if it would require reading the message from a disk file. The other way of distinguishing an EAI message is to keep its EAI status as part of the message’s metadata. The metadata already includes the envelope addresses, and—in many systems—other information such as receipt time, whether it’s been read or replied to, and whether it’s considered junk. In some cases, one more indicator for EAI status would be easy to include. 3 This is easy to do in software because all UTF-8 character codes are greater than 0x80, whereas ASCII codes are less than 0x80. UASG012: Email Address Internationalization (EAI): A Technical Overview  Technical topics for EAI mail Most changes are in the SMTP session and in message headers, but there are a few changes in user mail programs, and some new options for the message bodies, too. Assigning and interpreting EAI mail addresses Many of the conventions from ASCII addresses carry over to EAI mail addresses: EAI local parts can contain any printable UTF-8 characters, while the domain parts are still domain names but IDN names can be written as UTF-8 U-labels. Any address with UTF-8 in the local-part, the domain, or both is an EAI address. While the email standards say that a local-part can contain any sequence of UTF-8 characters up to 64 bytes long, some local-parts are a lot easier for users to remember and type than others. The IETF PRECIS4 (Preparation and Comparison of Internationalized Strings) working group created standard ways to handle string input used in applications. It defines classes of strings for different applications. The Identifier Class is intended, as its name suggests, for strings used as identifiers. The class has a profile UsernameCaseMapped which matches mailbox names fairly well, including case-insensitive letters and digits but not spaces or punctuation. PRECIS also defined preparation rules to preprocess user input, in order to deal with multiple versions of characters such as upper and lower case or full- and half-width letters. An additional advantage of using a Username profile is that internationalized usernames for POP and IMAP servers (described below) have to be PRECIS usernames, and this allows the user’s mailbox to be used as the POP/IMAP username. See the list of RFCs in Appendix D for links to detailed PRECIS specifications. The Unicode consortium offers similar advice in UTS#39 Unicode Security Mechanisms, which offers advice for email addresses in section 3.3. In some cases it may be useful to assign both an EAI and a legacy address for a mailbox. (See Downgrading, below.) In some cases there may be a straightforward transliteration, such as борис@domain to boris@domain or 李伟@domain to liwei@domain. In other cases, there may be no natural way to transliterate, and the two names may have no obvious connection. Mail standards require that systems treat addresses of mailboxes on other systems as opaque identifiers; that is, to pass them along as is without trying to interpret or modify them. This means that systems must not even attempt to normalize text to NFC, since there is no promise that the recipient system uses that normalization, or any normalization. But the standards allow the delivering system a great deal of flexibility in handling mail addressed to its own users. For legacy addresses, upper- and lower-case ASCII are usually treated as the same, and systems often accept minor variants of an address, such as 4 Pronounced as the French précis, roughly like pray-see. UASG012: Email Address Internationalization (EAI): A Technical Overview  addresses with or without periods, apostrophes, or other punctuation (e.g., J.O’Brian@ and J.obrian@ and jobrian@ can deliver to the same mailbox). EAI mail systems can allow similar flexibility in UTF-8 addresses. See the PRECIS documents for advice on preparing and normalizing string input. Storing EAI mail The traditional folder structure used for legacy mail doesn’t change with EAI, but the folder names can now be UTF-8, and metadata associated with messages such as To: and From:addresses and Subject:headers can be UTF-8 as well. The PRECIS FreeFormText class, defined in RFC 8264, is intended for free-form strings such as “human-friendly nicknames” that can be useful for folder names. This allows a wider range of text than the Identifier class, including spaces and some punctuation. MUAs and EAI mail The changes to MUAs to handle EAI mail are not large. In all the places where a user can enter a legacy mail address, such as To:and Cc: headers and address book entries, any validation of addresses at the time of entry must allow EAI addresses. EAI addresses may contain Left-to-right (LTR), Right-to-Left (RTL) or bidirectional (bidi) text, when for example, an address has an RTL local part and an ASCII domain name. MUAs must be prepared to display such addresses when they occur in header fields or in the message body. A discussion of the best ways to display bidi text is beyond the scope of this document. See Appendix D for references. When user-entered text in messages is linkified by the MUA, the linkification process should treat all domain names and all email addresses the same. Address books Address books might provide a way to mark whether or not an address is able to receive EAI mail. While any EAI address can receive EAI mail, legacy addresses may or may not. If a user receives an EAI message, the sender of the message can be marked as EAI-ready. If a contact in an address book has both an EAI and a legacy address, the EAI address is likely to be preferred for EAI mail, although the user should be able to override the choice. Mail addresses on the web Many websites accept email addresses through web forms, to be used for sending confirmations, adding to mailing lists, and other purposes. The addresses are generally validated either by javascript in the web page, or by code on the server to which the form is sent. Javascript typically uses regular expressions to check the address syntax. A fairly complete set of address expressions are in the IETF Internet draft draft-seantek-mailregexen. When a server receives an address, it should do some checks beyond what the javascript can do. If the domain part of the address is in UTF-8, it should normalize it following IDNA2008 rules and then verify that the domains are valid U-labels by converting them to Alabels. If the conversion fails, the address is invalid and the user needs to correct it. Once UASG012: Email Address Internationalization (EAI): A Technical Overview  the server has the A-label version of the domain, it can look up the domain in the DNS to be sure it exists and that it has MX, A, or AAAA DNS records. If the domain doesn’t exist, or doesn’t have MX, A, or AAAA records, it’s not valid for mail. There is no way to validate the local part of an address other than sending mail to the address and seeing if the user receives the message. (In particular, doing a partial SMTP session to see if a RCPT TO: command succeeds is not a reliable check.) Sending a confirmation message to check that the address is valid and the person at that address is the one who provided the address is an email best practice whether or not the address is EAI.5 Email addresses can appear in mailto: URIs in formatted text. If an EAI address appears in a mailto: URI, the URI specifications6 require that any non-ASCII characters must be percentencoded in the URI. If an address were 猫王@普遍接受-测试.世界, the mailto: URI would be: mailto:%e7%8c%ab%e7%8e%8b@%e6%99%ae%e9%81%8d%e6%8e%a5%e5%8f%97%2d%e6%b5%8b %e8%af%95.%e4%b8%96%e7%95%8c The Chinese characters are percent-encoded but the ASCII dot and at-sign are not. The domain name can be a U-label or an equivalent A-label, e.g.: mailto:%e7%8c%ab%e7%8e%8b@xn----f38am99bqvcd5liy1cxsg.xn--rhqv96g Sending, delivering and picking up EAI mail The following discussion assumes the reader is already familiar with the way that SMTP and SUBMIT work. See Appendix C for an overview of SMTP. When an MTA uses SMTP to send a message to another MTA, or an MUA SUBMITs a message to an MSA, there a a few changes to the SMTP and SUBMIT protocols. EAI makes the same changes to SMTP and to SUBMIT, so we describe the changes together here. The first difference is that the receiving computer includes the keyword SMTPUTF8 in the list of extension keywords to say that it can handle EAI mail: S: <connect> R: 220 receive.net ESMTP S: EHLO sender.org R: 250-8BITMIME R: 250-SMTPUTF8 R: 250 PIPELINING The order of the keywords doesn’t matter, but SMTPUTF8 has to be in the list. (Every EAI mail server must also support 8BITMIME, but all modern servers do anyway.) 5 See M3AAWG Sender Best Common Practices Version 3.0. 6 Defined in RFC 3987. UASG012: Email Address Internationalization (EAI): A Technical Overview  Next, when sending the return address, the MAIL FROM: command includes an SMTPUTF8 keyword to indicate that this message is an EAI message. UTF-8 addresses are sent as-is. S: MAIL FROM:<猫王@普遍接受-测试.世界> SMTPUTF8 R: 250 Sender accepted If the body of the message contains 8-bit data such as UTF-8, the sender may indicate it in the MAIL FROM, although it’s not required. S: MAIL FROM:<猫王@普遍接受-测试.世界> SMTPUTF8 BODY=8BITMIME R: 250 Sender accepted The rest of the mail session is unchanged from legacy mail, other than allowing UTF-8 in the envelope recipient addresses and the message headers. If a sending computer is trying to send an EAI message, and the EHLO response from the server doesn’t contain SMTPUTF8, that server can’t handle EAI mail and the delivery fails. Similarly, if the receiving computer rejects the MAIL FROM that includes a SMTPUTF8 keyword, the delivery fails. MTAs and incoming A-label and U-label addresses An MTA usually handles mail for multiple specific domains.7 An EAI mail server should accept mail both for the A-label and U-label versions of the domains whose mail it accepts. While EAI senders should use the U-label, legacy senders will use the A-label, and it’s also possible that poorly configured EAI senders will, too. Once a message is received, the address should be treated the same whether the address was an A-label or a U-label. An easy way to do that is to normalize incoming addresses so they’re all A-labels or all U-labels before subsequent processing. POP and IMAP with EAI mail POP and IMAP servers that support EAI need two kinds of changes. The first change allows UTF-8 in usernames and passwords as well as IMAP folder names and search strings. In each case, the server needs to be able to tell clients that it supports the new features. The other change allows POP clients to fetch EAI messages, and IMAP clients to fetch messages and store them back to the server. This requires that the client tell the server that it can handle EAI messages. 7 Some servers are both an MTA and an MSA. If a sender authenticates before sending mail, the server is being used as an MSA, so it will accept and relay mail to addresses in any domains. An MTA that accepts and relays mail for any domain without needing authentication is known as an open relay, and is likely to be abused by spammers and blacklisted. UASG012: Email Address Internationalization (EAI): A Technical Overview  Both POP and IMAP support a variety of ways to send login credentials. Each has a command to send a plain text username and password as well as a more complex authentication command that can use a variety of security schemes known collectively as SASL, for Simple Authentication and Security Layer.8 POP3 support for EAI POP3 allows client MUAs to fetch mail from mail servers, and is intended to be easy to implement on both servers and clients. POP3 uses a sequence of four-letter commands and simple responses. Clients use the CAPA command to get a list of available capabilities and—for some capabilities—options. The basic UTF8 capability indicates that the server can handle EAI mail. The “UTF8 user” capability (that is, UTF8 with the “user” option) means that it can also handle UTF-8 login usernames and passwords. Any UTF-8 username and password must be prepared using the PRECIS username profile (or its predecessor, SASLprep) and be sent with an AUTH command that uses a SASL mechanism. Once the client has logged in, it sends a UTF8 command to tell the server that it (the client) can handle EAI messages. After that, the session is the same as for legacy clients. If a client does not send a UTF8 command but the server has EAI messages, the server either omits EAI messages from the list of available messages, or downgrades them. (See the Backward Compatibility section below for more about downgrading.) POP3 only handles a single mailbox per connection, so there are no folder names to deal with. IMAP support for EAI IMAP has a complex design that allows client MUAs to manage multiple mailboxes on remote servers. The client can use complex commands to manage large mailboxes on the server such as SEARCH to look for messages that match various criteria, and SORT and THREAD to control the order messages are returned from the server to the client. Over the years there have been several attempts to add internationalization features to IMAP; these coexist uneasily. Like POP3, IMAP uses capabilities to indicate which optional features a server supports. An IMAP server sends a list of initial capabilities in the greeting message when the client first connects, and another list after the client logs in. (Many capabilities are only available after a client logs in.) The client then sends an ENABLE command with a feature name to tell the server that it wants to use that feature. 8 SASL is defined in RFC 4422, and the various mechanisms are listed in the IANA SASL Mechanisms registry. UASG012: Email Address Internationalization (EAI): A Technical Overview  For a long time IMAP has had features to allow non-ASCII text in some contexts and different collating sequences for SORT and THREAD, but they are clumsy to use and often slow, so clients rarely use them. In 2013 IMAP added nearly full support for UTF-8 with features UTF-8=

ACCEPT

 and UTF8=ONLY. If a server offers UTF-8=

ACCEPT

 and the client enables it, the client and server can send each other UTF-8 in most places that required ASCII before. That includes mailbox names and mail messages sent from the server to the client, and mailbox names, search strings, and mail messages sent from the client to the server. Since the client cannot enable UTF-8=

ACCEPT

 until after it logs in, the IMAP LOGIN: command is still ASCII-only. The IMAP AUTHENTICATE command allows SASL authentication methods that handle UTF-8, so an EAI client can use AUTHENTICATE: to log in, then enable UTF-8=

ACCEPT

. If the server offers UTF-8=ONLY, it is saying that it only provides EAI-compatible service. The client must enable UTF-8=

ACCEPT

 or disconnect. Since ASCII is a subset of UTF-8, the client can access both ASCII and EAI folders and messages. If a server offers UTF-8=

ACCEPT

 but the client does not enable it, the server has the option to downgrade UTF-8 mailbox names and EAI messages. See Backward Compatibility, below. EAI message headers Changes to message headers in EAI mail range from none to very extensive, depending on the header. See Appendix A for advice on individual headers. Headers with addresses Headers with addresses include From:, Sender:, To:, Cc:, Bcc:, Reply-To:, Resent-From:, Resent-To:, Resent-Cc:, and Resent-Bcc:. All have the same syntax, i.e., a comma-separated list of addresses and optional comments. The addresses in EAI messages can have any printable UTF-8 text in the local part, and U-labels as well as Alabels and ASCII hostnames in the domain part. U-labels are preferred over A-labels, since human users can read them. UTF-8 text in the comments can be MIME encoded as in legacy mail, but does not have to be. Since the unencoded UTF-8 is shorter, it is preferred. Header fields that users see Some header fields are free text intended for users to read, such as Subject: and Organization:. They can contain any printable UTF-8 text. The text should be unencoded UTF-8, but (as in legacy messages) can also be MIME encoded-words. Header fields with contents for machines Some header fields, such as Date: and Message-ID:, are intended for computers, not for people. In general, there is no advantage to using non-ASCII characters in those headers, and doing so makes it harder to send mail to legacy systems. Even though content of the Date: header has a form familiar to English speakers, it is in a rigid fixed format defined in RFC 5322, which must be followed exactly. MUAs often parse the headers and display the dates in a convenient localized form, translating from the fixed UASG012: Email Address Internationalization (EAI): A Technical Overview  form in the message. Other headers that contain dates such as Resent-Date are treated the same way. The Message-ID: header contains a unique string that identifies the message. Mail software can check the Message-ID: in two messages to see if they are duplicates. Reply messages put the original Message-ID: into References: and In-Reply-To: headers that let MUAs group related messages together. The syntax of a Message-ID: is similar to an email address in brackets, like <text@text>. Most mail systems create Message-IDs with their own domain name to the right of the @ sign and pseudo-random text to the left. Although it is valid to use UTF-8 characters in Message-IDs, it’s not a good idea, since it makes it impossible for a legacy message to refer to the EAI message in an In-Reply-To: or References: header. IDN domain names in Message-IDs should be represented as ASCII A-labels rather than U-labels. Note: Even though Message-IDs resemble email addresses, they are actually just strings with no address meaning. It is not possible to downgrade a Message-ID; if you change Ulabels in a Message-ID into A-labels, that is a different Message-ID unrelated to the original. Received headers Every time a message is transferred from one computer to another by SMTP, the receiving computer puts a Received: header at the top of the message. The header identifies the sending and receiving computers (“from” and “by”), the transmission protocol (“with”), a timestamp, and often other information. Here’s a typical example for a message sent via SMTP using TLS encryption: Received: from mail.mit.edu ([128.31.0.31]) by mail1.iecc.com ([64.57.183.56]) with ESMTPS via TCP port 40060/25 id 586470169; 15 Feb 2018 02:28:32 -0000 The “with” clause indicates which transport was used to transport the message. Currently the most common are those listed below. When a message uses EAI transport—that is, with an SMTPUTF8 tag on the MAIL FROM: that introduces the message— the “with” value changes to note the EAI transport. Legacy transport EAI transport Meaning ESMTP UTF8SMTP SMTP session starting with EHLO ESMTPS UTF8SMTPS ESMTP with TLS encryption ESMTPA UTF8SMTPA ESMTP from an authenticated sender (typically for SUBMIT) ESMTPSA UTF8SMTPSA ESMTPA with TLS encryption So, for example, a message sent using EAI SMTP and TLS would have this different Received: header. UASG012: Email Address Internationalization (EAI): A Technical Overview  Received: from mail.mit.edu ([128.31.0.31]) by mail1.iecc.com ([64.57.183.56]) with UTF8SMTPS via TCP port 40060/25 id 586470169; 15 Feb 2018 02:28:32 -0000 While users don’t usually see the Received headers, they are invaluable in tracking transport and delivery issues. The “with” values make it easy to tell which transports used EAI and which didn’t. If it seems odd that the SMTP extension keyword is SMTPUTF8 but the Received “with” tag defined in the same document is UTF8SMTP, yes, it is. MIME headers Most messages have more than one part, such as alternative plain text and HTML versions or attached files. The parts in the message are separated by a boundary string which is defined in a Content-Type: header. For example, these lines might appear in the message header: MIME-Version: 1.0 Content-Type: multipart/alternative; boundary="b1_d9ef97d65ef88703f84b0a36e52aa4a2" And these in the message body: --b1_d9ef97d65ef88703f84b0a36e52aa4a2 Content-Type: text/plain; charset=utf-8 … text version of the message ... --b1_d9ef97d65ef88703f84b0a36e52aa4a2 Content-Type: text/html; charset=utf-8 … HTML version of the message ... --b1_d9ef97d65ef88703f84b0a36e52aa4a2-Each part starts with the boundary string, and then a Content-Type: header with the type of the material in the part, the encoding, and sometimes other information such as the suggested filename for an attached file. An optional Content-Description: header contains free text about the MIME part, and Content-ID: contains an ID with the same syntax as a Message-ID: that allows one MIME part to refer to another. EAI makes almost no changes to MIME headers, and EAI messages should continue to use ASCII characters as boundary strings. UTF-8 may appear in optional Content-Type: fields such as the suggested filename for an attached file, and in the text in ContentDescription. Handling and reporting delivery failure UASG012: Email Address Internationalization (EAI): A Technical Overview  Whenever one computer sends a message to another using SUBMIT or SMTP, things can fail. As the sending computer sends commands, the receiving computer sends responses saying whether each command succeeded or failed. In most cases, if any of the commands fail, sending the message fails.9 If a message is rejected inline, during an SMTP or SUBMIT session, specific error codes indicate why it was rejected. EAI adds some new rejection codes to indicate that it was rejected because a recipient does not accept an EAI message. The codes are different depending on which SMTP command provoked the rejection: ● 550 cannot accept EAI sender 5.6.7 (in response to MAIL FROM) ● 553 cannot accept EAI recipient 5.6.7 (in response to RCPT TO) ● 554 some recipients cannot accept EAI 5.6.9 (after the end of DATA) After the receiving computer accepts a message, it either has to deliver the message, or send back a Delivery Status Notice (DSN) to the address in the MAIL FROM: command. Although mail systems try to reject undeliverable mail during the SMTP or SUBMIT session, some DSNs are unavoidable. Assume a user uses an MUA to create an EAI message and submits it to the user’s own mail system. That system’s MTA uses SMTP to relay it to the recipient’s system. If the recipient’s system turns out not to accept EAI mail, the SMTP session will fail, and then the user’s system has to send a DSN back to the user’s MUA. The format of DSNs for legacy messages is defined by RFC 3464, and extended to EAI messages by RFC 6533. A DSN is a mail message in a specific format, containing a MIME multipart/report structure with three parts: a text explanation for a human recipient; a fixedformat, machine-readable section describing what went wrong; and a copy of the failing message, or at least its headers. 9 If a message has several recipients, the sender can send the message even if some of the recipient addresses are rejected, so long as at least one is accepted. It’s a quality of implementation decision whether to send anyway or stop and go back to the user to fix the addresses. UASG012: Email Address Internationalization (EAI): A Technical Overview  A DSN might be returned a few seconds after the initial message was sent, or it might take hours or occasionally days if a recipient system is unavailable and an intermediate system retries the delivery several times before giving up. Backward compatibility For the foreseeable future EAI mail will have to coexist with legacy mail. While an EAI mail system can accept any mail from legacy mail systems, legacy systems can only accept legacy mail. EAI and legacy recipients When a user sends a message to a correspondent with an EAI address or to several EAI correspondents, they can obviously all accept EAI mail. If the correspondent has an ASCII address, and the address is in the user’s address book, it might be marked as EAIcompatible or not. In the absence of that information, one possibility is to be conservative and send a legacy message, while the other is to send an EAI message, hope that it works, and report the failure if it doesn’t. As discussed in the previous section, if a message cannot be delivered, the sending system may get an immediate failure code, or the failure report may come back later in a DSN, depending on the architecture of the system. If a message has more than one recipient, some recipients may accept EAI messages while others do not. In that case the sending system may try to create a downgraded message and send that to the non-EAI recipients. Note that SMTP makes no distinction among To:, Cc:, or Bcc: recipients on a message. The process of downgrading is the same regardless of where—if anywhere—the message header mentions the non-EAI recipient. Hence the process of downgrading and resending depends only on whether there are non-EAI recipients. Whether to downgrade The downgrading advice in the following sections is completely optional. A compliant EAI system need not do any downgrading at all. While the EAI standards allow senders to downgrade messages, they neither encourage nor discourage it. A reason to downgrade is that legacy recipients can get approximate copies of messages they couldn’t get otherwise. But a reason not to downgrade is that downgrading messages loses some of the information, and recipients of downgraded messages may find them confusing or frustrating. It is also not possible to tell reliably whether a recipient with an ASCII address can receive EAI mail, so a system that downgrades is likely to guess wrong some of the time and send downgraded messages to people who could have accepted the EAI original. Another problem is that downgrading removes EAI addresses from message headers. In some cases it is possible to replace them with substitute addresses, but more often an address is just gone. Without a substitute address, recipients cannot reply to the message, put the person in their address books, or do any of the other things they do with addresses in incoming mail. Downgraded messages may be handled poorly by mail systems that do not expect From: header fields that don’t contain an address. If messages are downgraded automatically, the sender is likely to be unaware that some or all of the recipients of the UASG012: Email Address Internationalization (EAI): A Technical Overview  message have gotten a downgraded version, and users may find it confusing that different recipients got different versions of the message. Where mail can be downgraded When an MTA attempts to send a message to a recipient, the attempt may fail because the recipient MTA doesn’t offer SMTPUTF8, or rejects the message with a status code that indicates that the recipient doesn’t accept EAI mail. At that point the MTA might attempt to create a downgraded version of the message to send to the recipient. In theory any MTA in the message’s path might do this, but the result is more likely to be useful if the MTA can find substitute addresses for the EAI addresses in the downgraded message. The most likely situation for a successful downgrade is a webmail system that integrates the MUA, MSA, and outgoing MTA into a single package. Another place that messages might plausibly be downgraded is in mailing list manager software. If some subscribers to a list can accept EAI mail and some can’t, the list software might create a downgraded version for legacy recipients. General downgrade techniques The EAI standards describe two methods of downgrading received EAI messages on POP or IMAP servers. These two approaches are also, with minor changes, suitable for downgrading messages by senders with messages for non-EAI recipients. RFC 6857, Post-Delivery Message Downgrading for Internationalized Email Messages, describes a complex scheme that creates headers such as Downgraded-To: and Downgraded-From: that are intended to include everything that was in the message in a way that could be reversed later. RFC 6858, Simplified POP and IMAP Downgrading for Internationalized Email, describes a much simpler scheme that preserves EAI information where convenient, but does not try to preserve every detail. We recommend the simpler RFC 6858 approach. Headers and bodies In most cases, only the message’s headers need to be downgraded to be acceptable to nonEAI mail systems. In theory there could be systems that only accept 7-bit ASCII mail, but in practice all mail systems now support 8BITMIME, so they can accept UTF-8 in message bodies. Downgrading headers with addresses Headers with addresses such as From:, To:, and Resent-Cc: contain addresses and optional comments. Since the comments can be encoded words that are valid in legacy messages, only the addresses need special handling when downgraded. Downgrading a UTF-8 address has two steps: determine whether there is a substitute ASCII address, and then rewrite the header appropriately. If the address is one managed by the local system (generally the case for addresses in the From: header), there may be a list of locally equivalent EAI and ASCII addresses. If so, find the equivalent ASCII address in that list. Also, if the user has an address book that is available at the time of the downgrade, the address book may have a substitute address for the EAI address. UASG012: Email Address Internationalization (EAI): A Technical Overview  In addition, there is one uncommon case where it is possible to downgrade an address mechanically to a substitute ASCII address. If an address is of the form <ascii@Ulabels>— that is, an ASCII local-part and a UTF-8 domain-part—it is permissible to replace the U-labels in the domain with A-labels, producing an ASCII address. This is the only mechanical downgrade possible. In particular, there is no mechanical downgrade possible from a UTF-8 local-part. If there is a substitute address, downgrade the address by replacing the original address with the ASCII substitute. If there is no substitute, downgrading the address removes the original address from the header and replaces it with an empty address group, written as a colon followed by a semicolon :;.10 It is possible to copy the original EAI address into an address comment to show the recipient what the address was, but the legacy recipient cannot reply to it. Consider this example, where capital letters indicate UTF-8 text, and underlined text means a MIME encoded-word. Before: After: From: “CCCCC” <MMMM@DDDD.DDD> From: “CCCCC MMMM@DDDD.DDD” :; The comment (CCCCC) and the EAI address (MMMM@DDDD.DDD) are moved into an encoded-word comment, and the address is replaced by an empty group to keep the header syntactically valid. The exact details of the encoded-word comment don’t matter because it’s a comment. Note that the rewritten form no longer contains an address that the recipient can reply to. This example is a From: address but the same modifications work on all address headers. If there is more than one address in an header, handle each one separately, converting EAI addresses and leaving legacy addresses alone. Downgrading other headers that users see Headers displayed to users can use MIME encoded-words to represent UTF-8 text. For any UTF-8 text in a message header, turn any UTF-8 into encoded-words. This includes text in Subject:, Comment:, and Keyword: headers, and many semi-standard headers such as Organization:. Downgrading headers that users do not see As mentioned above, Message-ID: headers should not have non-ASCII characters. If the Message-ID nonetheless does have non-ASCII characters, delete it and create a new one. (Since the ID is an opaque string, there’s no benefit in trying to create a downgraded ID that looks like the original one.) Message-IDs also appear in References: and In-Reply-To: 10 Mail standards originally limited empty groups to specific headers, but RFC 6854 relaxed the rules to allow them anywhere an address can appear. UASG012: Email Address Internationalization (EAI): A Technical Overview  headers. If those headers contain non-ASCII IDs, delete the ID, and if there are no other IDs left in the header, delete the header. If any other headers not shown to users have UTF-8 characters, delete them, since there’s no way to downgrade them and they won’t affect what the user sees. If a MIME Content-Type header, either in the message headers or in the header of a MIME body part, contains a field with non-ASCII text, delete that field. All required fields in these headers are ASCII. If the header has no fields left, delete the header. UASG012: Email Address Internationalization (EAI): A Technical Overview  Downgrading in POP and IMAP If a POP or IMAP mailbox contains EAI messages but the MUA client does not support EAI, the POP or IMAP server has the option of downgrading the EAI messages so the user can see at least an approximation of what was sent. The downgrade process is the same as that described above, except that POP and IMAP servers are unlikely to have substitute addresses. This is addressed in more detail in RFC 6858. Downgrade notes If a downgraded message has a DKIM signature, the downgrade will invalidate the signature, so delete the signature. In some cases it’s possible to re-sign. See the next section. Rather than trying every EAI message sent to a non-EAI address to see if it works, when a message fails, if the recipient address is in an address book, tag the entry as legacy only. (Also provide some way to remove the tag when the recipient system upgrades.) Out-of-office, read receipts, and other autoresponders Mail systems often allow automatic responses for out-of-office and similar notifications. From an EAI point of view, autoresponder mail is like any other mail. If the recipient of the response (that is, the sender of the original message) has an EAI address, or is otherwise known to accept EAI mail, the autoresponse can be an EAI message. Otherwise it should be a legacy message, either created as a legacy message or downgraded from an EAI message. Mail authentication and spam filters As spam becomes an ever-worsening problem, mail systems have added a wide variety of anti-spam features. Among the most effective of those is authentication, showing that the message was in fact sent by its purported sender. For details on EAI and mail authentication beyond the discussion below, see the Internet Draft  SPF authentication SPF (Sender Policy Framework) checks the IP address from which a message was sent against a list of authorized IPs for a domain. The domain checked is the domain in the MAIL FROM: bounce address, or if that address is empty, in the EHLO/HELO argument. A domain publishes its authorized addresses in a TXT record with a fairly complex syntax. The SPF record for icann.org is typical: icann.org IN TXT “v=spf1 ip4:192.0.32.0/20 ip4:199.91.192.0/21 ip4:64.78.40.0/27 ip4:162.216.194.0/27 ip6:2620:0:2d0::0/48 ip6:2620:0:2830::0/48 ip6:2620:0:2ed0::0/48 include:salesforce.icann.org -all” This lists several IPv4 and IPv6 address blocks, and includes all the blocks published at salesforce.icann.org. UASG012: Email Address Internationalization (EAI): A Technical Overview  Using SPF in EAI mail is straightforward. Since the information is published in the DNS, a validator performs the usual IDNA domain lookup, turning U-labels into A-labels and then doing a DNS query. The SPF records themselves don’t contain any UTF-8 so the processing to see whether an IP address matches an SPF record is unchanged. DKIM authentication Sending and relaying MTAs use DKIM to add cryptographic signatures to mail messages. A receiving system can check the signature. If it’s valid, it knows that the message it checked is the same one the signer signed. The signature is placed in a DKIM-Signature header, such as this one on a message from Microsoft: DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; s=rm1; h=From:Date:Subject:Message-ID:Content-Type:MIME-Version; i=billg@microsoft.com; bh=SwUgUaGo9gVX7cc6F206JZvUfMea/5YYkAej9uuVF6Q=; b=EdBiodGIf4bCmbGEZBQFUa+MCfoPhm138ox5x6iq4FCmITu522v1Q/9t/A+E= The signature is a list of tag=value items. The tag is the domain that applied the signature, and the s= tag is a “selector” used to find the validation key in the DNS. The optional i= tag is an identity meaningful to the signer.11 The bh= tag is a hash of the message’s body, and the b= tag is a signed hash of selected message headers along with the DKIMSignature itself. A receiving system checks the hashes against the received message and the validation key in the DNS to see if the signature is valid. The validation key is stored in the DNS at <selector>._domainkey.<domain>, so in this case, since the s= selector is rm1 and the d= domain is microsoft.com, it would be (omitting some uninteresting details): rm1._domainkey.microsoft.com. TXT "v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCkHq3ztGIm1R8alD+7oZiaG5mT;" EAI makes some small changes to DKIM signatures. The s= selector and the domains in the d= and i= tags can be U-labels, and the i= string can also be UTF-8.12 This should have no effect when creating DKIM signatures, since the characters in the domains are handled like any other characters in the message. When verifying a DKIM signature, any Ulabels in the d= domain or s= selector must be converted to A-labels for the DNS lookup. If a system downgrades a message, the changes from downgrading will change the message enough that existing DKIM signatures become invalid. If the downgrading happens in an MUA, the message will generally be re-signed as it passes through the MSA. If a message is downgraded in an MSA or MTA, the message should be re-signed if the MSA or MTA has the signing key available. 11 Although the i= tag has the same syntax as an email address, it need not be the address of the person who sent the message, or of anyone else. 12 RFC 6376 says that the domains in signatures should all be A-labels, but this is likely to change. UASG012: Email Address Internationalization (EAI): A Technical Overview  DMARC authentication DMARC is an anti-phishing scheme that uses the authentication results of SPF and DKIM to validate the domain in the From: header. If a domain publishes a DMARC policy in the DNS, receivers check to see if the message has a valid SPF result or DKIM signature for that domain. If so, the message passes. This doesn’t mean it’s not spam, but it does mean it really is from the purported sender. For example, assume the From: header says: From: Bob Smith <bob@example.com> The DMARC validator checks to see if the SPF check is from example.com (that is, the MAIL FROM: address was at example.com) and succeeded, or that the message has a valid DKIM signature with d=example.com. If either is so, the DMARC check succeeds. Once an EAI system has implemented SPF and DKIM, there is little additional work for DMARC. When checking the domain in the From: header, if the domain is an IDN, either the A-label or U-label version of the IDN can match the SPF domain or the DKIM d= domain. Spam filtering EAI makes little difference to spam filtering techniques. Since everything in the message other than the To:/From:/Cc:13 header addresses could already be UTF-8, filters already deal with internationalized text. If a filtering system provides whitelisted and blacklisted sending addresses, those lists should handle EAI addresses, and when checking against incoming mail, should handle both U-label and A-label versions of the domains. One possible source of trouble is empty address groups in downgraded messages. Groups have been allowed in To: and Cc: headers since the 1970s, but have only been allowed in From: headers since RFC 6854 in 2013. There are still some mail systems that consider From: groups to be invalid, in some cases displaying them wrong and in a few cases treating the whole message as spam. 13 Incoming messages do not normally have Bcc headers because they are supposed to be stripped out as a message is sent. UASG012: Email Address Internationalization (EAI): A Technical Overview  Appendix A: Handling message header fields In this table “Substitute or delete EAI address” means to replace the address with a legacy address if possible, otherwise delete the address as described in “Downgrading headers with addresses” above. “Allow UTF-8 text” means literal text in preference to MIME encoded-words. Header Field Name EAI changes Downgrade actions Authentication-Results Allow IDN domains where domains appear Delete if contain UTF-8 Bcc Allow EAI addresses Substitute or delete EAI addresses, delete header if no addresses remain Cc Allow EAI addresses Substitute or delete EAI addresses Comments Allow UTF-8 text Use MIME encoded-words for UTF-8 text Content-Description Allow UTF-8 text Use MIME encoded-words for UTF-8 text Content-ID None Delete if contains UTF-8 Content-Transfer-Encoding None None UASG012: Email Address Internationalization (EAI): A Technical Overview  Content-Type Usually none, possible UTF-8 in optional filename tags Delete any tags with UTF-8 values Date None None DKIM-Signature Allow IDNs in d= i= s= tags, allow UTF-8 in i= local part Delete and re-sign Errors-To Possibly allow EAI addresses Substitute EAI addresses or delete header From Allow EAI addresses Substitute or delete EAI addresses In-Reply-To None Delete UTF-8 message-IDs, delete header if no messageIDs remain. Keywords Allow UTF-8 text Use MIME encoded-words for UTF-8 text List-Archive Mailto: URI can contain EAI addresses Substitute or delete EAI addresses, delete header field if no URIs remain List-Help Mailto: URI can contain EAI addresses Substitute or delete EAI addresses, delete header field if no URIs remain List-ID None. (UTF-8 text not recommended.) Delete if contains UTF-8 text UASG012: Email Address Internationalization (EAI): A Technical Overview  List-Owner Mailto: URI can contain EAI addresses Substitute or delete EAI addresses, delete header if no URIs remain List-Post Mailto: URI can contain EAI addresses Substitute or delete EAI addresses, delete header if no URIs remain List-Subscribe Mailto: URI can contain EAI addresses Substitute or delete EAI addresses, delete header if no URIs remain List-Unsubscribe Mailto: URI can contain EAI addresses Substitute or delete EAI addresses, delete header if no URIs remain Message-ID None Should be none, delete and replace any UTF-8 messageID header MIME-Version None None Organization Allow UTF-8 text Use MIME encoded-words for UTF-8 text Received Allow IDN domains and EAI mailboxes Delete if contains UTF-8 text References None Delete UTF-8 message-IDs, delete header if no messageIDs remain. Reply-To Allow EAI addresses Substitute or delete EAI addresses, delete header field if no addresses remain UASG012: Email Address Internationalization (EAI): A Technical Overview  Resent-Bcc Allow EAI addresses Substitute or delete EAI addresses, delete header field if no addresses remain Resent-Cc Allow EAI addresses Substitute or delete EAI addresses Resent-Date None None Resent-From Allow EAI addresses Substitute or delete EAI addresses Resent-Message-ID None Should be none, delete and replace any UTF-8 ID Resent-Sender Allow EAI addresses Substitute EAI address or delete header field Resent-To Allow EAI addresses Substitute or delete EAI addresses Return-Path Allow EAI address Delete if contains UTF-8 Sender Allow EAI addresses Substitute EAI address or delete header field Subject Allow UTF-8 text Use MIME encoded-words for UTF-8 text UASG012: Email Address Internationalization (EAI): A Technical Overview  To Allow EAI addresses Substitute or delete EAI addresses Appendix B: Summary of steps necessary to move to EAI Here is a summary of software changes to add EAI capabilities to various kinds of mail software. Changes to MTAs ● ● ● ● Distinguish EAI from legacy messages, either by external tag or by scanning for UTF-8 in headers As a server, advertise SMTPUTF8 EHLO keyword, accept SMTPUTF8 keyword on MAIL FROM:, put UTF8SMTP in Received: header As a client, look for SMTPUTF8 EHLO keyword, send SMTPUTF8 keyword on MAIL FROM: If sending an EAI message fails, downgrade the message and resend, but only if MTA has necessary address book info and DKIM signing keys Changes to MSAs ● ● ● Advertise SMTPUTF8 EHLO keyword Distinguish EAI from legacy messages by MAIL FROM: keyword If sending an EAI message fails, downgrade the message and resend, but only if MSA has necessary address book info and DKIM signing keys Changes to MUAs ● ● ● ● Allow UTF-8 in addresses in messages Allow UTF-8 in addresses in address books, allow entries to have both EAI and legacy addresses Look for SMTPUTF8 EHLO keyword from MSA, add SMTPUTF8 keyword on MAIL FROM:, don’t send EAI messages to MSAs that can’t handle them If sending an EAI message fails, downgrade the message and resend, but only if MUA has necessary address book info IMAP Servers ● ● ● ● Support UTF-8 folder names Tag messages as EAI or legacy, either by tag set when message created or by scanning headers Add UTF-8=

ACCEPT

 IMAP feature (Optional) Downgrade EAI messages as needed for legacy clients UASG012: Email Address Internationalization (EAI): A Technical Overview  POP Servers ● ● ● Tag messages as EAI or legacy, either by tag set when message created or by scanning headers Add UTF8 capability and UTF8: command (Optional) Downgrade EAI messages as needed for legacy clients Appendix C: How does SMTP work? SMTP uses a series of commands and responses to transfer a message from one mail server to another. The commands and responses are all ASCII characters (other than EAI addresses.) Responses start with a three-digit number which provides the meaning of the response, followed by text, which is generally a comment. In the example below, user sam@sender.org is sending mail to ray@receive.net. To keep things simple, the sending host is sender.org and the recipient host is receive.net. First, the sending computer connects, and the receiving computer sends an initial response. The sending computer sends EHLO (extended hello) to identify itself and ask for a list of features that the receiving computer supports: S: <connect> R: 220 receive.net ESMTP S: EHLO sender.org R: 250-8BITMIME R: 250 PIPELINING Code numbers of the form 2xx indicate success. In this example, the recipient host supports two features, 8BITMIME and PIPELINING. Nearly all hosts support these. (8BITMIME allows non-ASCII text in message bodies, PIPELINING allows the sender to send multiple commands without waiting for a receipt for each one.) The sending computer sends a MAIL FROM: command, identifying the sender address to which status and non-delivery reports can be sent, and optionally also other envelope information. S: MAIL FROM:<sam@sender.org> R: 250 Sender accepted The sending computer sends RCPT TO: commands, each with a recipient address to which the message is sent. S:RCPT TO:<ray@receive.net> R:250 Recipient accepted (If there were more than one recipient, there would be a separate RCPT TO: command and response for each one.) The sending computer sends a DATA: command, and then, when the receiving computer responds, it sends the message as a single block of text, the header followed by the entire message including header and body, followed by a line with a single dot which indicates the end of the message. UASG012: Email Address Internationalization (EAI): A Technical Overview  S:DATA R:354 Send your message S:From: sam@sender.org S:To: ray@receive.net S:Subject: lunch S: S:How about lunch at 12:30? S:. R:250 Message accepted 409343fg34 At this point the message is complete, so the sender uses QUIT to end the session. S:QUIT R:221 Sayonara Adding UTF-8 features to the SMTP example EAI makes small changes to the protocol. The server’s response to EHLO contains a UTF8SMTP keyword to indicate that the server supports EAI: S: <connect> R: 220 receive.net ESMTP S: EHLO sender.org R: 250-8BITMIME R: 250-UTF8SMTP R: 250 PIPELINING The client’s MAIL FROM: command includes a SMTPUTF8 keyword to indicate that a message is an EAI message. S: MAIL FROM:<猫王@普遍接受-测试.世界> SMTPUTF8 R: 250 Sender accepted The rest of the SMTP session is unchanged, other than allowing UTF-8 data in mail headers: S:RCPT TO:<ray@receive.net> R:250 Recipient accepted S:DATA R:354 Send your message S:From: 猫王 <猫王@普遍接受-测试.世界> S:To: ray@receive.net S:Subject: 我们要吃午饭吗? S: S:How about lunch at 12:30? S:. R:250 Message accepted 389dck343fg34 S:QUIT R:221 Sayonara UASG012: Email Address Internationalization (EAI): A Technical Overview  Appendix D: Relevant RFCs Most of the specifications for Internet services are developed and maintained by the Internet Engineering Task Force (IETF), a group affiliated with the Internet Society. The IETF’s major publication series is known for historical reasons as Requests for Comments or RFCs. Each RFC is numbered, starting with RFC 1 in 1969 and currently up to about RFC 8300. Some RFCs are standards, while others describe best current practices or report other information relevant to the technical operation of the Internet. The IETF sometimes issues new standards RFCs that update or replace prior standards. When they do, they generally avoid changes that are incompatible with existing standards. All RFCs are available to the public at no charge at the RFC Editor’s web site at  and at many other places around the Internet. Important mail RFCs Here are some of the more important RFCs. For a longer list see UASG 006, For SMTP: ● ● RFC 5321 - Simple Mail Transfer protocol, from one MTA to another (previously RFCs 821 and 2821) RFC 6609 - Mail submission, from MUA to MSA (previously RFCs 2476 and 4409) For mail message formats: ● ● ● ● ● ● ● ● RFC 5322 - Internet Message Format (previously RFCs 822 and 2822) RFC 2045 - Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies RFC 2046 - Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types RFC 2047 - MIME (Multipurpose Internet Mail Extensions) Part Three: Message Header Extensions for Non-ASCII Text RFC 2048 - Multipurpose Internet Mail Extensions (MIME) Part Four: Registration Procedures RFC 2049 - Multipurpose Internet Mail Extensions (MIME) Part Five: Conformance Criteria and Examples RFC 3464 - An Extensible Message Format for Delivery Status Notifications RFC 6854 - Update to Internet Message Format to Allow Group Syntax in the "From:" and "Sender:" Header Fields For POP and IMAP: ● ● RFC 1939 - Post Office Protocol - Version 3 (POP3) RFC 3501 - Internet Message Access Protocol - Version 4rev1 (IMAP4) For IDNs: ● ● RFC 3629: UTF-8, a transformation format of ISO 10646 RFCs 5890, 5891, 5892, 5893, 5894, and 5895 - Internationalized Domain Names for Applications (IDNA) UASG012: Email Address Internationalization (EAI): A Technical Overview  For EAI mail: ● ● ● ● ● ● ● ● RFC 6530 - Overview and Framework for Internationalized Email RFC 6531 - SMTP Extension for Internationalized Email RFC 6532 - Internationalized Email Headers RFC 6533 - Internationalized Delivery Status and Disposition Notifications RFC 6855 - IMAP Support for UTF-8 RFC 6856 - Post Office Protocol Version 3 (POP3) Support for UTF-8 RFC 6857 - Post-Delivery Message Downgrading for Internationalized Email Messages RFC 6858 - Simplified POP and IMAP Downgrading for Internationalized Email For PRECIS and string mapping: ● ● ● ● ● ● ● RFC 8264 - PRECIS Framework: Preparation, Enforcement, and Comparison of Internationalized Strings in Application Protocols RFC 8265 - Preparation, Enforcement, and Comparison of Internationalized Strings Representing Usernames and Passwords RFC 8266 - Preparation, Enforcement, and Comparison of Internationalized Strings Representing Nicknames RFC 7790 - Mapping Characters for Classes of the Preparation, Enforcement, and Comparison of Internationalized Strings (PRECIS) RFC 6885 - Stringprep Revision and Problem Statement for the Preparation and Comparison of Internationalized Strings (PRECIS) RFC 6943 - Issues in Identifier Comparison for Security Purposes UTS#39 - Unicode Security Mechanisms, sections 3.3 Email Security Profiles for Identifiers and 5.2 Restriction Level Detection For SASL (logging in and authenticating for POP, IMAP, and submission): ● ● ● ● RFC 4422 - Simple Authentication and Security Layer (SASL) RFC 4616 - The PLAIN Simple Authentication and Security Layer (SASL) Mechanism The LOGIN SASL Mechanism Internet draft IANA SASL methods registry For URLs and URIs: ● ● RFC 3986 - Uniform Resource Identifier (URI): Generic Syntax. RFC 3897 - Internationalized Resource Identifiers (IRIs) For message authentication: ● ● ● ● RFC 6376 - DomainKeys Identified Mail (DKIM) Signatures RFC 7208 - Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, Version 1 RFC 7489 - Domain-based Message Authentication, Reporting, and Conformance (DMARC) Eaiauth draft - Email Authentication for Internationalized Mail UASG012: Email Address Internationalization (EAI): A Technical Overview  For input and display of RTL and mixed direction text: ● RFC 5893 - Right-to-Left Scripts for Internationalized Domain Names for Applications (IDNA) Appendix E: Other sources of advice ● ● ● ● ● ● UASG documents at  For mail format and specification standards, see email RFCs; see the list above For HTML and other web data standards, see the W3C website at  Stack Overflow for general mail programming,  Discussion lists for mail software. Most lists have online archives; check the archives to see if your question has already been asked and answered. ○ Postfix  ○ Qmail  and  ○ Sendmail  ○ Cyrus IMAP  ○ Dovecot  IETF working group discussion lists. These are useful for questions about RFCs and details of how to implement them, but not for general mail or programming questions. ○ DKIM mailing list, ietf-dkim@ietf.org ○ DKIM operations list, dkim-ops@mipassoc.org ○ DMARC mailing list, dmarc-discuss@dmarc.org ○ SMTP mailing list, ietf-smtp@ietf.org UASG012: Email Address Internationalization (EAI): A Technical Overview  Glossary A-label: An ASCII encoded version of a UTF-8 domain label, in the form xn--stuff where the stuff is a punycode version of the UTF-8. Compare to U-label. Address book: A list of email addresses and related contact information. ASCII Compatible Encoding (ACE): The format used in an A-label, in the form xn--stuff where the stuff is a punycode version of the UTF-8. Authentication: Verifying the source of, or other information about, the origin of a message. Bidi rule: The rule that prohibits combining left-to-right and right-to-left text in a single domain name label. Defined in RFC 5893, section 2. Body: The contents of a message, which follows the headers. The body may be unformatted text, or it may be one or more formatted or encoded MIME parts. Encoded words: A MIME format that represents UTF-8 text (other than addresses) as ASCII in message header lines. Looks like =?utf-8?Q?stuff?=. Envelope: Information that accompanies a message in transit, including the address(es) it is being sent to, and the return address to which error or failure reports can be sent. Field names: The names of mail header fields such as From:, To:, and Subject:. Hostname: a DNS record that identifies a computer on the Internet. The characters in hostnames are restricted to those allowed by the LDH rule IDNA: Internationalized Domain Names in Applications. The rules for characters and their combinations that can appear in UTF-8 domain names. The current version is IDNA2008, defined in RFCs 5891-5895. IMAP: Internet Message Access Protocol, a standard for managing mail messages and folders on remote servers. The current version is IMAP4. Compare to POP. LDH rule: The rule that DNS host names can only contain Letters, Digits, and Hyphens. Further rules forbid leading or trailing hyphens, and names with hyphens in the third and fourth positions. Legacy address: An email address that consists of only ASCII characters. Compare to an internationalized address. Legacy mail: Messages with only legacy addresses. Compare to EAI mail. Linkify and linkification: Automatically formatting text to add clickable links to HTML URLs in the text. Mail delivery agent (MDA): A server program that handles incoming mail and typically stores it in a mailbox or folder. Mail folder: A collection of messages with a name. A mailbox can contain multiple folders. Mail header: The collection of structured fields at the beginning of a mail message preceding the mail body. Each field starts with a field name and a colon, and consists of one or more lines. Mail submission agent (MSA): A server program that receives mail from a MUA and prepares it for transmission and delivery. UASG012: Email Address Internationalization (EAI): A Technical Overview  Mail transmission agent (MTA): A server program that sends and receives mail to and from other Internet hosts. An MTA may receive mail from an MSA and/or deliver mail to an MDA. Mail user agent (MUA): A client program that a person uses to send, receive, and manage mail. Popular MUAs include Outlook and Thunderbird. Mailbox: A place to store messages associated with a mail address. A mailbox may be a single folder or a collection of folders. Metadata: Information about a mail message, distinct from the message itself. Metadata may include the time the message was sent or received and whether the recipient has opened it. MIME: Multipurpose Internet Mail Extensions, a specification for encoding different kinds of data including non-ASCII text, and for including multiple logical parts in a single message. MX: Mail Exchanger, a DNS record that identifies a host that receives mail for a domain. Normalization: Transforming text into a standard representation, e.g., combining separate character and accent codepoints into precomposed codepoints. Normalization Form C (NFC): A profile of Unicode in which characters are precomposed. POP: Post Office Protocol, a standard for retrieving messages from a remote server. The current version is POP3. Compare to IMAP. Precomposed: A character that is represented as a single codepoint rather than as a separate base character and accents and other modifiers. PRECIS: Preparation and Comparison of Internationalized Strings, a set of IETF documents that set out principles for creating UTF-8 usernames and nicknames. Procmail: An MDA popular on Unix and Linux systems. Wikipedia article. Punycode: An ASCII encoding of UTF-8 used in ACE A-labels (RFC 3492). SASL: Simple Authentication and Security Layer, a set of IETF standards that define the username and password authentication schemes used to log into SUBMIT, IMAP, and POP servers. Script: A collection of codepoints used to write a language. Some languages such as English are written in a single script, others such as Japanese are written in multiple scripts. SIEVE: A language for filtering and sorting incoming mail messages (RFC 5228). SMTP: Simple Mail Transport Protocol, the way computers on the Internet exchange mail String preparation: Turning a UTF-8 string into a standard form to make it easier to process. SUBMIT or submission: transmitting a newly created message for relay and/or delivery (RFC 6409) U-label: A UTF-8 domain label. Compare to A-label. Variant characters: Characters in a script with the same meaning but different visual representations. UASG012: Email Address Internationalization (EAI): A Technical Overview // ==================== Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks 14 September 2020 Report UASG018A TABLE OF CONTENTS Introduction 3 New Libraries and Frameworks 5 Methodology 6 Datasets 6 H_DNS 6 H_ES (to check EAI) 6 H_ID 6 L_A2U 6 L_U2A 6 Results 7 Discussion 8 C - Libcurl (EAI) 8 C - Libidn2 (IDNA2008) 9 C# - Mailkit (EAI) 9 C# - Microsoft - System.Globalization.IdnMapping (IDNA2008) 9 Go - Idna (IDNA2008) 9 Go - Mail (EAI) 9 Go - Smtp (EAI) 10 Java - commons-validators (EAI, IDNA2008) 10 Java - guava (IDNA2008) 10 Java - ICU (IDNA2008) 10 Java - Jakartamail (EAI) 10 Java - JRE - java.net.IDN (IDNA2008) 11 Javascript - idna-uts46 (IDNA2008) 11 Javascript - nodemailer (EAI) 11 Javascript - validator (EAI) 11 Python 3 - django auth (EAI) 11 Python 3 - email_validator (EAI) 12 Python 3 - encodings_idna (IDNA2008) 12 Python 3 - idna (IDNA2008) 12 Python 3 - smtplib (EAI) 12 Rust - idna (IDNA2008) 12 Rust - lettre (EAI) 13 Conclusion 13 Addendum: Appendix A: Requirements for the test data sets 14 Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 2 Introduction This document describes the results of the second phase of the work done before. The results of the previous phase are available on the UASG site. This new phase expands the previous work by adding new languages and frameworks and also verifying the compliance of internationalized email (EAI). The first phase of the work verified the following languages and libraries for Universal Acceptance readiness: Language Framework/Library Java Commons Validator Java Guava Java ICU Java JRE Python3 Django_auth Python3 Encodings_Idna Python3 Idna Rust Idna These frameworks were essentially using domain names as their primary objects, so internationalized email was not tested. This document describes the results of verifying the following languages and frameworks, including the testing of internationalized email: Language Framework/Library C libcurl C libidn2 C# Mailkit C# Microsoft Go Idna Go Mail Go Smtp Java Commons-Validator Java Guava Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 3 Java ICU Java Javamail/JakartaMail Java JRE Javascript Idna-uts46 Javascript Nodemailer Javascript Validator Python3 Django_auth Python3 Email_Validator Python3 Encodings_Idna Python3 Idna Python3 Smtplib Rust Idna Rust Lettre The same libraries and frameworks from the first phase were verified again to see if there are improvements or regressions against their newest versions. Additional libraries and frameworks for the same language were added mostly because the new ones support email addresses. In summary, most libraries and frameworks from previous phase were not improved for the purpose of universal acceptance. The following table list the new versions verified under this work. Language Framework/Library Previous Phase This phase Java Commons-validator 1.6 1.6 Java Guava 26 28 Java ICU 51.1 67.1 Java JRE 10 11 Python3 Django_auth 2.7 3.0.7 Python3 Encodings_idna 3.7 3.8 Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 4 Python3 Idna 2.7 2.9 Rust Idna 0.1.4 0.2.0 New Libraries and Frameworks This work verifies compliance of 4 new languages and 14 new libraries and frameworks, as listed below. Language Library/Framework Version C libcurl 7.70.0 C libidn2 2.3.0 C# mailkit 2.7.0 C# microsoft (IdnMapping) .net core 3.1.301 Go idna 1.14.4 Go mail 1.14.4 Go smtp 1.14.4 Java Jakarta Mail 1.6.5 Js Idna-uts46 1.1.0 Js nodemailer 10.7.1 Js validator 13.1.1 Python3 email_validator 1.1.1 Python3 smtplib 3.8 Rust lettre 0.9.3 Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 5 Mobile platforms languages and libraries will be tested in a follow-up work. Methodology In order to verify Universal Acceptance readiness, 5 datasets of sample internationalized domain names & email addresses were used. The next section gives a short description of each one. These datasets are described in detail in UASG004 and UASG018 For email address internationalization (EAI), a dummy SMTP server, based on the popular Mailhog SMTP server, was used to verify the support of the SMTPUTF8 SMTP option by the mailer libraries and frameworks. However, Mailhog does not support SMTPUTF8 so we used a fork that enhance it to support SMTPUTF8. This dummy server, running within a docker, simulates communication with a real SMTP server from the library/framework perspective and checks if it behaves as expected. Datasets H_DNS Performs a syntactic check on a domain name. Determines whether the name appears to be correctly formed. If any part of the name already appears to be in ASCII form (an A-label), verify it can be converted to Unicode. Ref. RFC5891, RFC1035, SAC053 H_ES (to check EAI) Performs a syntactic check on an email address. Determines whether the address appears to be correctly formed. Ref. RFC5891, RFC6531 H_ID Compares the identifier stored in the system against the one used to authenticate by the user. The test cases aim to validate proper handling of internationalized identifiers by applications. Ref. RFC8264 L_A2U Converts a domain name in ASCII to Unicode using the process described in RFC5891. If the domain name, or any constituent label, is already in Unicode or an ASCII label does not begin with the ACE prefix, the original label should not be altered. Ref. RFC5891 L_U2A Converts a domain name in Unicode to ASCII using the process described in RFC5891 for domain name lookup. If the domain name, or any constituent label, is already in ASCII, the ASCII should not be altered. Ref. RFC5891, UTS#46 Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 6 Results Here is the complete list of libraries with their compliance with the corresponding dataset, with a color indicating if they are UA ready or not. Yellow color indicates that some edge cases are not supported or the library needs to be used along with another one to be compliant. Legend UA ready UA ready but developer needs to be careful UA not ready Language Lib Name Compliance on dataset (%) Datasets c libcurl 84.3 HEs c libidn2 95.2 LA2U ,LU2A csharp mailkit 84.3 HEs csharp microsoft 83.9 LA2U ,LU2A go idna 79 LA2U ,LU2A go mail 100 HEs go smtp 19.6 HEs java commons-validator 85.5 HEs ,HDns java guava 77.8 HDns Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 7 java icu 93.5 LA2U ,LU2A java jakartamail 82.4 HEs java jre 71 LA2U ,LU2A js idna-uts46 85.5 LA2U ,LU2A js nodemailer 84.3 HEs js validator 94.2 HEs ,HDns python3 django_auth 48.1 HEs ,HId python3 email_validator 86.3 HEs python3 encodings_idna 67.7 LU2A ,LA2U python3 idna 100 LA2U ,LU2A python3 smtplib 84.3 HEs rust idna 87.1 LA2U ,LU2A rust lettre 7.8 HEs Discussion Detailed results are available at  C - Libcurl (EAI) UA ready but developer needs to be careful Even if libcurl sends properly the SMTPUTF8 flag, validations done by libcurl are insufficient: we were able to send email to multiple invalid addresses. Developers need to use another library to validate the address before sending it. Libcurl was chosen because it is by far the most popular and used library in C for sending & downloading content. Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 8 C - Libidn2 (IDNA2008) UA Ready Supports well IDNA2008 as advertised. Libidn2 was chosen because it is the next generation of the well established Gnu Libidn (IDNA2003). C# - Mailkit (EAI) UA ready but developer needs to be careful Similar to libcurl, this library supports the STMPUTF8 flag, but multiple invalid email addresses were allowed. Mailkit was chosen because it is recommended by Microsoft over native C# SmtpClient, since the latter is deprecated by Microsoft: C# - Microsoft - System.Globalization.IdnMapping (IDNA2008) UA Ready Microsoft provides natively in the .NET framework utilities to convert A-label & U-label. It supports IDNA2008 as advertised. We found some false positives where the library converts domains known as unconvertable. Go - Idna (IDNA2008) UA ready but developer needs to be careful Go provides a library natively compatible with IDNA2008 as advertised. However, we found not only false positives, but also valid domains that net/idna was not able to convert. Go - Mail (EAI) UA ready but developer needs to be careful Go native mail validation/parsing/mailer package. This library is very good for validating and parsing EAI. However, it should not be used to send email since it is based on net/smtp which does not send SMTPUTF8. See next. Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 9 Go - Smtp (EAI) UA not ready Go native mailer package. Does not support STMPUTF8 flag. Java - commons-validators (EAI, IDNA2008) UA not ready A popular Apache package to validate email addresses, domains and many other things. Since the validation is based on a static list of TLDs, it is not recommended to use as the static list is always not to date. No new version since February 2017. Java - guava (IDNA2008) UA not ready A popular utilities library from Google. As it is advertised: "validation against RFC 3490 ("Internationalizing Domain Names in Applications") is skipped" (IDNA2003). It supports many U-Label since "validation against RFC 1035 is relaxed", see "InternetDomainName.from(input)" method. Java - ICU (IDNA2008) UA Ready Library from the Unicode Consortium. Developers must use a combination of flags to correctly support IDNA2008. The following code show how to initialize the validator: IDNA validator = IDNA.getUTS46Instance( IDNA.NONTRANSITIONAL_TO_ASCII | IDNA.NONTRANSITIONAL_TO_UNICODE | IDNA.CHECK_BIDI | IDNA.CHECK_CONTEXTJ | IDNA.CHECK_CONTEXTO | IDNA.USE_STD3_RULES) Java - Jakartamail (EAI) UA Ready Native library (previously named Javamail) to send mail. Now under the stewardship of the Eclipse foundation. Supports correctly EAI since 1.6.4. Version 1.6.5 was verified. Since email address validation is made automatically before sending the email, this library is a good choice. Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 10 Java - JRE - java.net.IDN (IDNA2008) UA not ready Native lib to convert U-label and A-label. Based on IDNA2003. Not recommended. Javascript - idna-uts46 (IDNA2008) UA ready but developer needs to be careful Converter for U-label and A-label. Despite its name, it is possible to configure the lib for IDNA2008 only (transitional = false). It doesn't implement Bidi and contextual rules for validation. This library seems the only one available for the task. Javascript - nodemailer (EAI) UA ready but developer needs to be careful Mailer for NodeJs. Supports SMTPUTF8 flag. Nodemailer doesn't validate email addresses thoroughly, therefore it must be used with an email validation library like "validator", see next. Javascript - validator (EAI) UA Ready Popular javascript package for various validation. Very good compliance on our dataset, can be used to validate & normalize email before sending email with nodemailer for instance. Python 3 - django auth (EAI) UA not ready Popular web package to manage authentication with emails. Non compliant over basic international email addresses. Maintainers seems to have rejected the following pull request that would have make the lib compliant (identified in UASG018):  e65c60 Here is an extract of the discussion made on the issue: Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 11 "RFC 6531 does define a new SMTPUTF8 extension  to allow (notably) non-ASCII chars in email addresses. Usage seems to be very scarce however at this time. Allowing non-ASCII chars when 95% of mail servers do currently not seem to support that is debatable." - Claude Paroz  Python 3 - email_validator (EAI) UA Ready Popular lib to validate & normalize email addresses. Very good compliance over the dataset. Python 3 - encodings_idna (IDNA2008) UA not ready Native converter for U-label and A-label. Based on IDNA2003. Not recommended. Python 3 - idna (IDNA2008) UA Ready Very good IDNA2008 compliant library. The most compliant library with our dataset we tested until now. Compliant with IDNA2008 as advertised. Highly recommended. Python 3 - smtplib (EAI) UA ready but developer needs to be careful Native library for sending email. Supports SMTPUTF8 flag. Needs to be used with an email validation/normalization library like email_validator before sending the email. Rust - idna (IDNA2008) UA Ready Native library for conversion between U-label & A-label. Supports IDNA2008, good compliance on the datasets. Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 12 Rust - lettre (EAI) UA not ready Native library for sending email. Since Lettre uses an EmailAddress object that works only with ASCII addresses, Lettre does not support EAI even if SMTUTF8 supports is advertised. See  Conclusion Many of the new tested libraries claim to support or support recently IDNA2008 and EAI. To name a few: • C - libcurl starts to support EAI this year at version 7.69.0 (we tested 7.70.0), see: • Java - jakarta mail (previously java mail) starts to stabilize the support at version 1.6.4 (last year, see bug fixes on UTF-8 handling  we tested v1.6.5. • C# - Microsoft IdnMapping was supporting IDNA2003 prior to Windows 8 et make the switch; • Python 3 - smtplib starts to support EAI at version of Python 3.5, we tested 3.8; Therefore, it is good to see progression towards Universal Acceptance. A useful feature for developers would be that SMTP client libraries validate and normalize the email address before sending it. We noticed that Jakarta Mail seems to be the only one to do both tasks. Some libs, like libcurl, transform the domain part to an A-label beforehand, but don't check the local part, nor normalize. Nevertheless, really good libs to validate and normalize are available. Dependencies were found to be troublesome. For example, Go net/mail rely on a smtp lib that doesn't support SMTPUTF8 even if net/mail is perfectly compliant with internationalization RFCs for parsing. Rust Lettre claims to send SMTPUTF8 flag but uses internally an EmailAddress object supporting only ASCII addresses. Detailed results of the tests are available at:  Universal Acceptance Compliance of Some Programming Language Libraries and Frameworks - Report UASG018A - Page 13 ============== Universal Acceptance Readiness Framework 6 April 2020 UA Readiness Framework - Report UASG026 TABLE OF CONTENTS Introduction Categories of Applications Components Web-based Application Considerations Native Application Gating Steps Modeling Applications Web-based Application Native Application Gating Approach Gating Considerations Web-Based Application Components Applications Expected Behaviors Accept Validate Process on Input Store Process on Output Display Tests AT: Accept Test VT: Validate Test P1T: Process on Input Test ST: Store test P2T: Process on Output Test DT: Display Test Proposed Approach Web-Based Application: CMS Sub-Category Summary References 3 3 3 4 4 4 5 5 5 6 6 7 7 8 8 9 9 9 9 9 9 9 9 9 9 9 10 10 10 11 11 11 UA Readiness Framework - Report UASG026  Introduction Universal Acceptance (UA) is about enabling the use of identifier technologies that were not present at the beginning of the Internet deployment, especially when it comes to internationalization. More specifically, and for the purpose of this document, we summarize UA as the conformance status of an application or service that supports the following features: ● ● ● ● Internationalized Domain Name (IDN) ○ Because some software expects a domain name to be in ASCII. Email Address Internationalization (EAI) ○ Because some software expects the local part (e.g. the string at the left of the “@” sign for left-to-right scripts) of an email address to be in ASCII. ○ Because some mail servers or services do not expect to receive emails with the local part of the email address in non-ASCII. Long top-level domain (TLD) strings ○ Because some software expects a TLD string to be no longer than three characters. Added/removed TLD strings ○ Because some software checks TLDs based on an out of date and static list of possible TLDs. Regarding TLD strings being added or removed, it is worth noting that contrary to some user beliefs, TLDs are often added or removed from the root zone, even on a daily basis. For example, during a 10 day period in November 2019, 7 TLDs were removed from the root. Identifying whether or not an application of any kind, on any platform, correctly supports UA can be complicated. The purpose of this paper is to define a scope and framework that will identify the issues facing the developer community so that they can work to fix them and increase UA readiness. Related work on UA is available at  Categories of Applications For the purpose of this study, applications are either web-based or native as described below. Web-based application ● The User Interface (UI) is in a browser. ● The browser is either standalone or embedded. Note that some applications seem native but in fact are displaying HTML pages using an embedded browser. An embedded browser may be in desktop applications, cars, wearables, consumer products, and more. Native application ● Either computer-based or on mobile platforms (mobile phone, tablets, etc.) ● Runs directly on an operating system (OS). ● Does not primarily use a browser or an embedded browser view. UA Readiness Framework - Report UASG026  Components An application is typically made up of various components. Each application category defined above has its own set of components. This work takes a deliberately simplified approach and will only concentrate on the major components of an application. It may mean that sometimes the model is not as accurate for some applications. Splitting the application into components enables the UA compliance work to be applied to various gates between components, as discussed later. Gates can be viewed as functional separations in the application. Web-based Application A web-based application is made up of the following components: ● Web browser: The browser is another application; however, it is an integral part of a web application delivery. Note that sometimes web browsers appear as embedded in a native application. ● Front-end: The front-end is the component that creates and enables code to be executed into the browser. It is responsible for creating HTML and allowing HTML, CSS, and Javascript code to be executed in the browser. ● Back-end: The back-end is the component running on a remote server which typically executes more complex tasks, as well as maintaining state and accessing a database. ● Database: The database is the component storing information on a remote server. A database may be managed by a typical SQL database engine or even just a file. ● Filesystem: The filesystem is the place where files are stored on the operating system (OS). ● External Service: Sometimes an application uses an external service to complement its core functionalities. A typical example of an external service is an authentication service provided internally to an enterprise or by a cloud service provider. Considerations ● ● ● ● Given the nature of current web-based applications, this model is simplified but it does present typical components used in software development and is sufficient for the purpose of this work. Modern web browsers offer local storage which is usually limited in size and capabilities, but could be used by application developers to store UA identifiers. In modern cloud based applications, the front-end and the back-end are typically stateless, so they can be deployed horizontally dynamically in multiple instances as load requires. Therefore, the front-end and the back-end typically do not involve application data storage. Most web sites are typically engineered as applications; therefore, we assume that for the purpose of this work, a web site is a web-based application. Thus, the proposed model may be applied to a web site. Native Application A native application is made of the following components: ● User Interface (UI): The visual interface that interacts with the user. This interface is responsible for collecting user input such as domain names or email addresses. ● Internal: The code processing the user’s input and providing the functions of the application. ● Database: The database is the component storing application information. A UA Readiness Framework - Report UASG026  ● ● database may be managed by a typical SQL database engine, or even just a file. The database may be local or remote. Filesystem: The filesystem is the place where files are stored on the operating system (OS). External Service: Sometimes an application uses an external service to complement its core functionalities. A typical example of an external service is an authentication service provided internally to an enterprise or by a cloud service provider. Gating Steps The UA community has defined the following steps within an application to process UA related identifiers: 1. Accept: how an application accepts the user input which consists of UA identifiers. 2. Validate: how an application validates the UA identifier. 3. Process: after validation, how an application processes the UA identifier. 4. Store: after processing, how an application stores the UA identifier. 5. Display: how an application displays the UA identifier. This work proposes the addition of a step between store and display in order to provide a full sequence of steps that can be used as gates to verify conformance. The new list is as follows: 1. Accept: how an application accepts the user input which consists of UA identifiers. 2. Validate: how an application validates the UA identifier. 3. Process: after validation, how an application processes the UA identifier. 4. Store: after processing, how an application stores the UA identifier. 5. Process: after storing, how an application processes the UA identifier, typically for displaying. 6. Display: how an application displays the UA identifier. It should be noted that for some applications, some steps or gates may not be relevant. For example, some applications may not store identifiers, therefore steps 4 and 5 would be irrelevant. Modeling Applications The two categories of applications are modeled based on their respective components and the gating steps. Tables below show Y when the component plays a role in the step, and M when the component may play a role. Web-Based Application Browser Frontend Accept Validate Y Y (only IDN in URL) M Process Store Process M (local storage) M Display Y M UA Readiness Framework - Report UASG026  Backend M M M Database Y Filesystem Y External service M M M M Native Application Accept UI Y Internal Validate Process Store M M M M Y Filesystem Y M Display Y Database External service Process M M M Gating Approach This work proposes a gating approach to verify UA conformance of an application. This gating approach is based on applying tests at the various steps, now named gates, on the various components. The following test categories are defined. Keyword Expansion AT Accept test VT Validate test P1T Process test on the input ST Store test P2T Process test on the output DT Display test The following figure shows the proposed gating approach. Each test category is applied at a different step of the application. UA Readiness Framework - Report UASG026  Gating Considerations Modern software architectures are complex with containers, micro services, multi-tier, caches at all levels, cloud services, etc. In fact, an application is a web of components that have complex interactions. Even developers involved in the project have difficulties pinpointing the issues because of the complexity. While steps (accept, validate, process, store, display) are defined, some may be aggregated together so that there is no separation between some of the steps. For example, validating and processing might take place together within the same method on the identifier object. This work proposes a model, but frontiers between components are often blurred. Modern software architectures often use a variety of cloud services from different cloud service providers. The code of the services themselves, and that of their components, is normally not exposed. Therefore, these services should be considered black boxes with no way to look into them; they can only be tested from the interface that they provide. Given their dominance in the software development market, they must be taken into account in verifying UA conformance. Examples of such services are third party identity/authentication/authorization services. For a software developer, it is easier to use Google, Facebook, Apple or other pre-existing user authentication services, as it enables the developer to focus on aspects which will differentiate the relevant service without having to incur time and cost in ‘reinventing the wheel’ for commonly occurring functions. It also provides a more seamless experience for the end-users. As domains or email addresses are often used as identifiers, or as backup identifiers, they become a significant part of UA conformance of an application when such applications uses these services. Email address are not only used as unique identifiers for users, but there are often backup emails used for restoring the account or resetting the password which also must support UA conformance. Web-Based Application Components This section lists some web-based application components with examples. This list is not exhaustive. Category Examples Type of Application Browser Chrome, Firefox, Edge, Safari, Opera, Brave, UC, 360, Sogou, Baidu, Tencent, QQ Component of web-based application Web server nginx, Apache, lighttpd, tomcat, IIS Backend component of web-based application TLS Certificates openssl, letsencrypt Backend component of web-based application Backend web framework/libraries Django/Python, Flask/Python, Spring/Java, Express/NodeJS, Ruby on Rails, Component of web-based application UA Readiness Framework - Report UASG026  Lumen/PHP, .Net, Laravel Frontend web framework/libraries Angular, React, Vue.js, Backbone, Ember Bootstrap Component of web-based application Applications This section list some applications, either web-based or native, that would be candidates for UA conformance testing. Email (webmail) Gmail, Xgenplus, Coremail, Hotmail/Outlook/Live, Yahoo, Datamail, Mailrelay Web-based application Email (native client (MUA, MSA)) Gmail, Outlook, Xgenplus, Foxmail Native Email (server (M*A) MSexchange,postfix, Dovecot, Xgenplus, courier Native Email (service provider) Gmail, Hotmail/Outlook/Live, Yahoo, datamail CoreMail, QQ mail; 163/126 mail; China Mobile 139.com Native Antispam (AS) Spamjadoo, Comodo, SpamAssassin, SpamTitan Native OS tools Curl, Wget, nslookup, Dig, Telnet, SSH, Host, Hostname, SCP, Ping, Tracert, PathPing Native CMS WordPress, Joomla, Drupal, Typo3, Discuz, Pageadmin Web-based application Social Media Web Apps Facebook, Twitter, Pinterest, Instagram, LinkedIn, WhatsApp, WeChat, Sina Weibo, QQ Web-based application Social Media Apps Facebook, Twitter, Pinterest, Instagram, LinkedIn, WhatsApp, WeChat, Sina Weibo, QQ Native E-Commerce Web Apps Amazon, Alibaba, Ebay Web-based application It is worth noting that the same application is often delivered in two flavors: a web-based and a native version. For example, Facebook is available as a web-based application and as a native mobile application. However, for the purpose of UA conformance, those should be considered separate and different since one may behave differently to the other regarding UA. Expected Behaviors This section describes the expected behavior of the applications at each gate. UA Readiness Framework - Report UASG026  Accept ● All forms possible: i.e. IDN – either U-Label or A-Label. Validate ● ● Normalize if non-ASCII Optionally: ○ Verify if valid IDN ○ Verify if label is too long (> 63 octets, A-label if IDN) ● Maybe (has pros and cons): ○ Verify if TLD is active Process on Input ● ● Does not truncate Does not inadvertently convert to ASCII. For example, converting ‘é’ to ‘e’. Store ● ● ● EAI: local part UTF8 IDN: either U-Label or A-Label Long/new TLD: as is; no truncation Process on Output Display ● ● Should display in UTF8 May also display IDN as A-label Tests This section lists the various high-level tests that can be applied at each gate. The various possible datasets are described in the UASG-004 document. AT: Accept Test ● ● ● EAI: verify if it accepts any UTF8 IDN: verify if it accepts any UTF8 Long/new TLD: verify if it accepts any TLD as long label VT: Validate Test ● ● ● ● Verify if it normalizes a non-normalized UTF8 label Verify if it validates a valid/non-valid domain name Verify if it validates a valid/non-valid IDN Verify if it validates a valid/non-valid long/new TLD P1T: Process on Input Test ● Verify that the input of the processing does not change the output, unless it normalizes the string. ST: Store test ● EAI: UA Readiness Framework - Report UASG026  ○ ○ ● ● Given good EAI input, verify that the database content for that input is correct: i.e. either identical or normalized version of the local part. The domain part, if IDN, could be either A-Label or U-Label form. Given bad EAI input, verify that the database content for that input is not saved. IDN: ○ Given good IDN input, verify that the database content is either A-Label or ULabel form. ○ Given bad IDN input, verify that the database content for that input is not saved. Long/new TLD strings: ○ Given long TLD string as input, verify that the database content is not truncated. ○ Given too long TLD string as input, verify that the database content for that input is not saved. ○ Given new TLD string as input, verify the database content contains the new TLD. P2T: Process on Output Test ● Given a good value in the database, verify that the value going to be displayed by the UI is correct: local part is UTF8, IDN is in U-Label format, long string TLD is not truncated, new TLD string is processed. DT: Display Test ● Given a good value in the database, verify that the displayed value by the UI is correct: local part is UTF8, IDN is in U-Label format, long string TLD is not truncated, new TLD (from the root) is shown, removed TLD (from the root) is not shown. Normalization Normalization is required since the same string can be represented by different codepoints. Unicode defines various normalization forms[UTR15]. In absence of specifics, developers may use Normalization Form C (NFC). Proposed Approach The proposed approach to verify UA compliance of an application is as follows: ● Identify the components used in the application. ● Verify the UA compliance of each component. ● Test the application for UA compliance, from an input/output perspective without looking “under the hood.” ● If tests results are negative, then investigate by applying the gating approach to the various interfaces of the components, as described before. It should be noted that a component may not be UA compliant, but that does not mean the whole application is not UA compliant. This is because the developers of the application may have added another layer above the base component to support UA. For example, as shown by testing Java libraries for UA compliance, the JAVA base JRE is not UA compliant as it supports IDNA2003. However, a developer may use and add a new library that supports UA, so the fact that an application is implemented in Java does not mean it is not UA compliant. UA Readiness Framework - Report UASG026  This framework is intended for testing software applications. It may not be applicable as is for some other use cases such as libraries or infrastructure components. SMS messaging is an example of an infrastructure that may carry internationalized identifiers, but does not necessarily apply directly with this framework. Web-Based Application: CMS Sub-Category The following is an application of the approach to the web-based application category of Content Management Systems (CMS). This is a non-comprehensive list of CMS, but provides the most popular ranked by various sites. The market leader is WordPress. These are all open-source. The code can be downloaded and installed on a server, or many can also be used on hosting services. Browser Frontend Backend Database Gates/test control points WordPress Any PHP PHP/Apache MySQL/MariaDB AT, VT, P1T, ST, P2T, DT Joomla Any PHP PHP/Apache MySQL/MariaDB AT, VT, P1T, ST, P2T, DT Drupal Any PHP PHP/Apache /nginx MySQL/MariaDB/ PostgreSQL/SQLite AT, VT, P1T, ST, P2T, DT Typo3 Any PHP PHP/Apache /nginx MySQL/MariaDB/ PostgreSQL/SQLite AT, VT, P1T, ST, P2T, DT One can see that these share the same architecture and same components. Same tests can be applied to all. Summary This work provides a framework for scoping UA conformance work on software applications. It defines two categories of application and a series of gates for testing the application against various tests. References [UASG]  [UASG-004] Use Cases for UA Readiness Evaluation, April 2017,  [UTR15] Unicode Normalization Forms, Unicode® Standard Annex #15,  UA Readiness Framework - Report UASG026  =================================== Universal Acceptance Readiness Framework 6 April 2020 UA Readiness Framework - Report UASG026 TABLE OF CONTENTS Introduction Categories of Applications Components Web-based Application Considerations Native Application Gating Steps Modeling Applications Web-based Application Native Application Gating Approach Gating Considerations Web-Based Application Components Applications Expected Behaviors Accept Validate Process on Input Store Process on Output Display Tests AT: Accept Test VT: Validate Test P1T: Process on Input Test ST: Store test P2T: Process on Output Test DT: Display Test Proposed Approach Web-Based Application: CMS Sub-Category Summary References 3 3 3 4 4 4 5 5 5 6 6 7 7 8 8 9 9 9 9 9 9 9 9 9 9 9 10 10 10 11 11 11 UA Readiness Framework - Report UASG026  Introduction Universal Acceptance (UA) is about enabling the use of identifier technologies that were not present at the beginning of the Internet deployment, especially when it comes to internationalization. More specifically, and for the purpose of this document, we summarize UA as the conformance status of an application or service that supports the following features: ● ● ● ● Internationalized Domain Name (IDN) ○ Because some software expects a domain name to be in ASCII. Email Address Internationalization (EAI) ○ Because some software expects the local part (e.g. the string at the left of the “@” sign for left-to-right scripts) of an email address to be in ASCII. ○ Because some mail servers or services do not expect to receive emails with the local part of the email address in non-ASCII. Long top-level domain (TLD) strings ○ Because some software expects a TLD string to be no longer than three characters. Added/removed TLD strings ○ Because some software checks TLDs based on an out of date and static list of possible TLDs. Regarding TLD strings being added or removed, it is worth noting that contrary to some user beliefs, TLDs are often added or removed from the root zone, even on a daily basis. For example, during a 10 day period in November 2019, 7 TLDs were removed from the root. Identifying whether or not an application of any kind, on any platform, correctly supports UA can be complicated. The purpose of this paper is to define a scope and framework that will identify the issues facing the developer community so that they can work to fix them and increase UA readiness. Related work on UA is available at  Categories of Applications For the purpose of this study, applications are either web-based or native as described below. Web-based application ● The User Interface (UI) is in a browser. ● The browser is either standalone or embedded. Note that some applications seem native but in fact are displaying HTML pages using an embedded browser. An embedded browser may be in desktop applications, cars, wearables, consumer products, and more. Native application ● Either computer-based or on mobile platforms (mobile phone, tablets, etc.) ● Runs directly on an operating system (OS). ● Does not primarily use a browser or an embedded browser view. UA Readiness Framework - Report UASG026  Components An application is typically made up of various components. Each application category defined above has its own set of components. This work takes a deliberately simplified approach and will only concentrate on the major components of an application. It may mean that sometimes the model is not as accurate for some applications. Splitting the application into components enables the UA compliance work to be applied to various gates between components, as discussed later. Gates can be viewed as functional separations in the application. Web-based Application A web-based application is made up of the following components: ● Web browser: The browser is another application; however, it is an integral part of a web application delivery. Note that sometimes web browsers appear as embedded in a native application. ● Front-end: The front-end is the component that creates and enables code to be executed into the browser. It is responsible for creating HTML and allowing HTML, CSS, and Javascript code to be executed in the browser. ● Back-end: The back-end is the component running on a remote server which typically executes more complex tasks, as well as maintaining state and accessing a database. ● Database: The database is the component storing information on a remote server. A database may be managed by a typical SQL database engine or even just a file. ● Filesystem: The filesystem is the place where files are stored on the operating system (OS). ● External Service: Sometimes an application uses an external service to complement its core functionalities. A typical example of an external service is an authentication service provided internally to an enterprise or by a cloud service provider. Considerations ● ● ● ● Given the nature of current web-based applications, this model is simplified but it does present typical components used in software development and is sufficient for the purpose of this work. Modern web browsers offer local storage which is usually limited in size and capabilities, but could be used by application developers to store UA identifiers. In modern cloud based applications, the front-end and the back-end are typically stateless, so they can be deployed horizontally dynamically in multiple instances as load requires. Therefore, the front-end and the back-end typically do not involve application data storage. Most web sites are typically engineered as applications; therefore, we assume that for the purpose of this work, a web site is a web-based application. Thus, the proposed model may be applied to a web site. Native Application A native application is made of the following components: ● User Interface (UI): The visual interface that interacts with the user. This interface is responsible for collecting user input such as domain names or email addresses. ● Internal: The code processing the user’s input and providing the functions of the application. ● Database: The database is the component storing application information. A UA Readiness Framework - Report UASG026  ● ● database may be managed by a typical SQL database engine, or even just a file. The database may be local or remote. Filesystem: The filesystem is the place where files are stored on the operating system (OS). External Service: Sometimes an application uses an external service to complement its core functionalities. A typical example of an external service is an authentication service provided internally to an enterprise or by a cloud service provider. Gating Steps The UA community has defined the following steps within an application to process UA related identifiers: 1. Accept: how an application accepts the user input which consists of UA identifiers. 2. Validate: how an application validates the UA identifier. 3. Process: after validation, how an application processes the UA identifier. 4. Store: after processing, how an application stores the UA identifier. 5. Display: how an application displays the UA identifier. This work proposes the addition of a step between store and display in order to provide a full sequence of steps that can be used as gates to verify conformance. The new list is as follows: 1. Accept: how an application accepts the user input which consists of UA identifiers. 2. Validate: how an application validates the UA identifier. 3. Process: after validation, how an application processes the UA identifier. 4. Store: after processing, how an application stores the UA identifier. 5. Process: after storing, how an application processes the UA identifier, typically for displaying. 6. Display: how an application displays the UA identifier. It should be noted that for some applications, some steps or gates may not be relevant. For example, some applications may not store identifiers, therefore steps 4 and 5 would be irrelevant. Modeling Applications The two categories of applications are modeled based on their respective components and the gating steps. Tables below show Y when the component plays a role in the step, and M when the component may play a role. Web-Based Application Browser Frontend Accept Validate Y (only IDN in URL) M Process Store Process M (local storage) M Display Y M UA Readiness Framework - Report UASG026  Backend M Database Y Filesystem Y External service M M M M Native Application Accept UI Y Internal Validate Process Store M M M M Y Filesystem Y M Display Y Database External service Process M M M Gating Approach This work proposes a gating approach to verify UA conformance of an application. This gating approach is based on applying tests at the various steps, now named gates, on the various components. The following test categories are defined. Keyword Expansion AT Accept test VT Validate test P1T Process test on the input ST Store test P2T Process test on the output DT Display test The following figure shows the proposed gating approach. Each test category is applied at a different step of the application. UA Readiness Framework - Report UASG026  Gating Considerations Modern software architectures are complex with containers, micro services, multi-tier, caches at all levels, cloud services, etc. In fact, an application is a web of components that have complex interactions. Even developers involved in the project have difficulties pinpointing the issues because of the complexity. While steps (accept, validate, process, store, display) are defined, some may be aggregated together so that there is no separation between some of the steps. For example, validating and processing might take place together within the same method on the identifier object. This work proposes a model, but frontiers between components are often blurred. Modern software architectures often use a variety of cloud services from different cloud service providers. The code of the services themselves, and that of their components, is normally not exposed. Therefore, these services should be considered black boxes with no way to look into them; they can only be tested from the interface that they provide. Given their dominance in the software development market, they must be taken into account in verifying UA conformance. Examples of such services are third party identity/authentication/authorization services. For a software developer, it is easier to use Google, Facebook, Apple or other pre-existing user authentication services, as it enables the developer to focus on aspects which will differentiate the relevant service without having to incur time and cost in ‘reinventing the wheel’ for commonly occurring functions. It also provides a more seamless experience for the end-users. As domains or email addresses are often used as identifiers, or as backup identifiers, they become a significant part of UA conformance of an application when such applications uses these services. Email address are not only used as unique identifiers for users, but there are often backup emails used for restoring the account or resetting the password which also must support UA conformance. Web-Based Application Components This section lists some web-based application components with examples. This list is not exhaustive. Category Examples Type of Application Browser Chrome, Firefox, Edge, Safari, Opera, Brave, UC, 360, Sogou, Baidu, Tencent, QQ Component of web-based application Web server nginx, Apache, lighttpd, tomcat, IIS Backend component of web-based application TLS Certificates openssl, letsencrypt Backend component of web-based application Backend web framework/libraries Django/Python, Flask/Python, Spring/Java, Express/NodeJS, Ruby on Rails, Component of web-based application UA Readiness Framework - Report UASG026  Lumen/PHP, .Net, Laravel Frontend web framework/libraries Angular, React, Vue.js, Backbone, Ember Bootstrap Component of web-based application Applications This section list some applications, either web-based or native, that would be candidates for UA conformance testing. Email (webmail) Gmail, Xgenplus, Coremail, Hotmail/Outlook/Live, Yahoo, Datamail, Mailrelay Web-based application Email (native client (MUA, MSA)) Gmail, Outlook, Xgenplus, Foxmail Native Email (server (M*A) MSexchange,postfix, Dovecot, Xgenplus, courier Native Email (service provider) Gmail, Hotmail/Outlook/Live, Yahoo, datamail CoreMail, QQ mail; 163/126 mail; China Mobile 139.com Native Antispam (AS) Spamjadoo, Comodo, SpamAssassin, SpamTitan Native OS tools Curl, Wget, nslookup, Dig, Telnet, SSH, Host, Hostname, SCP, Ping, Tracert, PathPing Native CMS WordPress, Joomla, Drupal, Typo3, Discuz, Pageadmin Web-based application Social Media Web Apps Facebook, Twitter, Pinterest, Instagram, LinkedIn, WhatsApp, WeChat, Sina Weibo, QQ Web-based application Social Media Apps Facebook, Twitter, Pinterest, Instagram, LinkedIn, WhatsApp, WeChat, Sina Weibo, QQ Native E-Commerce Web Apps Amazon, Alibaba, Ebay Web-based application It is worth noting that the same application is often delivered in two flavors: a web-based and a native version. For example, Facebook is available as a web-based application and as a native mobile application. However, for the purpose of UA conformance, those should be considered separate and different since one may behave differently to the other regarding UA. Expected Behaviors This section describes the expected behavior of the applications at each gate. UA Readiness Framework - Report UASG026  Accept ● All forms possible: i.e. IDN – either U-Label or A-Label. Validate ● ● Normalize if non-ASCII Optionally: ○ Verify if valid IDN ○ Verify if label is too long (> 63 octets, A-label if IDN) ● Maybe (has pros and cons): ○ Verify if TLD is active Process on Input ● ● Does not truncate Does not inadvertently convert to ASCII. For example, converting ‘é’ to ‘e’. Store ● ● ● EAI: local part UTF8 IDN: either U-Label or A-Label Long/new TLD: as is; no truncation Process on Output Display ● ● Should display in UTF8 May also display IDN as A-label Tests This section lists the various high-level tests that can be applied at each gate. The various possible datasets are described in the UASG-004 document. AT: Accept Test ● ● ● EAI: verify if it accepts any UTF8 IDN: verify if it accepts any UTF8 Long/new TLD: verify if it accepts any TLD as long label VT: Validate Test ● ● ● ● Verify if it normalizes a non-normalized UTF8 label Verify if it validates a valid/non-valid domain name Verify if it validates a valid/non-valid IDN Verify if it validates a valid/non-valid long/new TLD P1T: Process on Input Test ● Verify that the input of the processing does not change the output, unless it normalizes the string. ST: Store test ● EAI: UA Readiness Framework - Report UASG026  ○ ○ ● ● Given good EAI input, verify that the database content for that input is correct: i.e. either identical or normalized version of the local part. The domain part, if IDN, could be either A-Label or U-Label form. Given bad EAI input, verify that the database content for that input is not saved. IDN: ○ Given good IDN input, verify that the database content is either A-Label or ULabel form. ○ Given bad IDN input, verify that the database content for that input is not saved. Long/new TLD strings: ○ Given long TLD string as input, verify that the database content is not truncated. ○ Given too long TLD string as input, verify that the database content for that input is not saved. ○ Given new TLD string as input, verify the database content contains the new TLD. P2T: Process on Output Test ● Given a good value in the database, verify that the value going to be displayed by the UI is correct: local part is UTF8, IDN is in U-Label format, long string TLD is not truncated, new TLD string is processed. DT: Display Test ● Given a good value in the database, verify that the displayed value by the UI is correct: local part is UTF8, IDN is in U-Label format, long string TLD is not truncated, new TLD (from the root) is shown, removed TLD (from the root) is not shown. Normalization Normalization is required since the same string can be represented by different codepoints. Unicode defines various normalization forms[UTR15]. In absence of specifics, developers may use Normalization Form C (NFC). Proposed Approach The proposed approach to verify UA compliance of an application is as follows: ● Identify the components used in the application. ● Verify the UA compliance of each component. ● Test the application for UA compliance, from an input/output perspective without looking “under the hood.” ● If tests results are negative, then investigate by applying the gating approach to the various interfaces of the components, as described before. It should be noted that a component may not be UA compliant, but that does not mean the whole application is not UA compliant. This is because the developers of the application may have added another layer above the base component to support UA. For example, as shown by testing Java libraries for UA compliance, the JAVA base JRE is not UA compliant as it supports IDNA2003. However, a developer may use and add a new library that supports UA, so the fact that an application is implemented in Java does not mean it is not UA compliant. UA Readiness Framework - Report UASG026  This framework is intended for testing software applications. It may not be applicable as is for some other use cases such as libraries or infrastructure components. SMS messaging is an example of an infrastructure that may carry internationalized identifiers, but does not necessarily apply directly with this framework. Web-Based Application: CMS Sub-Category The following is an application of the approach to the web-based application category of Content Management Systems (CMS). This is a non-comprehensive list of CMS, but provides the most popular ranked by various sites. The market leader is WordPress. These are all open-source. The code can be downloaded and installed on a server, or many can also be used on hosting services. Browser Frontend Backend Database Gates/test control points WordPress Any PHP PHP/Apache MySQL/MariaDB AT, VT, P1T, ST, P2T, DT Joomla Any PHP PHP/Apache MySQL/MariaDB AT, VT, P1T, ST, P2T, DT Drupal Any PHP PHP/Apache /nginx MySQL/MariaDB/ PostgreSQL/SQLite AT, VT, P1T, ST, P2T, DT Typo3 Any PHP PHP/Apache /nginx MySQL/MariaDB/ PostgreSQL/SQLite AT, VT, P1T, ST, P2T, DT One can see that these share the same architecture and same components. Same tests can be applied to all. Summary This work provides a framework for scoping UA conformance work on software applications. It defines two categories of application and a series of gates for testing the application against various tests. References [UASG]  [UASG-004] Use Cases for UA Readiness Evaluation, April 2017,  [UTR15] Unicode Normalization Forms, Unicode® Standard Annex #15,  UA Readiness Framework - Report UASG026  Considerations for Naming Internationalized Email Mailboxes 2 November 2020 Report UASG028 Table of Contents 3 4 5 Introduction Executive Summary Policy Topics for Consideration Supported Scripts Length of a Mailbox Name String Script Mixing Preventing Invalid Strings and Unstable-rendered Strings Right-to-Left (RTL) Script Consideration Aliases and Display Names Consideration Signs and Symbols Unicode Character Normalization Equivalence Considerations Other Considerations Glossary Considerations for Naming Internationalized Email Mailboxes - Report UASG028 5 5 6 8 9 11 12 12 13 15 16 Page 2 Introduction This document lays out considerations for naming internationalized mailboxes and is intended for administrators of email systems. Email standards RFC6533 Internationalized Delivery Status and Disposition Notifications and RFC6430 Email Feedback Report Type Value: not-spam now allow both mailbox names (the part of an email address before the ‘@’ sign) and domain names (the part after the ‘@’ sign) to use almost any language or writing system; they are no longer restricted to the letters A-Z and numbers 0-9. This is an important improvement for users who use and prefer languages other than English, and for the people with whom they exchange messages. However, system administrators need to adopt policies on mailbox names in order to maximize the benefits of having a greater choice of allowable characters, while limiting confusion, error, and opportunities for malice. This document is intended for administrators of email systems that wish to provision internationalized mailboxes for their users and/or configure and manage systems compatible with internationalized email addresses. It will help administrators ask the right questions and make good choices when setting their policy. In this document, familiarity with email systems and experience with Phase 1 of Email Address Internationalization (EAI) – the ability to send emails to and receive emails from internationalized addresses – is assumed. This document addresses issues in Phase 2 of EAI, such as naming and hosting internationalized mailboxes. The Glossary section provides definitions of specialized terms and acronyms used in this report. Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 3 Executive Summary This document is intended for email administrators, systems administrators, and IT managers. Its purpose is to aggregate and specify the main operational and policy considerations to be considered when creating internationalized email address mailbox names, aliases, and display names. Mailbox names – the part of the email address before the ‘@’ symbol – are important as to how useful, user-friendly, and secure an email system will be, therefore it’s important for email administrators to adopt good policies for naming mailboxes. Historically, email addresses have been limited to Latin-script letters and digits, but now email technology has evolved to allow for both mailbox names and domain names to be written in almost any language and script. This flexibility makes policy choices more complex, and this document aims to guide email administrators in adapting mailbox name policy to cover email addresses outside of Latin-script letters and digits. Ultimately, the business purpose of email systems, along with the language needs of users and their correspondents, will decide policy choices and determine what scripts (writing systems for languages) will be allowed in mailbox names and their length. Since some spellings, character combinations, signs, or symbols are confusing or deceptive, the policy used by administrators should forbid them (details depend on the language used for the mailbox name). Technical issues about how names that look the same to users but might actually consist of different characters require special attention. Right-to-left (RTL) scripts have unique possibilities for confusing name spellings, so if your system allows these scripts there are additional policy topics that should be addressed. Users may exchange emails with people who experience difficulty reading the particular script used in an email address. To reduce these difficulties, implementing a policy that allows users to choose display names (the personal name displayed) and use aliases (alternate addresses for the same user) is recommended. This document also includes resources and references that provide more detail on several of these policy topics. It also includes a glossary of terms, some of which may be new to administrators when adopting multiple scripts and languages for mailbox names. Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 4 Policy Topics for Consideration This document considers topics that might be included in a mailbox naming policy. Each section deals with one of these topics as follows: Description of topic. Explanation of considerations regarding the context of email systems, the user base, and user base needs. Policy recommendations (in some cases). Check list of actions that should be taken. Supported Scripts When setting up an email system, email administrators need to decide which scripts will be the default scripts of the system. The term “script” is used in the linguistic sense and is defined as: the conventions and sets of characters used together to write one or more languages. For instance, the Latin script is the set of letters A-Z and other characters commonly used to write English, French, and many other languages in Europe, North and South America, and Africa. The Arabic script is used to write many languages in the Middle East, North Africa, and South Asia. Considerations: Most systems will include ASCII code points for backward compatibility. EAI allows administrators to use additional scripts. Checklist [ ] Research the expectations of your users and the target market to understand the writing systems needed for both the mailbox name and domain name portion of an email address. [ ] Review this document to understand the complexities involved in providing additional scripts (e.g. possible confusion, errors, and opportunities for malice) and any potential impact on your users. [ ] Based on the expectations of your users, make a list of the allowable mailbox name scripts. Length of a Mailbox Name String Consider the length of the mailbox name in characters. What are the minimum and maximum lengths you want to permit? Considerations: There may be system constraints on the mailbox name string. Although email standards allow up to 64 octets in a mailbox name, some systems limit the string to less than the standard character limit. There can be user benefits to short names as they may be easier to remember and write. There can also be user benefits to long names as they can be more specific and are less likely to conflict with other mailbox names. You may already have a policy requiring mailbox names to be based on the personal name of the user, for instance, personal name and family name separated by a “.”. Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 5 Consider keeping your existing policy but expanding it to a wider range of characters and languages. Also, consider what languages and characters your users and their correspondents are likely to be able to understand, remember, and enter into email address fields. When using UTF8 to add more languages and scripts, a single character can be represented in multiple octets which will increase the mailbox character length. For example, a mailbox name that consists of ASCII letters that requires 20 octets can be expanded to 60 octets when representing 20 letters in another language or script. Recommendations: None. Checklist: [ ] Know the constraints of your system. [ ] Understand the expectations of your users related to internationalized mailbox names. [ ] Consider applying the same or a similar policy on length to internationalized mailbox names as to legacy mailbox names. Script Mixing Script mixing refers to the use of characters from multiple scripts in a single mailbox name in a way that is not used in normal writing. In particular, some characters from other scripts might be confusingly similar to characters from the primary script, which opens possibilities for malice or confusion. Considerations: Script mixing leads to security issues and user confusion. For example, the below image shows several different but similar-looking Unicode code points that might lead to user confusion1. 1 Source :  Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 6 Your correspondents will be writing the mailbox name and domain name together as an email address. If the domain name is in a certain script, it is natural for the mailbox name to be in the same script. Consider if any other script might be used with the domain name’s script. Some combinations might be necessary, while others can be confusing or perhaps malicious. Some cultures use multiple scripts for ordinary writing. For instance, most of the Japanese text is a mixture of characters from the Kanji, Hiragana, Katakana, and Latin (“Roman”) scripts. However, it is unusual to see Arabic script in Japanese texts. Latin-script mailbox names are typically case-insensitive. Upper-case and lower-case letters are treated as equivalent. For the scripts you use, consider if there are other equivalencies your users expect. For clarity, we do not generally consider mixtures of upper and lower-cases to be script mixing; see the Equivalence Considerations section for more detail. Within the Domain Name System (DNS), Internationalized Domain Names (IDNs) can be represented by two formats: U-label and A-label. In this document, A-label usage is not considered to be script mixing; see the Aliases Consideration section for more detail. Recommendations: For the best usability, it’s recommended that the mailbox name use the same script as the domain name portion of the email address, unless otherwise required to achieve your organization’s goals. Avoid the mixing of languages using the same script in the mailbox name to avoid using or creating visually similar mailbox name characters that are using different code points. Only characters that are used together in the ordinary writing of a language should be allowed in a given mailbox name in that language. Within the mailbox names, script mixing should be prohibited. For example, an Arabic mailbox might be limited to just Arabic characters, while a Japanese mailbox name might be permitted to include Kanji, Hiragana, Katakana, and Latin characters. Sample 1: Arabic script email address: ‫السعودية‬.‫مستخدم@رسيل‬ Sample 2: Japanese script email address with script mixing: Checklist: [ ] Consider the possible confusion, errors, and opportunities for malice due to script mixing both within the mailbox name and between the mailbox name and the domain name. [ ] Allow limited script mixing where there is a clear user need based on local practice and market requirements. For example, users of a retail email service may demand names with certain kinds of script mixing, while members of an organization may have fewer objections to a limited choice of mailbox names that exclude that script mixing. [ ] If users are allowed to request their mailbox names, provide examples for users. Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 7 Preventing Invalid Strings and Unstable-Rendered Strings In some writing systems, characters can be combined in valid ways allowing productive communication, but also in invalid ways leading to confusion and security risks. Such strings of characters will not be rendered consistently between platforms and applications – they will look different on different systems or displays. This topic addresses ways to avoid invalid strings. Considerations: The DNS has defined clear rules for which characters can be used and which should be avoided for both languages and scripts. For some scripts, particularly Southeast Asian and South Asian scripts, characters and marks can be combined on multiple levels. For example, consider the Thai script strings “ดี”ี vs “ดี”. The first one, “ดี”ี U+0E14(ด) + U+0E35 ( ีี)+ U+0E35 ( ีี) is invalid because it looks like ดี U+0E14(ด) + U+0E35 ( ีี). The Thai script user community has identified a rule that U+0E35 cannot follow U+0E35. These rules used in the DNS are known as Label Generation Rules (LGRs). You might want to adopt these rules for the mailboxes on your system. However, the LGRs might be more restrictive than necessary to be on your system. For instance, the Root Zone LGRs forbid using digits, but digits may be fine to use in your mailbox names. Some scripts do not yet have LGRs, so you cannot use them as a reference. You can refer to the existing Second Level Reference LGRs to validate the mailbox names, and an LGR validation tool is available online at  The source code for the tool is also available on GitHub which you can download and integrate into your system. Recommendations: Avoid potential security issues caused by creating mailbox names using invalid strings and its equivalents. If you intend to offer mailbox names in one language, refer to the language-based LGR. For example, if you want to offer mailbox names in German then use the German language LGR. If you intend to offer mailbox names in one script which may cover multiple languages, refer to the script-based LGR. For example, if you want to offer mailbox names in German, French, and Swedish then use the appropriate subset of the Latin script LGR. For scripts not covered by the Second Level Reference LGRs, you can refer to the Root Zone LGRs or follow high-level principles in RFC6912. For rules on digits in names using right-to-left scripts, check the Right-to-Left Scripts for Internationalized Domain Names for Applications (IDNA) RFC5893. Checklist: [ ] Determine if the Second Level Reference LGR meets your desired mailbox name string requirements. If it does, adopt the reference LGR. If it does not exactly meet your requirements, update it as needed. [ ] Share the Label Generation Rules (LGRs) as a mechanism to allow your end users to understand which characters and combinations will be considered valid. Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 8 [ ] If applicable, use the LGR validation tool to manually validate the mailbox strings. [ ] Consider if you want to use the LGR validation tool as-is, or if you want to deploy it on an internal server to streamline your workflow and to keep the mailbox names it processes inside your network. Right-to-Left (RTL) Script Consideration Arabic, Hebrew, Persian, and Urdu are current widespread right-to-left writing systems. Over time, as the usage of the Arabic script spread, the repertoire of 28 characters used to write the Arabic language was supplemented to accommodate the sounds of many other languages such as Pashto, Persian, Urdu, etc. While the Hebrew alphabet is used to write the Hebrew language, it is also used to write other languages such as Yiddish. In a right-to-left (RTL), top-to-bottom script, writing starts from the right of the page and continues to the left. This can be contrasted against left-to-right (LTR) writing systems, where writing starts from the left of the page and continues to the right. Note, however, that within a right-to-left script, some text may be written left-to-right. For instance, in Arabic, numbers and words in Latin script are written left-to-right. Thus, these scripts are sometimes referred to as "bidirectional". Considerations: Right-to-left scripts have potential for confusion that left-to-right scripts do not. The Label Generation Rules (LGRs) for these scripts reflect careful consideration of these possibilities. Take what the LGRs require or forbid seriously as there may be good but not obvious reasons for it. When exchanging email between a right-to-left address and people who do not read right-to-left script, it is even harder to be sure the address is understood. The use of alias names may be especially helpful. See the section, Aliases and Display Names Consideration for more. Some right-to-left scripts (e.g., Arabic and Hebrew) can have the “same” labels with more than one representation. These alternatives lend themselves to being treated as equivalents to an email address, rather than independent addresses. See the section, Equivalence Considerations for more details. It is common for text in a right-to-left context to be bidirectional. For example, Latinscript words (e.g., "Cola") and Arabic numerals (e.g., 123) will be written left-to-right. Also, some punctuation takes on the directionality of surrounding text. This means that mailbox names that include left-to-right components may be more likely to be mistyped. Arabic script uses its own numerals in addition to ASCII numerals. If a mailbox name includes a number, consider the type of number to use and whether the name using the other kind of number should be treated as an "equivalent". Script mixing concerns apply for names that have both kinds of digits. With bidirectional text, it can be visually unclear what the order of characters is. Usually, text is entered and stored in the same order that it is spoken, but this may not have a simple correspondence to the right-to-left position of the text in the displayed address. This is generally not a problem for someone who can read the script and understand when the direction changes. However, those who cannot read the script may have difficulty determining keypress order from the address as displayed. Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 9 Local keyboards are adapted to the local script and may not conveniently include all characters used in email addresses. Some keyboards do not include keys for period ('.') or at-sign ('@'). This makes email addresses more difficult to type. Consider the type of keyboard that will be used to type in your mailbox names, and whether to allow characters that are harder to type. Many right-to-left scripts include diacritics for representing vowels and pronunciation. These are essentially optional. If a mailbox name allows these diacritics, users may forget to include them. It is simpler to allow names without these diacritics. Arabic script, which usually displays characters joined together in calligraphy, has optional characters to force or prevent joining between characters. These are known as "zero width joiner" and "zero width non-joiner". They are a lesser-known mechanism – an artifact of computer-encoded text – so many users may not know how to use them. Mailbox names that rely on joiners may be more difficult for users to type correctly. Recommendations: It's not recommended to use combining marks especially in Arabic script. For example, use ‫ محمد‬instead of ٌ‫ح َّمد‬ َ ‫ ُم‬and ٌ‫ٌشؤون‬instead of ٌ‫ شُؤون‬. Mailbox names that use right-to-left scripts should not begin with a digit. Digits at the start of a text may be placed confusingly by the text direction rules. Avoid potential security issues caused by invalid strings and their “equivalents”. Invalid strings and equivalents are particularly common for Arabic script. See the Preventing Invalid Strings and Unstable-Rendered Strings section above and the Equivalence Considerations section below. If you intend to offer mailbox names in one language, refer to the language-based LGR. For example, if you want to offer mailbox names in Arabic then use the Arabic language LGRs. Check the Equivalence Considerations section for details. If you intend to offer mailbox names in one script that may cover multiple languages, refer to the script-based LGR. For example, if you want to offer mailbox names in Arabic, Pashto, and Urdu, then use the Arabic script LGR. For the scripts not covered by the Second Level Reference LGRs, refer to the Root Zone LGRs or follow high-level principles in RFC6912. For rules on digits in mailbox names using right-to-left scripts, check RFC5893 which provides the needed guidance on the use of right-to-left scripts for Internationalized Domain Names for Applications (IDNA). Checklist: [ ] Avoid script mixing with right-to-left scripts as it can lead to confusability and security issues. [ ] Use Second Level Reference LRGs or Root Zone LGRs. [ ] Avoid allowing two mailboxes with mailbox names that are equivalent to each other. Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 10 Aliases and Display Names Consideration Some email systems make it easy for users to have multiple email mailbox names or multiple display names directing mail to and from the same mailbox. These aliases and display names serve many purposes and can be used for several EAI use cases. Use cases include: Users requiring multiple script email addresses, such as a bilingual business card in both the native script and Latin script. Working around incompatible systems when sending or receiving emails. Making it easier for senders to recognize the email address and aliases in their address book. Considerations: Assess the email delivery paths from your users to their correspondents and from their correspondents back to your users. Be aware that mail delivered in these two directions might encounter different systems, so one direction might work well and the other might have problems. The more varied the correspondents and the wider variety of delivery paths for emails to and from your system, the more likely you are to encounter a delivery system that fails to deliver mail to or from internationalized email addresses. Allowing aliases or display names that are in a different script than the mailbox name might create security issues; however, it could also be beneficial when the EAI address is used across different language communities. Below is an example of Arabic display name for an English email address: "‫مصر‬.‫سجل‬-‫< "مشرف@اختبار‬adminmail@datamail.asia> Display name Email address Recommendations: Consider providing an ASCII email address as an alias for your internationalized email addresses. The alias should deliver emails to the same location as the internationalized address. The user should be able to choose whether to send a message or a reply from the internationalized address or from the ASCII alias address. Checklist: [ ] Understand if your system supports aliases. [ ] If your system supports aliases, add an alias-creation option to the user interface during the mailbox name selection process. The user will be informed that they should have an ASCII alias and be allowed to create one associated with their EAI mailbox name. [ ] You may optionally add a user interface allowing the user to add additional aliases at a later time, if your system supports this. [ ] If you assign mailbox names to users rather than allowing them to select mailboxes themselves, then assign the ASCII alias at the same time as you assign the EAI mailbox name. Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 11 Signs and Symbols Some signs and symbols are allowed in ASCII mailbox names, for example, (.) dot, underscore (_), hyphen (-), and plus sign (+). When deciding or selecting an EAI mailbox name(s) the administrator also needs to consider what Unicode signs or symbols should be allowed for use in the scripts being supported. Considerations: The inclusion principle (refer to LGR procedure) should be considered. The inclusion principle advises to only include the set of characters, e.g., signs and symbols, that are needed by the users, starting from an empty list. Symbols that create security issues specific to your implementation should be avoided. Only allow signs and symbols that are feasible for your users and their correspondents to read and input. The mailbox name should be typeable by commonly used Input Method Editors (IMEs). Set a policy that relates and have similar limitations considered for the Latin mailbox name as the internationalized mailbox name in a consistent and understandable way. Recommendations: Avoid mathematical marks that could create security issues, e.g., # $ % = “ * <, >. Emoji should not be allowed (reference to ICANN’s SSAC Advisory SAC95). The combining marks that fail the type-able principle should be disallowed, e.g., Arabic Hamza Above (U+0654). Checklist: [ ] By default, avoid using mathematical marks. [ ] By default, avoid using any signs and symbols that do not exist in your user’s keyboard/input devices. Some signs and symbols are not available in input devices for specific markets. [ ] Understand your users and local market expectations. If signs and symbols are required for your market, the dot (.), underscore (_), hyphen (-) and plus sign (+) are commonly used and could be added to the repertoire. [ ] Review the use of additional signs (if needed) and ensure it does not cause a security issue for the end users, including customer confusion, cross-scripting, and other security issues. Unicode Character Normalization The Unicode standard defines a text normalization procedure that replaces equivalent sequences of characters so that any two texts that are equivalent will be reduced to the same sequence of code points. Unicode defines normalized forms of a characters that can be encoded in multiple ways as there are various types of standardized forms, e.g., Normalization Form D (NFD) and Normalization Form C (NFC). Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 12 Example: Å can be encoded by 212B or 00C5. Both should refer to the same mailbox, not to different mailboxes, and would be normalized to the same NFD and NFC. Note that although these examples use Latin characters, similar examples are found in other scripts. More details on the other types of normalization, with samples, can be found on the Unicode consortium website. Recommendations Mailbox names should use NFC for consistency with domain names, and also because NFC strings, in most cases, are shorter than NFD strings. Typically, standard software already encodes Unicode normalization in their libraries. Email administrators should know the normalization type of the system they operate in order to be able to assign and manage its mailboxes. Domain names use Normalization Form C (NFC). When building a system, ensure that the libraries support NFC for consistency. Checklist [ ] Get to know the normalization type of your email system. [ ] Ensure that your email program does normalized-form-independent name comparisons. [ ] If it’s possible to select normalization type, select NFC unless there is motivation to use other forms. Equivalence Considerations When domain name labels are considered the “same” or “interchangeable” by the community, they are called “variant” domain name labels. When email mailbox strings are considered the “same” by the community, this document refers to them as “equivalent” mailbox names. Sometimes equivalent names are useful and can be used as aliases for the primary mailbox name. In other cases, they are confusing and may lead to security issues if not identified or assigned to a different user. Considerations: In ASCII email addresses, some mail services may consider upper-case and lowercase letters as equivalent. The DNS community has done a great deal of work to define clear Label Generation Rules (LGRs), including identification of variant labels in different scripts. Consult the LGRs to see if you want to use them as the basis of your definition of mailbox name equivalent. Examples: 1. Traditional Chinese and Simplified Chinese equivalents: 名称 which means “name” (U+540D U+79F0) Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 13 名稱 which means “name” (U+540D U+7A31) 名称 (Míngchēng, means “Name”) is used in China mainland and 名稱 (Míngchēng, means “Name”) is used in Taiwan and Hongkong, however, all of the Chinese community could recognize these two words as the same. 2. Arabic script equivalents (the word means “network” in Arabic): ‫( شبکۃ‬Unicode U+06C3 U+06A9 U+0628 U+0634) ‫( شبکة‬Unicode U+0629 U+06A9 U+0628 U+0634) ‫( شبكة‬Unicode U+0629 U+0643 U+0628 U+0634) 3. Full width versus half-width characters in Japanese and Chinese scripts. “JＩM” vs “JIM”, “１２３” vs “123”, “アイオ” vs “ｱｲｵ”. 4. Case folding equivalents: John.Callen john.callen John.callen john.Callen 5. Variation of name and separator (may also be considered equivalent): john.callen johncallen For an email system, you might consider delivering any emails addressed to the equivalent mailbox names to the same mailbox. This avoids customer confusion, cross-scripting, and other security issues. Additional equivalents can be assigned to the same mailbox as aliases, but these can get very numerous (hundreds or thousands) and become a management challenge. So, make the trade-off between the usefulness and the overhead of equivalents with caution. Note that variants in the domain name portion of the email address may have similar user impact. The discussion of domain names and their variants is outside of the scope of this document Be aware of the kinds of errors or confusion that may occur when users type in email addresses for your system. This document covers confusion in the mailbox name part of the address. There may also be confusion about the correct spelling or normalization of the domain name part of the address. Domain name variants are outside of the scope of this document. Recommendations: After a mailbox name has been assigned, the equivalent of that mailbox name should be identified and marked as registered and withheld from registration to a different user. Consider treating the most useful equivalents of a mailbox name as aliases (see Aliases Consideration section of this document), and deliver emails addressed to the equivalent mailbox to the same location as the original mailbox name. However, its Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 14 management might be difficult, so make the trade-off between its usefulness and the overhead of handling equivalents with caution, and on an as-needed basis. Consider practical, language-based equivalent rules for an equivalent mailbox. For example, with ASCII mailbox names, treating all upper and lower-case variations as equivalent is practical. With a Simplified Chinese mailbox name like 中国 which means “China”, consider treating the Traditional Chinese name with the same meaning, 中國, as an equivalent. All case folding permutations should be considered as the same mailbox. When there is more than one digit set being used in the same repertoire (set of possible codepoints used to create mailbox names), those digits should be mapped as equivalent codepoints. For example, a Hindi mailbox administrator may consider abc123 and abc१२३ as equivalent mailbox names: Mailbox name: abc123 Equivalent mailbox name: abc१२३ Checklist: [ ] Define a policy for determining the “same” or equivalent mailbox names that will apply to your system based on the writing system, user expectations, and technical capabilities of your implementation. Your policy will need to examine the LGR, case-folding, separators, numerals, and symbols in the considerations section above. [ ] Determine if the Second Level Reference LGR meets your desired mailbox name string equivalence requirements. If it does not meet your requirements, adapt it as needed. [ ] Share your policy to let end users understand which characters and combinations will be considered valid and which ones might have equivalence. [ ] When using equivalent strings, consider if you want to use the validation tool as is or if you want to deploy it on an internal server to streamline your workflow and to keep the mailbox names it processes inside your network. Other Considerations The internationalized domain name part of an email address can be spelled with Unicode characters or with an equivalent ASCII-only name beginning with “xn--”. Considerations: The “xn--” spelling of a domain name is an underlying technical detail. Ideally, the user never needs to see it. However, in a transition time where not every email system supports internationalized email addresses, the “xn--” spelling might be a useful workaround. Recommendations: Spell domain names with their internationalized non-ASCII names. Avoid displaying the “xn--” alternative name. Some email clients might not automatically link the U-label and A-label forms of email address mailbox names, so ensure that both labels are mapped to each other. Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 15 Glossary Alias: An email address that delivers mail to the same place as another email address. Typically, an alias is an ASCII email address that provides a fallback address for an EAI address in case a correspondent cannot send to the EAI address due to delivery systems not supporting EAI. ASCII: Refers to a limited character set made up of Latin-script letters without accents, numeric digits, and a few punctuation marks. The term ASCII is a computer industry acronym. Display Name: The name that appears next to the email address. Domain name: the sequence of names used to identify a website or email server, e.g. “uasg.tech” or “icann.org”. EAI: Email Address Internationalization. Email Address Internationalization: The practice of email addresses that are made up of all practical languages and scripts, not just ASCII or Latin script. Equivalent: When two or more Unicode code points share one meaning or are linguistically deemed equivalent by local authorities, resulting in "character variants". For example, they occur between Simplified and Traditional Chinese scripts, and are potentially confusing to people who are using these scripts. IDN: Internationalized Domain Name. IME (input-method editor): IME is an application that allows a standard keyboard (such as a US-101 keyboard) to be used to type characters and symbols that are not directly represented on the keyboard itself. Internationalized Domain Name: a domain name with non-ASCII characters. Label Generation Rules: rules for the use of characters in domain names. LGRs: Label Generation Rules. Mailbox Name: The portion of an email address identifying the mailbox location under a domain name. Used interchangeably with other terminology such as “mailbox name”, “account name”, “username”, “UTF-8 part”, “local-part”. Punycode: an algorithm to encode Unicode in the limited ASCII character subset used for Internet hostnames. Phase 1 of EAI: an email system that can successfully send emails to and receive emails from, internationalized email addresses, but cannot host mailboxes with internationalized names. Phase 2 of EAI: an email system that can successfully host internationalized mailbox names and successfully send emails to and receive emails from, internationalized email addresses. Rendering: the process by which a computer display system turns a sequence of characters Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 16 into a visual appearance on the screen. Script: the conventions and sets of characters used together to write one or more languages. Script.txt: The data files associated with the Unicode Character Database, identifying Script property values of all code points . Unicode: a character encoding standard, encompassing most of the world’s scripts and written languages. See  Variant names: names that are considered the “same” by the community. Considerations for Naming Internationalized Email Mailboxes - Report UASG028 Page 17

 Programming to Support Universal Acceptance of Domain Names and Email

Agenda


 ◉
 Introduction
 ◉
 

Overview of Universal Acceptance


 ◉
 

Fundamentals of Unicode


 ◉
 Fundamentals for IDNs and 

EAI


 ◉
 Programming for UA ⚪ Processing Domain Names ⚪ Processing 

Email Address


 ◉
 

Conclusion




 

Overview of Universal Acceptance



 

Categories of Domain Names and 

Email Address

es

 ◉
 It’s now possible to have domain names and email addresses in local languages using UTF8. ⚪ 

Internationalized Domain Names

 (IDNs) ⚪ 



Email Address Internationalization (EAI)

Domain names ⚪ Newer top-level domain names: ⚪ Longer top-level domain names: ⚪ 

Internationalized Domain Names

:
 ◉
 Internationalized email addresses (EAI) examples ⚪ ASCII@IDN ⚪ UTF8@ASCII ⚪ UTF8@IDN ⚪ UTF8@IDN; example.sky example.abudhabi 普遍接受-测试.世界
 marc@société.org ईमेल@example.com 测试@普遍接受-测试.世界 ‫ای‬-‫مثال @میل‬.‫موقع‬


 

Universal Acceptance and Digital Inclusion


 ◉
 Many people around the world are currently excluded from experiencing the full benefits of the Internet simply because they’re unable to use a domain name or email address of choice in their language and script
 ◉
 For example, a valid email is rejected by a form in a website (and also incorrectly displayed from left to right instead of RTL):


 

Universal Acceptance of Domain Names and Email


 Goal All domain names and email addresses work in all software applications. .‫أن تعمل جمیع أسماء النطاقات وعناوین البرید اإللكتروني في جمیع التطبیقات البرمجیة‬
 Impact Promote consumer choice, improve competition, and provide broader access to end users.


 What are the advantages/importance of being UA ready?
 For students
 Developers
 Governments
 Businesses


 

Scope of UA Readiness for Programmers


 ◉
 Support all Domain Names including 

Internationalized Domain Names

 (IDNs) and all 

Email Address

es, including Internationalized 

Email Address

es (

EAI

):
 Accept
 Validate
 Process
 Store
 Display
 ◉
 Accept: The user can input characters from their local script into a text field.
 ◉
 Validate: The software accepts the characters and recognizes them as valid.
 ◉
 Process: The system performs operations with the characters.
 ◉
 Store: The database can store the text without breaking or corrupting.
 ◉
 Display: When fetched from the database, the information is correctly shown.

 Question ◉
 To enhance systems to be Universal Acceptance (UA) ready, which of the following categories of domain names and email addresses are relevant? 1. ASCII domain names. 2. 

Internationalized Domain Names

 (IDNs). 3. Internationalized email addresses (

EAI

). 4. All the above. 5. Only 2 and 3.


 

Fundamentals of Unicode




 What do you know about ASCII and Unicode?


 
 

Character and Character Set

 ◉
 A label or string such as ‫أهال‬, नमस्ते, Hello is formed of characters. ⚪ Hello --> H e l l o
 ◉
 A character is unit of information used for the organization, control, or representation of textual data.
 ◉
 Examples of character: ⚪ Letters ⚪ Digits ⚪ Special characters i.e. Mathematical symbols , punctuation marks ⚪ Control Characters - typically not visible
 ◉
 American Standard Code for Information Interchange (ASCII) encodes characters used in computing including letters a-z, digits 0-9 and others.


 

Character Encoding

 Character encoding is a system used to convert characters (like letters, numbers, and symbols) into a format that computers can understand and process. Essentially, it assigns a unique number (or code) to each character.
 Encoding Schemes: schemes define how characters are encoded. Examples •
 ASCII: Uses 7 bits to represent characters, suitable for English text.
 •
 Unicode: Uses up to 32 bits, supporting characters from almost all languages and symbols.


 Hello World: Python print("Enter your input: ") inputstr = input() #default character encoding is UTF-8 print("Input data is: ") print(inputstr)


 Hello World: Java import java.util.Scanner; public class ReadWriteUnicode { public static void main(String[]args)
 {
 Scanner scr = new Scanner(System.in); System.out.println("Enter your input"); String Input = scr.nextLine(); //default character encoding is UTF-8
 System.out.println("Receieved input is: "+Input); } }


 Unicode Encoding – File Reading/Writing in Python ◉
 Read UTF-8 file file = open("filepath",'r',encoding='UTF-8') for line in file: print(line) file.close()
 ◉
 Write UTF-8 file file2 = open(“filepath",'w',encoding='UTF-8') data_to_write=‘‫'السالم عليكم‬ file2.writelines(data_to_write) file2.close()


 Unicode Encoding – File Reading in Java public void ReadFile(String filename){ try { FileInputStream fis = new FileInputStream(filename); InputStreamReader isr = new InputStreamReader(fis, StandardCharsets.UTF_8) BufferedReader br = new BufferedReader(isr); String line =""; while((line = br.readLine())!=null) { System.out.println(line); } fis.close(); }catch(IOException ex) { System.err.println(ex.toString()); } }

 Unicode Encoding – File Writing in Java public void WriteFile(String filename, String text){ try{ FileOutputStream fis = new FileOutputStream(filename);
 OutputStreamWriter osw = new OutputStreamWriter(fis,StandardCharsets.UTF_8); BufferedWriter bw = new BufferedWriter(osw); bw.write(text); bw.flush(); fis.close(); }catch(IOException ex) { System.err.println(ex.toString());
 }
 }


 

Normalization


 ◉
 There are multiple ways to encode certain glyphs in Unicode: ⚪ è = U+00E8 ⚪ e + ` = è = U+0065 + U+0300 ⚪ ‫ =آ‬U+0622 ⚪ ٓ + ‫=ا =ا‬U+0627 U+0653
 ◉
 The following string can exist in corpus in the form of first string below, whereas input string is in the form of second string, below. So, search result will be empty. ⚪ ‫(آدم‬U+0622 U+062F U+0645) ⚪ ‫(ادم‬U+0627 U+0653 U+062F U+0645)
 ◉
 For searching , sorting and any string operations we need normalization.
 ◉
 

Normalization

 ensures that the end representation is the same, even if users type differently


 

Normalization


 ◉
 Different normalization forms defined by Unicode are listed below: ⚪ 

Normalization

 Form D (NFD) ⚪ 

Normalization

 Form C (NFC) ⚪ 

Normalization

 Form KD (NFKD) ⚪ 

Normalization

 Form KC (NFKC)
 ◉
 In domain names NFC is used.


 

Normalization

 Code - Python import unicodedata input_str = input() # take input from user normalized_input = unicodedata.normalize('NFC',input_str) #normalize user input print(normalized_input)


 

Normalization

 Code - Java import com.ibm.icu.text.Normalizer2 Scanner sc = new Scanner(System.in); Normalizer2 norm = Normalizer2.getNFCInstance(); //get NFC object String input; input = sc.nextline(); String normalized_input = norm.normalize(input);


 

Internationalized Domain Names




 Two equivalent forms of IDN domain labels
 www.exâmple.ca
 U-Label
 A-Label
 Human users
 Applications or systems internally
 (using UTF-8 format
 ASCII
 E.g. exâmple
 e.g. xn----f38am99bqvcd5liy1cxsg


 Converting U-label to A-label
 Take user input and normalize and check against IDNA2008 to form IDN U-label. • exâmple
 Convert U-label to punycode (using RFC3492). • exmple-xta • --f38am99bqvcd5liy1cxsg
 • 普遍接受-测试
 ◉
 Add the “xn--” prefix to identify the ASCII string as an IDN A-label. • xn--exmple-xta • xn----f38am99bqvcd5liy1cxsg
 Use the latest IDN standard called IDNA2008 for IDNs. ⚪ Do not use libraries for the outdated IDNA2003 version.

 Convert U-Label => A-Label: Python import unicodedata #library for normalization import idna #library for conversion domainName = '‫صحة‬.‫'مصر‬ try: domainName_normalized = unicodedata.normalize('NFC', domainName) #normalize to NFC print(domainName_normalized) domainName_alabel = idna.encode(domainName_normalized).decode("ascii") #U-label to A-label print(domainName_alabel) domainName_ulabel = idna.decode(domainName_alabel) print(domainName_ulabel) except idna.IDNAError as e: print("Domain '{domainName}' is invalid: {e}") #invalid domain as per IDNA 2008 except Exception as e: print("ERROR: {e}")


 Convert U-Label => A-Label: Java ◉
 International Components for Unicode (ICU).
 ◉
 The gold standard library for Unicode. It was developed by IBM and is now managed by Unicode. In sync with Unicode standards. ⚪ IDNA Conversion is based on Unicode UTS46, which supports transition from IDNA2003 to IDNA2008. However, it is possible to configure not to support transition (recommended). ⚪ IDNA Conversion includes normalization as per IDNA (good!). ⚪ Check if there are errors in the conversion by calling info.hasErrors(). ⚪ For IDNs, set the options to restrict the validation and use to IDNA2008. ⚪ The static methods implement IDNA2003, and non-static methods implement IDNA2008.


 Convert U-Label => A-Label: Java import com.ibm.icu.text.IDNA; public static String convertULabeltoALabel(String Ulabel) { String Alabel = ""; final IDNA idnaInstance = IDNA.getUTS46Instance(IDNA.NONTRANSITIONAL_TO_ASCII | IDNA.CHECK_BIDI | IDNA.CHECK_CONTEXTJ | IDNA.CHECK_CONTEXTO | IDNA.USE_STD3_RULES);
 StringBuilder output = new StringBuilder(); IDNA.Info info = new IDNA.Info(); idnaInstance.nameToASCII(Ulabel, output, info); Alabel = output.toString(); if (!info.hasErrors()) { return Alabel; } else { //Conversion fails return info.getErrors().stream().toString(); } }

 Convert U-Label => A-Label: Java import com.ibm.icu.text.IDNA; public static String convertALabeltoULabel(String Alabel) { String Ulabel = ""; final IDNA idnaInstance = IDNA.getUTS46Instance(IDNA.NONTRANSITIONAL_TO_ASCII | IDNA.CHECK_BIDI | IDNA.CHECK_CONTEXTJ | IDNA.CHECK_CONTEXTO | IDNA.NONTRANSITIONAL_TO_UNICODE | IDNA.USE_STD3_RULES); StringBuilder output = new StringBuilder(); IDNA.Info info = new IDNA.Info(); idnaInstance.nameToUnicode(Alabel, output, info); Ulabel = output.toString(); if (!info.hasErrors()) { return Ulabel; } else { return info.getErrors().stream().toString(); } }


 

Domain Name Validation




 Validating Domain Name ◉
 Validating syntax: ⚪
 ASCII: RFC1035 • Composed of letters, digits, and hyphen. • Max length is 255 octets with each label up to 63 octets.
 ⚪
 IDN: IDNA2008 (RFCs 5890-5894) • Valid A-labels • Valid U-labels


 Validate Domain Name: Python import unicodedata #library for normalization import idna #library for conversion domainName = '‫صحة‬.‫'مصر‬ try: domainName_normalized = unicodedata.normalize('NFC', domainName) #normalize to NFC print(domainName_normalized) #U-label to A-label domainName_alabel = idna.encode(domainName_normalized).decode("ascii") print(domainName_alabel) except idna.IDNAError as e: #invalid domain as per IDNA 2008 print("Domain '{domainName}' is invalid: {e}") except Exception as e: print("ERROR: {e}")


 Validate Domain Name: Java import com.ibm.icu.text.IDNA; public static boolean isValidDomain(String DomainName) { String Alabel = ""; final IDNA idnaInstance = IDNA.getUTS46Instance(IDNA.NONTRANSITIONAL_TO_ASCII | IDNA.CHECK_BIDI | IDNA.CHECK_CONTEXTJ | IDNA.CHECK_CONTEXTO | IDNA.USE_STD3_RULES); StringBuilder output = new StringBuilder(); IDNA.Info info = new IDNA.Info(); idnaInstance.nameToASCII(DomainName, output, info); Alabel = output.toString(); if (!info.hasErrors()) { return true; } else { //Conversion fails return false; } }

 

Domain Name Resolution




 

Domain Name Resolution

 ◉
 After validation, a software would then use the domain name identifier as: ⚪ A domain name to be resolved in the DNS.
 ◉
 Traditional way of doing hostname resolution and sockets resolution cannot be used for IDNs.
 ◉
 We need to do following: 1. Take user input and normalize 2. Convert U-label to A-label (IDNA2008) 3. Use A-label for hostname resolution


 

Domain Name Resolution

 – Python import socket import unicodedata import idna domainName='' try: #normalize domain Name domainName_normalized = unicodedata.normalize('NFC', domainName) #Convert U-label to A-label form domainName_alabelForm = idna.encode(domainName_normalized).decode("ascii") #get IP address of the domain ip = socket.gethostbyname(domainName_alabelForm) print(ip) except Exception as ex: print(ex)


 

Domain Name Resolution

 – Java ◉
 

Normalization

 and U-label to A-label conversion is same as discussed before.
 import java.net.InetAddress; try { InetAddress ad = InetAddress.getByName(domainNameAlabelForm); String ip = ad.getHostAddress(); // returns ip for domain System.out.println(ip);
 } catch (Exception ex) { System.out.println(ex.toString()); //Unknown host exception }


 

Domain Name Storage

 ◉
 We need to ensure that database supports and configure for UTF-8.
 ◉
 SQL, e.g., MySQL, Oracle, Microsoft SQL Server. ⚪ Set domain names to max: 255 octets, 63 octets per label. • In UTF-8 native, variable length. ⚪ Recommendation to use variable length String columns. ⚪ Consider/verify the object-relational mapping (ORM) driver/tool if you are using one.
 ◉
 noSQL, e.g., MongoDB, CouchDB, Cassandra, HBase, Redis, Riak, Neo4J. ⚪ Already UTF-8 variable length.
 1.
 Store and retrieve either U-label or A-label in a field consistently.
 2.
 You can also store both U-label and A-label in separate fields.


 



Email Address

 Internationalization (

EAI

)




 

Email Address

 ◉
 Email address syntax: mailboxName@domainName. ⚪ Email has a mailboxName. ⚪ Email has a domainName. • The domainName can be ASCII or IDN. • For example: myname@example.org myname@xn--exmple-xta.ca


 

EAI

 ◉
 

EAI

 has the mailboxName in Unicode (in UTF-8 format).
 ◉
 The domainName can be ASCII or IDN. ⚪ For example: • kévin@example.org • すし@ xn--exmple-xta.ca • すし@快手.游戏.


 

Email Address

es Form ◉
 name@exâmple.ca and name@xn--exmple-xta.ca represent equivalent email address.
 ◉
 Application should be able to treat both forms as equivalent.
 ◉
 Internally consistently use A-label or U-label, but don’t mix A-label and U-label.
 ◉
 Technical Recommendation: Backend processing should be in A-label, and U-label for visual inspection.
 ◉
 For example, new user registration in application with equivalent A-label.


 Email Validation: Email Regular Expressions (Regex)
 ◉
 Basic: something@something. ⚪ ^(.+)@(.+)$
 ◉
 From owasp.org (security): ⚪ [^[a-zA-Z0-9_+&*-]+(?:\.[a-zA-Z0-9_+&*-]+)*@(?:[a-zA-Z0-9-]+\.)+[a-zA-Z]{2,7}$]. • Does not support 

EAI

, i.e., mailbox name in UTF8 not allowed: [a-zA-Z0-9_+&*-]. • Does not support ASCII TLD longer than 7 characters: [a-zA-Z]{2,7}. • Does not support U-labels in IDN TLD: [a-zA-Z]. ⚪ But OWASP is THE reference for security. • Therefore, you may end up fighting with your security team to use a UA-compatible Regex instead of the “standard” one from OWASP.


 Email Regular Expressions (Regex) ◉
 Example of Regex suggested in various forums: ex: List of proposals ⚪ ^[A-Za-z0-9+_.-]+@(.+)$ does not support UTF8 in mailbox name. ⚪ ^[a-zA-Z0-9_!#$%&’*+/=?`{|}~^.-]+@[a-zA-Z0-9.-]+$ does not support U-labels. ⚪ ^[a-zA-Z0-9_!#$%&’*+/=?`{|}~^-]+(?:\\.[a-zA-Z0-9_!#$%&’*+/=?`{|}~^-]+)*@[a-zA-Z0-9]+(?:\\.[a-zA-Z0-9-]+)*$ does not support U-labels. ⚪ ^[\\w!#$%&’*+/=?`{|}~^-]+(?:\\.[\\w!#$%&’*+/=?`{|}~^-]+)*@(?:[a-zA-Z0-9-]+\\.)+[a-zAZ]{2,6}$ have length restrictions for the TLD between 2 – 6 characters.
 ◉
 One can come up with an 

EAI

-IDN compatible regex using various Unicode codepoints characteristics. ⚪ For IDN it would be like a reimplementation of the IDNA protocol tables in regex!
 ◉
 Given that both sides of an 

EAI

 may have UTF8, then one regex for an 

EAI

 could be .*@.* which is only verifying the presence of the ‘@’ character.


 

Validate Email




 

Email Address

es Validation ◉
 Email has a mailboxName.
 ◉
 Email has a domainName.
 ◉
 DomainName validation same as before.
 ◉
 mailboxName validation require a valid UTF8 String.
 ◉
 Local administrator defines policy for mailboxName. ⚪ Gmail policy: firstname.lastname@gmail.com is equivalent to firstnamelastname@gmail.com.
 ◉
 Guidelines for mailboxName are available by UASG.


 

EAI

 Validation - Python from email_validator import validate_email,EmailNotValidError logger = logging.getLogger(__name__) try: # As part of process it performs DNS resolution # Normalizes email addresses automatically # Supports internationalized domain names validated = validate_email(email_address, check_deliverability=True) print(validated) logger.info("'{address}' is a valid email address") print("'{address}' is a valid email address") except EmailNotValidError as e: print("'{address}' is not a valid email address: {e}") except Exception as ex: print("Unexpected Exception")


 

EAI

 Validation - Java ◉
 Apache Common Validator: ⚪ Has domain and email validators. ⚪ Do not use as it relies on a static list of TLDs! OUTDATED!


 

EAI

 Validation - Java /** * Download the list of TLDs on ICANN website */ public static String[] retrieveTlds() { String IANA_TLD_LIST_URL = "https://data.iana.org/TLD/tlds-alpha-by-domain.txt"; StringBuilder out = new StringBuilder(); try (BufferedInputStream in = new BufferedInputStream( new URL(IANA_TLD_LIST_URL).openStream())) { byte[] dataBuffer = new byte[1024]; int bytesRead; while ((bytesRead = in.read(dataBuffer, 0, 1024)) != -1) { out.append(new String(dataBuffer, 0, bytesRead)); } } catch (IOException e) { // handle exception } return Arrays.stream(out.toString().split("\n")) .filter(s -> !s.startsWith("#")) .map(String::toLowerCase).distinct().toArray(String[]::new); }

 

EAI

 Validation - Java public static DomainValidator createDomainValidatorInstance(String domain, boolean use_actual_domains) { List<Item> domains = new ArrayList<>(); if (use_actual_domains) { domains.add(new Item(GENERIC_PLUS, retrieveTlds())); } else { String tld = domain; if (domain.contains(".")) { tld = domain.substring(domain.lastIndexOf(".") + 1); } // Convert TLD to A-Label String domainConverted = convertULabeltoALabel(tld); // if there is an error, do nothing, validator will fail if (domainConverted!="") { domains.add(new Item(GENERIC_PLUS, new String[]{domainConverted})); } } return DomainValidator.getInstance(false, domains); }

 

EAI

 Validation - Java public static boolean isValidEmail(String emailaddress){ emailaddress = Normalizer2.getNFCInstance().normalize(emailaddress); String[]emailparts = emailaddress.split("@"); if(emailparts.length==2){ String mailboxname = emailparts[0]; String domainName = emailparts[1]; String domainNameAlabelForm =convertULabeltoALabel(domainName); try { EmailValidator em = new EmailValidator(false, false, createDomainValidatorInstance(domainName,true)); if(em.isValid(mailboxname+"@"+domainNameAlabelForm)){ return true; } return false; } catch (Exception ex) { System.out.println(ex.toString()); return false; } } else{ return false; } }


 

Sending and Receiving Email




 Sending and Receiving ◉
 We need to be able to send to either form: ⚪ mailboxName-UTF-8@A-labelform. ⚪ mailboxName-UTF-8@U-labelform.
 ◉
 We need to be able to receive to either form: ⚪ mailboxName-UTF-8@A-labelform. ⚪ mailboxName-UTF-8@U-labelform.
 ◉
 Storage of email should be consistent with domain name in either A-label or U-label form.
 ◉
 Backend send/receive should be managed by mail server.
 ◉
 Handover process (Front end application 🡪 email server). ⚪ Libraries used in handover process should be 

EAI

 Compliant. ⚪ Mail server should also be 

EAI

 compatible. • How to make mail server 

EAI

 compatible is out of scope of this training?


 Sending and Receiving – Python ◉
 Smtplib can be used to send 

EAI

-compliant emails.
 ◉
 It does not validate the domain compliance with IDNA 2008, therefore another validation method should be used before trying to send an email. ⚪ For instance, using the email-validator library.


 Sending and Receiving – Python try: to = 'kévin@example.com' local_part, domain = to.rsplit('@', 1) domain_normalized= unicodedata.normalize('NFC',domain)#normalize domain name to = '@'.join((local_part,idna.encode(domain_normalized).decode('ascii’)))#convert U-label to A-label validated = validate_email(to, check_deliverability=True) #validate email address if validated: host='' port='' smtp = smtplib.SMTP(host, port) smtp.set_debuglevel(False) smtp.login(‘useremail’,’password') sender=‘ua@test.org' subject='hi' content='content here' msg = EmailMessage() msg.set_content(content) msg['Subject'] = subject msg['From'] = sender msg['to']=to smtp.send_message(msg, sender, to) smtp.quit() logger.info("Email sent to '{to}'") except smtplib.SMTPNotSupportedError: # The server does not support the SMTPUTF8 option, you may want to perform downgrading logger.warning("The SMTP server {host}:{port} does not support the SMTPUTF8 option") raise


 Sending and Receiving – Java ◉
 Jakarta Mail can be used for sending email.
 import import import import import import import import import import
 com.sun.mail.smtp.SMTPTransport; jakarta.mail.Message; jakarta.mail.MessagingException; jakarta.mail.PasswordAuthentication; jakarta.mail.Session; jakarta.mail.Transport; jakarta.mail.internet.InternetAddress; jakarta.mail.internet.MimeMessage; java.util.Date; java.util.Properties;


 Sending and Receiving – Java public static boolean sendEmail(String to, String host, String sender, String subject, String content,String username,String password){ if(isValidEmail(to)) { Properties props =
 new Properties();
 props.put("mail.smtp.host", host); props.put("mail.smtp.port", "587"); props.put("mail.smtp.auth", "true"); props.put("mail.smtp.starttls.enable", "true"); // enable UTF-8 support, mandatory for 

EAI

 support props.put("mail.mime.allowutf8", true); Session session = Session.getInstance(props, new jakarta.mail.Authenticator() { protected PasswordAuthentication getPasswordAuthentication() { return new PasswordAuthentication(username, password); } });


 Sending and Receiving – Java(2) /* * Jakarta mail is 

EAI

 compliant with 2 issues: * - it rejects domains that are not NFC normalized * - it rejects some unicode domains * In such case, first try to normalize, then convert domain to A-label. We do normalization * first to get an email address the closest possible to the user input because once * converted in A-label it may be displayed as is to the user. */
 String[] add_parts = to.split("@"); String mailboxName = add_parts[0]; String domainName = add_parts[1];
 String domainNameNormalized =Normalizer2.getNFCInstance().normalize(domainName); String domainNameAlabelForm = convertULabeltoALabel(domainNameNormalized); String compliantTo = mailboxName+"@"+domainNameAlabelForm;


 Sending and Receiving – Java(3) try (Transport transport = session.getTransport()) { if (transport instanceof SMTPTransport && !((SMTPTransport) transport).supportsExtension("SMTPUTF8")) { try { MimeMessage message = new MimeMessage(session); //set message headers for internationalized content message.addHeader("Content-type", "text/HTML; charset=UTF-8"); message.addHeader("Content-Transfer-Encoding", "8bit"); message.addHeader("format", "flowed"); message.setFrom(new InternetAddress(sender)); message.setSubject(subject, "UTF-8"); message.setText(content, "UTF-8"); message.setSentDate(new Date()); message.setRecipient(Message.RecipientType.TO, new InternetAddress(compliantTo)); Transport.send(message); return true; } catch (Exception e) { System.out.println(String.format("Failed to send email to %s: %s", to, e)); } } else { return false;} } catch (MessagingException e) { // ignore } } return false;}


 

Conclusion




 Prog. Languages Support UASG018A – note that some have improved since.


 

Conclusion


 ◉
 Be aware that UA identifiers may not be fully supported in software and libraries.
 ◉
 Use the right libraries and frameworks.
 ◉
 Adapt your code to properly support UA.
 ◉
 Do unit and system testing using UA test cases to ensure that your software is UA ready.